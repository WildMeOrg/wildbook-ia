
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>wbia.guitool.guitool_components &#8212; wbia 2.2.4 documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />

  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />


  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">


          <div class="body" role="main">

  <h1>Source code for wbia.guitool.guitool_components</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">six</span>
<span class="kn">from</span> <span class="nn">six.moves</span> <span class="k">import</span> <span class="nb">map</span><span class="p">,</span> <span class="nb">range</span>  <span class="c1"># NOQA</span>
<span class="kn">from</span> <span class="nn">wbia.guitool.__PYQT__</span> <span class="k">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">wbia.guitool.__PYQT__</span> <span class="k">import</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">wbia.guitool.__PYQT__.QtCore</span> <span class="k">import</span> <span class="n">Qt</span>
<span class="kn">from</span> <span class="nn">wbia.guitool.__PYQT__._internal</span> <span class="k">import</span> <span class="n">GUITOOL_PYQT_VERSION</span>  <span class="c1"># NOQA</span>
<span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="kn">from</span> <span class="nn">wbia.guitool</span> <span class="k">import</span> <span class="n">guitool_dialogs</span>
<span class="kn">import</span> <span class="nn">weakref</span>
<span class="p">(</span><span class="nb">print</span><span class="p">,</span> <span class="n">rrr</span><span class="p">,</span> <span class="n">profile</span><span class="p">)</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">inject2</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">DEBUG_WIDGET</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">((</span><span class="s1">&#39;--dbgwgt&#39;</span><span class="p">,</span> <span class="s1">&#39;--debugwidget&#39;</span><span class="p">,</span> <span class="s1">&#39;--debug-widget&#39;</span><span class="p">))</span>

<span class="k">if</span> <span class="n">DEBUG_WIDGET</span><span class="p">:</span>
    <span class="n">WIDGET_BASE</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">WIDGET_BASE</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span>

<span class="n">ALIGN_DICT</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">,</span>
    <span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignRight</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">,</span>
    <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignLeft</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">,</span>
    <span class="s1">&#39;justify&#39;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignJustify</span><span class="p">,</span>
<span class="p">}</span>


<div class="viewcode-block" id="rectifyQtEnum"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.rectifyQtEnum">[docs]</a><span class="k">def</span> <span class="nf">rectifyQtEnum</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ut</span><span class="o">.</span><span class="n">NoParam</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        type_ (str): name of qt enum</span>
<span class="sd">        value (int or str): string or integer value</span>
<span class="sd">        default (int or str): default value</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: rectified_value</span>

<span class="sd">    TODO: move to qt_enums?</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m wbia.guitool.guitool_components rectifyQtEnum</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; newvals = []</span>
<span class="sd">        &gt;&gt;&gt; newvals.append(rectifyQtEnum(&#39;Orientation&#39;, &#39;vert&#39;))</span>
<span class="sd">        &gt;&gt;&gt; newvals.append(rectifyQtEnum(&#39;Orientation&#39;, &#39;Horizontal&#39;))</span>
<span class="sd">        &gt;&gt;&gt; newvals.append(rectifyQtEnum(&#39;LayoutDirection&#39;, &#39;LeftToRight&#39;))</span>
<span class="sd">        &gt;&gt;&gt; newvals.append(rectifyQtEnum(&#39;QSizePolicy&#39;, &#39;Expanding&#39;))</span>
<span class="sd">        &gt;&gt;&gt; result = ut.repr4(newvals)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        &gt;&gt;&gt; assert all(isinstance(v, int) for v in newvals)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="n">ut</span><span class="o">.</span><span class="n">NoParam</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot rectify None value for </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">type_</span><span class="p">))</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">default</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">type_</span> <span class="o">==</span> <span class="s1">&#39;QSizePolicy&#39;</span><span class="p">:</span>
            <span class="n">valid_values</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Fixed&#39;</span><span class="p">,</span> <span class="s1">&#39;Minimum&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum&#39;</span><span class="p">,</span> <span class="s1">&#39;Preferred&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Expanding&#39;</span><span class="p">,</span> <span class="s1">&#39;MinimumExpanding&#39;</span><span class="p">,</span> <span class="s1">&#39;Ignored&#39;</span><span class="p">}</span>
            <span class="n">enum_obj</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span>
        <span class="k">elif</span> <span class="n">type_</span> <span class="o">==</span> <span class="s1">&#39;Alignment&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">,</span>
                <span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignRight</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">,</span>
                <span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignLeft</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">,</span>
                <span class="s1">&#39;justify&#39;</span><span class="p">:</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignJustify</span><span class="p">,</span>
            <span class="p">}[</span><span class="n">value</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">type_</span> <span class="o">==</span> <span class="s1">&#39;LayoutDirection&#39;</span><span class="p">:</span>
            <span class="n">valid_values</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;LeftToRight&#39;</span><span class="p">,</span> <span class="s1">&#39;RightToLeft&#39;</span><span class="p">}</span>
            <span class="n">enum_obj</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span>
        <span class="k">elif</span> <span class="n">type_</span> <span class="o">==</span> <span class="s1">&#39;Orientation&#39;</span><span class="p">:</span>
            <span class="c1"># alias</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;vert&#39;</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;Vertical&#39;</span>
            <span class="k">elif</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;horiz&#39;</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;Horizontal&#39;</span>
            <span class="n">valid_values</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Vertical&#39;</span><span class="p">,</span> <span class="s1">&#39;Horizontal&#39;</span><span class="p">}</span>
            <span class="n">enum_obj</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_values</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Unknown enum </span><span class="si">{}</span><span class="s1"> for </span><span class="si">{}</span><span class="s1">. Valid values are </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">value</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">valid_values</span><span class="p">))</span>
        <span class="n">rectified_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">enum_obj</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rectified_value</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">rectified_value</span></div>


<div class="viewcode-block" id="rectifySizePolicy"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.rectifySizePolicy">[docs]</a><span class="k">def</span> <span class="nf">rectifySizePolicy</span><span class="p">(</span><span class="n">policy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;Expanding&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">rectifyQtEnum</span><span class="p">(</span><span class="s1">&#39;QSizePolicy&#39;</span><span class="p">,</span> <span class="n">policy</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
    <span class="c1"># policy_dict = {</span>
    <span class="c1">#     &#39;Fixed&#39;: QtWidgets.QSizePolicy.Fixed,</span>
    <span class="c1">#     &#39;Minimum&#39;: QtWidgets.QSizePolicy.Minimum,</span>
    <span class="c1">#     &#39;Maximum&#39;: QtWidgets.QSizePolicy.Maximum,</span>
    <span class="c1">#     &#39;Preferred&#39;: QtWidgets.QSizePolicy.Preferred,</span>
    <span class="c1">#     &#39;Expanding&#39;: QtWidgets.QSizePolicy.Expanding,</span>
    <span class="c1">#     &#39;MinimumExpanding&#39;: QtWidgets.QSizePolicy.MinimumExpanding,</span>
    <span class="c1">#     &#39;Ignored&#39;: QtWidgets.QSizePolicy.Ignored,</span>
    <span class="c1"># }</span>
    <span class="c1"># if policy is None:</span>
    <span class="c1">#     policy = default</span>
    <span class="c1"># if isinstance(policy, six.string_types):</span>
    <span class="c1">#     policy = policy_dict[policy]</span>
    <span class="k">return</span> <span class="n">policy</span></div>


<div class="viewcode-block" id="adjustSizePolicy"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.adjustSizePolicy">[docs]</a><span class="k">def</span> <span class="nf">adjustSizePolicy</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vPolicy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hStretch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">vStretch</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">policy</span> <span class="o">=</span> <span class="n">newSizePolicy</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">hSizePolicy</span><span class="o">=</span><span class="n">hPolicy</span><span class="p">,</span> <span class="n">vSizePolicy</span><span class="o">=</span><span class="n">vPolicy</span><span class="p">,</span>
                           <span class="n">hStretch</span><span class="o">=</span><span class="n">hStretch</span><span class="p">,</span> <span class="n">vStretch</span><span class="o">=</span><span class="n">vStretch</span><span class="p">)</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">policy</span><span class="p">)</span></div>


<div class="viewcode-block" id="newSizePolicy"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newSizePolicy">[docs]</a><span class="k">def</span> <span class="nf">newSizePolicy</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">verticalSizePolicy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizontalSizePolicy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">horizontalStretch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verticalStretch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">hSizePolicy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vSizePolicy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vStretch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">hStretch</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    References:</span>
<span class="sd">        https://i.stack.imgur.com/Y8IDK.png</span>
<span class="sd">        http://doc.qt.io/qt-4.8/qsizepolicy.html</span>
<span class="sd">        http://doc.qt.io/qt-5/qsizepolicy.html</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Alias</span>
    <span class="k">if</span> <span class="n">horizontalStretch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hStretch</span> <span class="o">=</span> <span class="n">horizontalStretch</span>
    <span class="k">if</span> <span class="n">verticalStretch</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vStretch</span> <span class="o">=</span> <span class="n">verticalStretch</span>
    <span class="k">if</span> <span class="n">verticalSizePolicy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vSizePolicy</span> <span class="o">=</span> <span class="n">verticalSizePolicy</span>
    <span class="k">if</span> <span class="n">horizontalSizePolicy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hSizePolicy</span> <span class="o">=</span> <span class="n">horizontalSizePolicy</span>
    <span class="c1">#</span>

    <span class="k">if</span> <span class="n">widget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># use existing policy as default</span>
        <span class="n">old</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">sizePolicy</span><span class="p">()</span>
        <span class="n">defaultHPolicy</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">horizontalPolicy</span><span class="p">()</span>
        <span class="n">defaultVPolicy</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">verticalPolicy</span><span class="p">()</span>
        <span class="n">defaultHStretch</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">horizontalStretch</span><span class="p">()</span>
        <span class="n">defaultVStretch</span> <span class="o">=</span> <span class="n">old</span><span class="o">.</span><span class="n">verticalStretch</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">defaultVPolicy</span> <span class="o">=</span> <span class="s1">&#39;Expanding&#39;</span>
        <span class="n">defaultHPolicy</span> <span class="o">=</span> <span class="s1">&#39;Expanding&#39;</span>
        <span class="n">defaultVStretch</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">defaultHStretch</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">hPolicy</span> <span class="o">=</span> <span class="n">rectifyQtEnum</span><span class="p">(</span><span class="s1">&#39;QSizePolicy&#39;</span><span class="p">,</span> <span class="n">hSizePolicy</span><span class="p">,</span> <span class="n">defaultHPolicy</span><span class="p">)</span>
    <span class="n">vPolicy</span> <span class="o">=</span> <span class="n">rectifyQtEnum</span><span class="p">(</span><span class="s1">&#39;QSizePolicy&#39;</span><span class="p">,</span> <span class="n">vSizePolicy</span><span class="p">,</span> <span class="n">defaultVPolicy</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hStretch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hStretch</span> <span class="o">=</span> <span class="n">defaultHStretch</span>
    <span class="k">if</span> <span class="n">vStretch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">vStretch</span> <span class="o">=</span> <span class="n">defaultVStretch</span>

    <span class="n">sizePolicy</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="p">(</span><span class="n">hPolicy</span><span class="p">,</span> <span class="n">vPolicy</span><span class="p">)</span>
    <span class="n">sizePolicy</span><span class="o">.</span><span class="n">setHorizontalStretch</span><span class="p">(</span><span class="n">hStretch</span><span class="p">)</span>
    <span class="n">sizePolicy</span><span class="o">.</span><span class="n">setVerticalStretch</span><span class="p">(</span><span class="n">vStretch</span><span class="p">)</span>
    <span class="c1">#sizePolicy.setHeightForWidth(widget.sizePolicy().hasHeightForWidth())</span>
    <span class="k">return</span> <span class="n">sizePolicy</span></div>


<div class="viewcode-block" id="newSplitter"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newSplitter">[docs]</a><span class="k">def</span> <span class="nf">newSplitter</span><span class="p">(</span><span class="n">widget</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verticalStretch</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">horizontalStretch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    input: widget - the central widget</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">orientation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ori</span> <span class="o">=</span> <span class="n">orientation</span>
    <span class="n">ori</span> <span class="o">=</span> <span class="n">rectifyQtEnum</span><span class="p">(</span><span class="s1">&#39;Orientation&#39;</span><span class="p">,</span> <span class="n">ori</span><span class="p">,</span> <span class="s1">&#39;horiz&#39;</span><span class="p">)</span>
    <span class="n">splitter</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSplitter</span><span class="p">(</span><span class="n">ori</span><span class="p">,</span> <span class="n">widget</span><span class="p">)</span>
    <span class="n">_inject_new_widget_methods</span><span class="p">(</span><span class="n">splitter</span><span class="p">)</span>
    <span class="c1"># This line makes the splitter resize with the widget</span>
    <span class="n">adjustSizePolicy</span><span class="p">(</span><span class="n">splitter</span><span class="p">,</span> <span class="n">hStretch</span><span class="o">=</span><span class="n">horizontalStretch</span><span class="p">,</span>
                     <span class="n">vStretch</span><span class="o">=</span><span class="n">verticalStretch</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">splitter</span></div>


<div class="viewcode-block" id="newScrollArea"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newScrollArea">[docs]</a><span class="k">def</span> <span class="nf">newScrollArea</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">horizontalStretch</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verticalStretch</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">widget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QScrollArea</span><span class="p">()</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">())</span>
    <span class="n">_inject_new_widget_methods</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">widget</span></div>


<div class="viewcode-block" id="newTabWidget"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newTabWidget">[docs]</a><span class="k">def</span> <span class="nf">newTabWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">horizontalStretch</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verticalStretch</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">tabwgt</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTabWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="n">adjustSizePolicy</span><span class="p">(</span><span class="n">tabwgt</span><span class="p">,</span> <span class="n">hStretch</span><span class="o">=</span><span class="n">horizontalStretch</span><span class="p">,</span>
                     <span class="n">vStretch</span><span class="o">=</span><span class="n">verticalStretch</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">addNewTab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="c1">#tab = QtWidgets.QTabWidget()</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="n">GuitoolWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">tabwgt</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1">#QtWidgets.QTabWidget()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="c1">#tab.setLayout(QtWidgets.QVBoxLayout())</span>
        <span class="c1"># tab.setSizePolicy(*cfg_size_policy)</span>
        <span class="c1">#_inject_new_widget_methods(tab)</span>

        <span class="k">def</span> <span class="nf">setTabText</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
            <span class="c1">#tabwgt = tab.parent()</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">tabwgt</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="n">tab</span><span class="p">)</span>
            <span class="n">tabwgt</span><span class="o">.</span><span class="n">setTabText</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

        <span class="n">ut</span><span class="o">.</span><span class="n">inject_func_as_method</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span> <span class="n">setTabText</span><span class="p">,</span> <span class="s1">&#39;setTabText&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tab</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">inject_func_as_method</span><span class="p">(</span><span class="n">tabwgt</span><span class="p">,</span> <span class="n">addNewTab</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tabwgt</span></div>


<div class="viewcode-block" id="newToolbar"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newToolbar">[docs]</a><span class="k">def</span> <span class="nf">newToolbar</span><span class="p">(</span><span class="n">widget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Defines the menubar on top of the main widget &quot;&quot;&quot;</span>
    <span class="n">toolbar</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QToolBar</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
    <span class="c1">#toolbar.setGeometry(QtCore.QRect(0, 0, 1013, 23))</span>
    <span class="n">toolbar</span><span class="o">.</span><span class="n">setContextMenuPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">DefaultContextMenu</span><span class="p">)</span>
    <span class="c1">#menubar.setDefaultUp(False)</span>
    <span class="c1">#menubar.setNativeMenuBar(False)</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">toolbar</span><span class="p">,</span> <span class="s1">&#39;newMenu&#39;</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">newMenu</span><span class="p">,</span> <span class="n">toolbar</span><span class="p">))</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">toolbar</span><span class="p">)</span>
    <span class="c1">#menubar.show()</span>
    <span class="k">return</span> <span class="n">toolbar</span></div>


<div class="viewcode-block" id="newMenubar"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newMenubar">[docs]</a><span class="k">def</span> <span class="nf">newMenubar</span><span class="p">(</span><span class="n">widget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Defines the menubar on top of the main widget &quot;&quot;&quot;</span>
    <span class="n">menubar</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMenuBar</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
    <span class="c1">#menubar.setGeometry(QtCore.QRect(0, 0, 1013, 23))</span>
    <span class="n">menubar</span><span class="o">.</span><span class="n">setContextMenuPolicy</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">DefaultContextMenu</span><span class="p">)</span>
    <span class="n">menubar</span><span class="o">.</span><span class="n">setDefaultUp</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">menubar</span><span class="o">.</span><span class="n">setNativeMenuBar</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">menubar</span><span class="p">,</span> <span class="s1">&#39;newMenu&#39;</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">newMenu</span><span class="p">,</span> <span class="n">menubar</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="s1">&#39;setMenuBar&#39;</span><span class="p">):</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setMenuBar</span><span class="p">(</span><span class="n">menubar</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="s1">&#39;addWidget&#39;</span><span class="p">):</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">menubar</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">menubar</span><span class="p">)</span>
        <span class="c1">#menubar.show()</span>
    <span class="k">return</span> <span class="n">menubar</span></div>


<div class="viewcode-block" id="newQPoint"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newQPoint">[docs]</a><span class="k">def</span> <span class="nf">newQPoint</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span></div>


<div class="viewcode-block" id="newMenu"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newMenu">[docs]</a><span class="k">def</span> <span class="nf">newMenu</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Defines each menu category in the menubar/toolbar/menu &quot;&quot;&quot;</span>
    <span class="n">menu</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMenu</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">menu</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="c1"># Define a custom newAction function for the menu</span>
    <span class="c1"># The QT function is called addAction</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="s1">&#39;newAction&#39;</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">newMenuAction</span><span class="p">,</span> <span class="n">menu</span><span class="p">))</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="s1">&#39;newMenu&#39;</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">newMenu</span><span class="p">,</span> <span class="n">menu</span><span class="p">))</span>
    <span class="c1"># Add the menu to the parent menu/menubar</span>
    <span class="n">parent</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">menu</span><span class="o">.</span><span class="n">menuAction</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">menu</span></div>


<div class="viewcode-block" id="newMenuAction"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newMenuAction">[docs]</a><span class="k">def</span> <span class="nf">newMenuAction</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shortcut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">tooltip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">slot_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">triggered</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Added as a helper function to menus</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># convert to new style</span>
    <span class="k">if</span> <span class="n">triggered</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">slot_fn</span> <span class="o">=</span> <span class="n">triggered</span>
    <span class="n">triggered</span> <span class="o">=</span> <span class="n">slot_fn</span>

    <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">triggered</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_funcname</span><span class="p">(</span><span class="n">triggered</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1">#if name is None:</span>
    <span class="c1">#    # it is usually better to specify the name explicitly</span>
    <span class="c1">#    name = ut.convert_text_to_varname(&#39;action&#39; + text)</span>
    <span class="c1">#assert name is not None, &#39;menuAction name cannot be None&#39;</span>

    <span class="c1"># Dynamically add new menu actions programatically</span>
    <span class="n">action_shortcut</span> <span class="o">=</span> <span class="n">shortcut</span>
    <span class="n">action_tooltip</span>  <span class="o">=</span> <span class="n">tooltip</span>
    <span class="c1">#if hasattr(menu, name):</span>
    <span class="c1">#    raise Exception(&#39;menu action already defined&#39;)</span>
    <span class="c1"># Create new action</span>
    <span class="n">action</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QAction</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span>
    <span class="c1">#setattr(parent, name, action)</span>

    <span class="n">action</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enabled</span><span class="p">)</span>
    <span class="n">action</span><span class="o">.</span><span class="n">setShortcutContext</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ApplicationShortcut</span><span class="p">)</span>
    <span class="c1">#menu = getattr(parent, menu_name)</span>
    <span class="c1">#menu = parent</span>
    <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">name</span>
    <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">action_tooltip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">action_tooltip</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">action_shortcut</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setShortcut</span><span class="p">(</span><span class="n">action_shortcut</span><span class="p">)</span>
        <span class="c1">#action.setShortcutContext(Qt.WidgetWithChildrenShortcut)</span>
        <span class="n">action</span><span class="o">.</span><span class="n">setShortcutContext</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowShortcut</span><span class="p">)</span>
        <span class="c1">#print(&#39;&lt;%s&gt;.setShortcut(%r)&#39; % (name, action_shortcut,))</span>
    <span class="k">if</span> <span class="n">triggered</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">action</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">triggered</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">action</span></div>


<span class="n">PROG_TEXT</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_argflag</span><span class="p">(</span><span class="s1">&#39;--progtext&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="GuiProgContext"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.GuiProgContext">[docs]</a><span class="k">class</span> <span class="nc">GuiProgContext</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">prog_bar</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">PROG_TEXT</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[guitool] GuiProgContext.__init__&#39;</span><span class="p">)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">prog_bar</span> <span class="o">=</span> <span class="n">prog_bar</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prog_hook</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ctx</span><span class="o">.</span><span class="n">prog_bar</span><span class="o">.</span><span class="n">utool_prog_hook</span>

<div class="viewcode-block" id="GuiProgContext.set_progress"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.GuiProgContext.set_progress">[docs]</a>    <span class="k">def</span> <span class="nf">set_progress</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">total</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">total</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">total</span>
        <span class="k">if</span> <span class="n">count</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">prog_hook</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">prog_hook</span><span class="o">.</span><span class="n">set_progress</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">msg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">prog_bar</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">title</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="GuiProgContext.set_total"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.GuiProgContext.set_total">[docs]</a>    <span class="k">def</span> <span class="nf">set_total</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">total</span><span class="p">):</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">total</span> <span class="o">=</span> <span class="n">total</span></div>

    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">PROG_TEXT</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[guitool] GuiProgContext.__enter__&#39;</span><span class="p">)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">prog_bar</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">prog_bar</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">ctx</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">prog_hook</span><span class="o">.</span><span class="n">lbl</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="n">title</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">prog_bar</span><span class="o">.</span><span class="n">utool_prog_hook</span><span class="o">.</span><span class="n">set_progress</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Doesn&#39;t seem to work correctly</span>
        <span class="c1">#prog_bar.utool_prog_hook.show_indefinite_progress()</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">prog_bar</span><span class="o">.</span><span class="n">utool_prog_hook</span><span class="o">.</span><span class="n">force_event_update</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">ctx</span>

    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">type_</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">trace</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">PROG_TEXT</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[guitool] GuiProgContext.__exit__&#39;</span><span class="p">)</span>
        <span class="n">ctx</span><span class="o">.</span><span class="n">prog_bar</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">trace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[back] Error in context manager!: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">False</span>  <span class="c1"># return a falsey value on error</span></div>


<div class="viewcode-block" id="ProgHook"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook">[docs]</a><span class="k">class</span> <span class="nc">ProgHook</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QObject</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">NiceRepr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    hooks into utool.ProgressIterator.</span>

<span class="sd">    A hook represents a fraction of a progress step.</span>
<span class="sd">    Hooks can be divided recursively</span>

<span class="sd">    TODO:</span>
<span class="sd">        use signals and slots to connect to the progress bar</span>
<span class="sd">        still doesn&#39;t work correctly even with signals and slots, probably</span>
<span class="sd">          need to do task function in another thread</span>

<span class="sd">        if False:</span>
<span class="sd">            for x in ut.ProgIter(ut.expensive_task_gen(40000), length=40000,</span>
<span class="sd">                                 prog_hook=ctx.prog_hook):</span>
<span class="sd">                pass</span>

<span class="sd">    References:</span>
<span class="sd">        http://stackoverflow.com/questions/19442443/busy-indication-with-pyqt-progress-bar</span>

<span class="sd">    Args:</span>
<span class="sd">        prog_bar (Qt.QProgressBar):</span>
<span class="sd">        substep_min (int): (default = 0)</span>
<span class="sd">        substep_size (int): (default = 1)</span>
<span class="sd">        level (int): (default = 0)</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m wbia.guitool.guitool_components ProgHook --show  --progtext</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import wbia.guitool as gt</span>
<span class="sd">        &gt;&gt;&gt; app = gt.ensure_qtapp()[0]</span>
<span class="sd">        &gt;&gt;&gt; parent = newWidget()</span>
<span class="sd">        &gt;&gt;&gt; parent.show()</span>
<span class="sd">        &gt;&gt;&gt; parent.resize(600, 40)</span>
<span class="sd">        &gt;&gt;&gt; prog_bar = newProgressBar(parent, visible=True)</span>
<span class="sd">        &gt;&gt;&gt; hook = prog_bar.utool_prog_hook</span>
<span class="sd">        &gt;&gt;&gt; subhook_list = hook.subdivide(num=4)</span>
<span class="sd">        &gt;&gt;&gt; hook_0_25 = subhook_list[0]</span>
<span class="sd">        &gt;&gt;&gt; hook_0_25.length = 2</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;hook_0_25 = %s&#39; % (hook_0_25,))</span>
<span class="sd">        &gt;&gt;&gt; hook_0_25.set_progress(0)</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;hook_0_25 = %s&#39; % (hook_0_25,))</span>
<span class="sd">        &gt;&gt;&gt; hook_0_25.set_progress(1)</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;hook_0_25 = %s&#39; % (hook_0_25,))</span>
<span class="sd">        &gt;&gt;&gt; substep_hooks_0_25 = hook_0_25.make_substep_hooks(num=4)</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;substep_hooks_0_25 = %s&#39; % (ut.repr2(substep_hooks_0_25, strvals=True),))</span>
<span class="sd">        &gt;&gt;&gt; subhook = substep_hooks_0_25[0]</span>
<span class="sd">        &gt;&gt;&gt; progiter = ut.ProgIter(list(range(4)), prog_hook=subhook)</span>
<span class="sd">        &gt;&gt;&gt; iter_ = iter(progiter)</span>
<span class="sd">        &gt;&gt;&gt; six.next(iter_)</span>
<span class="sd">        &gt;&gt;&gt; hook(2, 2)</span>
<span class="sd">        &gt;&gt;&gt; subhook2 = substep_hooks_0_25[1]</span>
<span class="sd">        &gt;&gt;&gt; subsubhooks = subhook2.subdivide(num=2)</span>
<span class="sd">        &gt;&gt;&gt; subsubhooks[0](0, 3)</span>
<span class="sd">        &gt;&gt;&gt; subsubhooks[0](1, 3)</span>
<span class="sd">        &gt;&gt;&gt; subsubhooks[0](2, 3, &#39;special part&#39;)</span>
<span class="sd">        &gt;&gt;&gt; subsubhooks[0](3, 3, &#39;other part&#39;)</span>
<span class="sd">        &gt;&gt;&gt; app.processEvents()</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--show)</span>
<span class="sd">        &gt;&gt;&gt; ut.quit_if_noshow()</span>
<span class="sd">        &gt;&gt;&gt; import wbia.plottool as pt</span>
<span class="sd">        &gt;&gt;&gt; ut.show_if_requested()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">progress_changed_signal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="n">show_indefinite_progress_signal</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">hook</span><span class="p">,</span> <span class="n">prog_bar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">global_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">global_max</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ProgHook</span><span class="p">,</span> <span class="n">hook</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">prog_bar</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hook</span><span class="o">.</span><span class="n">progressBarRef</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hook</span><span class="o">.</span><span class="n">progressBarRef</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">prog_bar</span><span class="p">)</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">global_min</span> <span class="o">=</span> <span class="n">global_min</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">global_max</span> <span class="o">=</span> <span class="n">global_max</span>
        <span class="c1">#hook.substep_min = substep_min</span>
        <span class="c1">#hook.substep_size = substep_size</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">progiter</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">lbl</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">child_hook_gen</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">progress_changed_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">on_progress_changed</span><span class="p">)</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">show_indefinite_progress_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">show_indefinite_progress_slot</span><span class="p">)</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">show_text</span> <span class="o">=</span> <span class="n">PROG_TEXT</span>

    <span class="k">def</span> <span class="nf">__nice__</span><span class="p">(</span><span class="n">hook</span><span class="p">):</span>
        <span class="n">gmin</span><span class="p">,</span> <span class="n">gmax</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">global_bounds</span><span class="p">()</span>
        <span class="n">lbl</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">lbl</span>
        <span class="n">gpos</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">global_progress</span><span class="p">()</span>
        <span class="n">lpos</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">local_progress</span><span class="p">()</span>
        <span class="k">return</span> <span class="s1">&#39;(</span><span class="si">%s</span><span class="s1">, [</span><span class="si">%r</span><span class="s1">, </span><span class="si">%r</span><span class="s1"> ,</span><span class="si">%r</span><span class="s1">], </span><span class="si">%r</span><span class="s1">=</span><span class="si">%d</span><span class="s1">/</span><span class="si">%d</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="n">gmin</span><span class="p">,</span> <span class="n">gpos</span><span class="p">,</span> <span class="n">gmax</span><span class="p">,</span> <span class="n">lpos</span><span class="p">,</span> <span class="n">hook</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="n">hook</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">prog_bar</span><span class="p">(</span><span class="n">hook</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">hook</span><span class="o">.</span><span class="n">progressBarRef</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">prog_bar</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">progressBarRef</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">prog_bar</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="n">hook</span><span class="p">):</span>
        <span class="c1">#progiter = Noe</span>
        <span class="c1">#if hook.progiter is not None:</span>
        <span class="c1">#    progiter = hook.progiter()</span>
        <span class="c1">#if progiter is  not None:</span>
        <span class="c1">#    # prog iter is one step ahead</span>
        <span class="c1">#    #count = max(progiter.count - 1, 0)</span>
        <span class="c1">#    count = progiter.count</span>
        <span class="c1">#else:</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">_count</span>
        <span class="k">return</span> <span class="n">count</span>

<div class="viewcode-block" id="ProgHook.global_bounds"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook.global_bounds">[docs]</a>    <span class="k">def</span> <span class="nf">global_bounds</span><span class="p">(</span><span class="n">hook</span><span class="p">):</span>
        <span class="n">min_</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">global_min</span>
        <span class="n">max_</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">global_max</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">min_</span><span class="p">,</span> <span class="n">max_</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProgHook.global_extent"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook.global_extent">[docs]</a>    <span class="k">def</span> <span class="nf">global_extent</span><span class="p">(</span><span class="n">hook</span><span class="p">):</span>
        <span class="n">min_</span><span class="p">,</span> <span class="n">max_</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">global_bounds</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">max_</span> <span class="o">-</span> <span class="n">min_</span></div>

<div class="viewcode-block" id="ProgHook.register_progiter"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook.register_progiter">[docs]</a>    <span class="k">def</span> <span class="nf">register_progiter</span><span class="p">(</span><span class="n">hook</span><span class="p">,</span> <span class="n">progiter</span><span class="p">):</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">progiter</span> <span class="o">=</span> <span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="n">progiter</span><span class="p">)</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">progiter</span><span class="p">()</span><span class="o">.</span><span class="n">length</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">lbl</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">progiter</span><span class="p">()</span><span class="o">.</span><span class="n">lbl</span></div>

<div class="viewcode-block" id="ProgHook.initialize_subhooks"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook.initialize_subhooks">[docs]</a>    <span class="k">def</span> <span class="nf">initialize_subhooks</span><span class="p">(</span><span class="n">hook</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">subhooks</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">make_substep_hooks</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">spacing</span><span class="p">)</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">child_hook_gen</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">subhooks</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProgHook.next_subhook"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook.next_subhook">[docs]</a>    <span class="k">def</span> <span class="nf">next_subhook</span><span class="p">(</span><span class="n">hook</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">six</span><span class="o">.</span><span class="n">next</span><span class="p">(</span><span class="n">hook</span><span class="o">.</span><span class="n">child_hook_gen</span><span class="p">)</span></div>

<div class="viewcode-block" id="ProgHook.subdivide"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook.subdivide">[docs]</a>    <span class="k">def</span> <span class="nf">subdivide</span><span class="p">(</span><span class="n">hook</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Branches this hook into several new leafs.</span>
<span class="sd">        Only progress leafs are used to indicate global progress.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
        <span class="k">if</span> <span class="n">num</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spacing</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">spacing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Assume uniform sub iterators</span>
            <span class="n">spacing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">spacing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spacing</span><span class="p">)</span>

        <span class="c1">#min_, max_ = hook.global_bounds()</span>
        <span class="n">extent</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">global_extent</span><span class="p">()</span>
        <span class="n">global_spacing</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">global_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">spacing</span> <span class="o">*</span> <span class="n">extent</span><span class="p">)</span>
        <span class="n">sub_min_list</span> <span class="o">=</span> <span class="n">global_spacing</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">sub_max_list</span> <span class="o">=</span> <span class="n">global_spacing</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="n">prog_bar</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">prog_bar</span>
        <span class="n">subhook_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ProgHook</span><span class="p">(</span><span class="n">prog_bar</span><span class="p">,</span> <span class="n">min_</span><span class="p">,</span> <span class="n">max_</span><span class="p">,</span> <span class="n">hook</span><span class="o">.</span><span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">min_</span><span class="p">,</span> <span class="n">max_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sub_min_list</span><span class="p">,</span> <span class="n">sub_max_list</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">subhook_list</span></div>

<div class="viewcode-block" id="ProgHook.make_substep_hooks"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook.make_substep_hooks">[docs]</a>    <span class="k">def</span> <span class="nf">make_substep_hooks</span><span class="p">(</span><span class="n">hook</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This takes into account your current position, and gives you only</span>
<span class="sd">        enough subhooks to complete a single step.</span>

<span class="sd">        Need to know current count, stepsize, and total number of steps in this</span>
<span class="sd">        subhook.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">            &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">            &gt;&gt;&gt; import wbia.guitool as gt</span>
<span class="sd">            &gt;&gt;&gt; app = gt.ensure_qtapp()[0]</span>
<span class="sd">            &gt;&gt;&gt; hook = ProgHook(None)</span>
<span class="sd">            &gt;&gt;&gt; subhook_list = hook.subdivide(num=4)</span>
<span class="sd">            &gt;&gt;&gt; hook_0_25 = subhook_list[0]</span>
<span class="sd">            &gt;&gt;&gt; hook = hook_0_25</span>
<span class="sd">            &gt;&gt;&gt; hook(1, 2)</span>
<span class="sd">            &gt;&gt;&gt; print(&#39;hook = %r&#39; % (hook,))</span>
<span class="sd">            &gt;&gt;&gt; subhook_list1 = hook.make_substep_hooks(1)</span>
<span class="sd">            &gt;&gt;&gt; subhook1 = subhook_list1[0]</span>
<span class="sd">            &gt;&gt;&gt; print(&#39;subhook1 = %r&#39; % (subhook1,))</span>
<span class="sd">            &gt;&gt;&gt; subhook_list2 = hook.make_substep_hooks(2)</span>
<span class="sd">            &gt;&gt;&gt; subhook2 = subhook_list2[1]</span>
<span class="sd">            &gt;&gt;&gt; subhook2.show_text = True</span>
<span class="sd">            &gt;&gt;&gt; # Test progress iter</span>
<span class="sd">            &gt;&gt;&gt; progiter = ut.ProgIter(list(range(3)), lbl=&#39;foo&#39;, prog_hook=subhook2)</span>
<span class="sd">            &gt;&gt;&gt; iter_ = iter(progiter); print(&#39;subhook2 = %r&#39; % (subhook2,))</span>
<span class="sd">            &gt;&gt;&gt; # Iter</span>
<span class="sd">            &gt;&gt;&gt; print(six.next(iter_)); print(&#39;subhook2 = %r&#39; % (subhook2,))</span>
<span class="sd">            &gt;&gt;&gt; print(six.next(iter_)); print(&#39;subhook2 = %r&#39; % (subhook2,))</span>
<span class="sd">            &gt;&gt;&gt; print(six.next(iter_)); print(&#39;subhook2 = %r&#39; % (subhook2,))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
        <span class="k">if</span> <span class="n">num</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spacing</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">spacing</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">spacing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Assume uniform sub iterators</span>
        <span class="n">spacing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spacing</span><span class="p">)</span>
        <span class="n">length</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">length</span>
        <span class="n">step_extent_local</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">length</span>
        <span class="n">step_extent_global</span> <span class="o">=</span> <span class="n">step_extent_local</span> <span class="o">*</span> <span class="n">hook</span><span class="o">.</span><span class="n">global_extent</span><span class="p">()</span>

        <span class="c1">#assert hook.count &lt; length, &#39;already finished this subhook&#39;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">count</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="n">length</span><span class="p">:</span>
            <span class="c1"># HACK</span>
            <span class="n">count</span> <span class="o">=</span> <span class="n">length</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="n">step_min</span> <span class="o">=</span> <span class="n">count</span> <span class="o">*</span> <span class="n">step_extent_global</span> <span class="o">+</span> <span class="n">hook</span><span class="o">.</span><span class="n">global_min</span>
        <span class="n">global_spacing</span> <span class="o">=</span> <span class="n">step_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">spacing</span> <span class="o">*</span> <span class="n">step_extent_global</span><span class="p">)</span>
        <span class="n">sub_min_list</span> <span class="o">=</span> <span class="n">global_spacing</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">sub_max_list</span> <span class="o">=</span> <span class="n">global_spacing</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="n">hook</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="n">hook</span><span class="o">.</span><span class="n">global_extent</span><span class="p">()</span>

        <span class="n">prog_bar</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">prog_bar</span>
        <span class="n">subhook_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ProgHook</span><span class="p">(</span><span class="n">prog_bar</span><span class="p">,</span> <span class="n">min_</span><span class="p">,</span> <span class="n">max_</span><span class="p">,</span> <span class="n">hook</span><span class="o">.</span><span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">min_</span><span class="p">,</span> <span class="n">max_</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sub_min_list</span><span class="p">,</span> <span class="n">sub_max_list</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">subhook_list</span></div>

        <span class="c1">#subhook_list = [ProgHook(hook.progressBarRef(), substep_min, substep_size, hook.level + 1)</span>
        <span class="c1">#                for substep_min in substep_min_list]</span>
        <span class="c1">#return subhook_list</span>

        <span class="c1">#step_min = ((count - 1) / length) * hook.substep_size  + hook.substep_min</span>
        <span class="c1">#step_size = (1.0 / length) * hook.substep_size</span>

        <span class="c1">#substep_size = step_size / num_substeps</span>
        <span class="c1">#substep_min_list = [(step * substep_size) + step_min for step in range(num_substeps)]</span>

        <span class="c1">#DEBUG = False</span>
        <span class="c1">#if DEBUG:</span>
        <span class="c1">#    with ut.Indenter(&#39; &#39; * 4 * length):</span>
        <span class="c1">#        print(&#39;\n&#39;)</span>
        <span class="c1">#        print(&#39;+____&lt;NEW SUBSTEPS&gt;____&#39;)</span>
        <span class="c1">#        print(&#39;Making %d substeps for hook.lbl = %s&#39; % (num_substeps, hook.lbl,))</span>
        <span class="c1">#        print(&#39; * step_min         = %.2f&#39; % (step_min,))</span>
        <span class="c1">#        print(&#39; * step_size        = %.2f&#39; % (step_size,))</span>
        <span class="c1">#        print(&#39; * substep_size     = %.2f&#39; % (substep_size,))</span>
        <span class="c1">#        print(&#39; * substep_min_list = %r&#39; % (substep_min_list,))</span>
        <span class="c1">#        print(r&#39;L____&lt;/NEW SUBSTEPS&gt;____&#39;)</span>
        <span class="c1">#        print(&#39;\n&#39;)</span>

<div class="viewcode-block" id="ProgHook.set_progress"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook.set_progress">[docs]</a>    <span class="k">def</span> <span class="nf">set_progress</span><span class="p">(</span><span class="n">hook</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lbl</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">length</span>
            <span class="k">if</span> <span class="n">length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">length</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hook</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">length</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">_count</span> <span class="o">=</span> <span class="n">count</span>
        <span class="k">if</span> <span class="n">lbl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">hook</span><span class="o">.</span><span class="n">lbl</span> <span class="o">=</span> <span class="n">lbl</span>
        <span class="n">global_fraction</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">global_progress</span><span class="p">()</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">progress_changed_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">global_fraction</span><span class="p">,</span> <span class="n">hook</span><span class="o">.</span><span class="n">lbl</span><span class="p">)</span></div>
        <span class="c1">#hook.on_progress_changed(global_fraction, hook.lbl)</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="n">hook</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lbl</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">set_progress</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">lbl</span><span class="p">)</span>

<div class="viewcode-block" id="ProgHook.local_progress"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook.local_progress">[docs]</a>    <span class="k">def</span> <span class="nf">local_progress</span><span class="p">(</span><span class="n">hook</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; percent done of this subhook &quot;&quot;&quot;</span>
        <span class="n">length</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">length</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">count</span>
        <span class="n">local_fraction</span> <span class="o">=</span> <span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="o">/</span> <span class="n">length</span>
        <span class="k">return</span> <span class="n">local_fraction</span></div>

<div class="viewcode-block" id="ProgHook.global_progress"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook.global_progress">[docs]</a>    <span class="k">def</span> <span class="nf">global_progress</span><span class="p">(</span><span class="n">hook</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; percent done of entire process &quot;&quot;&quot;</span>
        <span class="n">local_fraction</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">local_progress</span><span class="p">()</span>
        <span class="n">extent</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">global_extent</span><span class="p">()</span>
        <span class="n">global_min</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">global_min</span>
        <span class="n">global_fraction</span> <span class="o">=</span> <span class="n">global_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">local_fraction</span> <span class="o">*</span> <span class="n">extent</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">global_fraction</span></div>

<div class="viewcode-block" id="ProgHook.on_progress_changed"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook.on_progress_changed">[docs]</a>    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_progress_changed</span><span class="p">(</span><span class="n">hook</span><span class="p">,</span> <span class="n">global_fraction</span><span class="p">,</span> <span class="n">lbl</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">hook</span><span class="o">.</span><span class="n">show_text</span><span class="p">:</span>
            <span class="n">resolution</span> <span class="o">=</span> <span class="mi">75</span>
            <span class="n">num_full</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">global_fraction</span> <span class="o">*</span> <span class="n">resolution</span><span class="p">))</span>
            <span class="n">num_empty</span> <span class="o">=</span> <span class="n">resolution</span> <span class="o">-</span> <span class="n">num_full</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="s1">&#39;#&#39;</span> <span class="o">*</span> <span class="n">num_full</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">*</span> <span class="n">num_empty</span> <span class="o">+</span> <span class="s1">&#39;] </span><span class="si">%7.3f%%</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">global_fraction</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">hook</span><span class="o">.</span><span class="n">lbl</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">prog_bar</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">prog_bar</span>
        <span class="k">if</span> <span class="n">prog_bar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prog_bar</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
            <span class="n">prog_bar</span><span class="o">.</span><span class="n">setMinimum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">prog_bar</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">prog_bar</span><span class="o">.</span><span class="n">maximum</span><span class="p">()</span> <span class="o">*</span> <span class="n">global_fraction</span><span class="p">))</span>
            <span class="n">prog_bar</span><span class="o">.</span><span class="n">setFormat</span><span class="p">(</span><span class="n">lbl</span> <span class="o">+</span> <span class="s1">&#39; %p%&#39;</span><span class="p">)</span>
            <span class="n">prog_bar</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="c1">#prog_bar.setProperty(&#39;value&#39;, value)</span>
            <span class="c1"># major hack</span>
            <span class="n">hook</span><span class="o">.</span><span class="n">force_event_update</span><span class="p">()</span></div>

<div class="viewcode-block" id="ProgHook.show_indefinite_progress_slot"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook.show_indefinite_progress_slot">[docs]</a>    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">show_indefinite_progress_slot</span><span class="p">(</span><span class="n">hook</span><span class="p">):</span>
        <span class="n">prog_bar</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="n">prog_bar</span>
        <span class="k">if</span> <span class="n">prog_bar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prog_bar</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="n">prog_bar</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">prog_bar</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">hook</span><span class="o">.</span><span class="n">force_event_update</span><span class="p">()</span></div>

<div class="viewcode-block" id="ProgHook.show_indefinite_progress"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook.show_indefinite_progress">[docs]</a>    <span class="k">def</span> <span class="nf">show_indefinite_progress</span><span class="p">(</span><span class="n">hook</span><span class="p">):</span>
        <span class="n">hook</span><span class="o">.</span><span class="n">show_indefinite_progress_signal</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span></div>

<div class="viewcode-block" id="ProgHook.force_event_update"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ProgHook.force_event_update">[docs]</a>    <span class="k">def</span> <span class="nf">force_event_update</span><span class="p">(</span><span class="n">hook</span><span class="p">):</span>
        <span class="c1"># major hack</span>
        <span class="kn">import</span> <span class="nn">wbia.guitool</span>
        <span class="n">qtapp</span> <span class="o">=</span> <span class="n">guitool</span><span class="o">.</span><span class="n">get_qtapp</span><span class="p">()</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QEventLoop</span><span class="o">.</span><span class="n">ExcludeUserInputEvents</span>
        <span class="n">return_status</span> <span class="o">=</span> <span class="n">qtapp</span><span class="o">.</span><span class="n">processEvents</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="c1">#print(&#39;(1)return_status = %r&#39; % (return_status,))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">return_status</span><span class="p">:</span>
            <span class="n">return_status</span> <span class="o">=</span> <span class="n">qtapp</span><span class="o">.</span><span class="n">processEvents</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span></div></div>
            <span class="c1">#print(&#39;(2)return_status = %r&#39; % (return_status,))</span>


<div class="viewcode-block" id="newProgressBar"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newProgressBar">[docs]</a><span class="k">def</span> <span class="nf">newProgressBar</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verticalStretch</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        parent (?):</span>
<span class="sd">        visible (bool):</span>
<span class="sd">        verticalStretch (int):</span>

<span class="sd">    Returns:</span>
<span class="sd">        QProgressBar: progressBar</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m wbia.guitool.guitool_components --test-newProgressBar:0</span>
<span class="sd">        python -m wbia.guitool.guitool_components --test-newProgressBar:0 --show</span>
<span class="sd">        python -m wbia.guitool.guitool_components --test-newProgressBar:1</span>
<span class="sd">        python -m wbia.guitool.guitool_components --test-newProgressBar:2</span>
<span class="sd">        python -m wbia.guitool.guitool_components --test-newProgressBar:1 --progtext</span>
<span class="sd">        python -m wbia.guitool.guitool_components --test-newProgressBar:2 --progtext</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # GUI_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--gui)</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; import wbia.guitool</span>
<span class="sd">        &gt;&gt;&gt; guitool.ensure_qtapp()</span>
<span class="sd">        &gt;&gt;&gt; parent = None</span>
<span class="sd">        &gt;&gt;&gt; visible = True</span>
<span class="sd">        &gt;&gt;&gt; verticalStretch = 1</span>
<span class="sd">        &gt;&gt;&gt; # hook into utool progress iter</span>
<span class="sd">        &gt;&gt;&gt; progressBar = newProgressBar(parent, visible, verticalStretch)</span>
<span class="sd">        &gt;&gt;&gt; progressBar.show()</span>
<span class="sd">        &gt;&gt;&gt; progressBar.utool_prog_hook.show_indefinite_progress()</span>
<span class="sd">        &gt;&gt;&gt; #progressBar.utool_prog_hook.set_progress(0)</span>
<span class="sd">        &gt;&gt;&gt; #import time</span>
<span class="sd">        &gt;&gt;&gt; qtapp = guitool.get_qtapp()</span>
<span class="sd">        &gt;&gt;&gt; [(qtapp.processEvents(), ut.get_nth_prime_bruteforce(300)) for x in range(100)]</span>
<span class="sd">        &gt;&gt;&gt; #time.sleep(5)</span>
<span class="sd">        &gt;&gt;&gt; progiter = ut.ProgIter(range(100), freq=1, autoadjust=False, prog_hook=progressBar.utool_prog_hook)</span>
<span class="sd">        &gt;&gt;&gt; results1 = [ut.get_nth_prime_bruteforce(300) for x in progiter]</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--show)</span>
<span class="sd">        &gt;&gt;&gt; ut.quit_if_noshow()</span>
<span class="sd">        &gt;&gt;&gt; guitool.qtapp_loop(freq=10)</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # GUI_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--gui)</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; import wbia.guitool</span>
<span class="sd">        &gt;&gt;&gt; guitool.ensure_qtapp()</span>
<span class="sd">        &gt;&gt;&gt; parent = None</span>
<span class="sd">        &gt;&gt;&gt; visible = True</span>
<span class="sd">        &gt;&gt;&gt; verticalStretch = 1</span>
<span class="sd">        &gt;&gt;&gt; def complex_tasks(hook):</span>
<span class="sd">        &gt;&gt;&gt;     progkw = dict(freq=1, backspace=False, autoadjust=False)</span>
<span class="sd">        &gt;&gt;&gt;     num = 800</span>
<span class="sd">        &gt;&gt;&gt;     for x in ut.ProgIter(range(2), lbl=&#39;TASK&#39;, prog_hook=hook, **progkw):</span>
<span class="sd">        &gt;&gt;&gt;         ut.get_nth_prime_bruteforce(num)</span>
<span class="sd">        &gt;&gt;&gt;         subhook1, subhook2 = hook.make_substep_hooks(2)</span>
<span class="sd">        &gt;&gt;&gt;         for task1 in ut.ProgIter(range(2), lbl=&#39;task1.1&#39;, prog_hook=subhook1, **progkw):</span>
<span class="sd">        &gt;&gt;&gt;             ut.get_nth_prime_bruteforce(num)</span>
<span class="sd">        &gt;&gt;&gt;         for task2 in ut.ProgIter(range(2), lbl=&#39;task1.2&#39;, prog_hook=subhook2, **progkw):</span>
<span class="sd">        &gt;&gt;&gt;             ut.get_nth_prime_bruteforce(num)</span>
<span class="sd">        &gt;&gt;&gt; # hook into utool progress iter</span>
<span class="sd">        &gt;&gt;&gt; progressBar = newProgressBar(parent, visible, verticalStretch)</span>
<span class="sd">        &gt;&gt;&gt; hook = progressBar.utool_prog_hook</span>
<span class="sd">        &gt;&gt;&gt; complex_tasks(hook)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--show)</span>
<span class="sd">        &gt;&gt;&gt; ut.quit_if_noshow()</span>
<span class="sd">        &gt;&gt;&gt; guitool.qtapp_loop(freq=10)</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # GUI_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--gui)</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; import wbia.guitool</span>
<span class="sd">        &gt;&gt;&gt; guitool.ensure_qtapp()</span>
<span class="sd">        &gt;&gt;&gt; parent = None</span>
<span class="sd">        &gt;&gt;&gt; visible = True</span>
<span class="sd">        &gt;&gt;&gt; verticalStretch = 1</span>
<span class="sd">        &gt;&gt;&gt; def complex_tasks(hook):</span>
<span class="sd">        &gt;&gt;&gt;     progkw = dict(freq=1, backspace=False, autoadjust=False)</span>
<span class="sd">        &gt;&gt;&gt;     num = 800</span>
<span class="sd">        &gt;&gt;&gt;     for x in ut.ProgIter(range(4), lbl=&#39;TASK&#39;, prog_hook=hook, **progkw):</span>
<span class="sd">        &gt;&gt;&gt;         ut.get_nth_prime_bruteforce(num)</span>
<span class="sd">        &gt;&gt;&gt;         subhook1, subhook2 = hook.make_substep_hooks(2)</span>
<span class="sd">        &gt;&gt;&gt;         for task1 in ut.ProgIter(range(2), lbl=&#39;task1.1&#39;, prog_hook=subhook1, **progkw):</span>
<span class="sd">        &gt;&gt;&gt;             ut.get_nth_prime_bruteforce(num)</span>
<span class="sd">        &gt;&gt;&gt;             subsubhooks = subhook1.make_substep_hooks(3)</span>
<span class="sd">        &gt;&gt;&gt;             for task1 in ut.ProgIter(range(7), lbl=&#39;task1.1.1&#39;, prog_hook=subsubhooks[0], **progkw):</span>
<span class="sd">        &gt;&gt;&gt;                 ut.get_nth_prime_bruteforce(num)</span>
<span class="sd">        &gt;&gt;&gt;             for task1 in ut.ProgIter(range(11), lbl=&#39;task1.1.2&#39;, prog_hook=subsubhooks[1], **progkw):</span>
<span class="sd">        &gt;&gt;&gt;                 ut.get_nth_prime_bruteforce(num)</span>
<span class="sd">        &gt;&gt;&gt;             for task1 in ut.ProgIter(range(3), lbl=&#39;task1.1.3&#39;, prog_hook=subsubhooks[2], **progkw):</span>
<span class="sd">        &gt;&gt;&gt;                 ut.get_nth_prime_bruteforce(num)</span>
<span class="sd">        &gt;&gt;&gt;         for task2 in ut.ProgIter(range(10), lbl=&#39;task1.2&#39;, prog_hook=subhook2, **progkw):</span>
<span class="sd">        &gt;&gt;&gt;             ut.get_nth_prime_bruteforce(num)</span>
<span class="sd">        &gt;&gt;&gt; # hook into utool progress iter</span>
<span class="sd">        &gt;&gt;&gt; progressBar = newProgressBar(parent, visible, verticalStretch)</span>
<span class="sd">        &gt;&gt;&gt; hook = progressBar.utool_prog_hook</span>
<span class="sd">        &gt;&gt;&gt; complex_tasks(hook)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--show)</span>
<span class="sd">        &gt;&gt;&gt; ut.quit_if_noshow()</span>
<span class="sd">        &gt;&gt;&gt; guitool.qtapp_loop(freq=10)</span>


<span class="sd">    Ignore:</span>
<span class="sd">        from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        # build test data</span>
<span class="sd">        import wbia.guitool</span>
<span class="sd">        guitool.ensure_qtapp()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">progressBar</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QProgressBar</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="n">sizePolicy</span> <span class="o">=</span> <span class="n">newSizePolicy</span><span class="p">(</span><span class="n">progressBar</span><span class="p">,</span>
                               <span class="n">verticalSizePolicy</span><span class="o">=</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Maximum</span><span class="p">,</span>
                               <span class="n">verticalStretch</span><span class="o">=</span><span class="n">verticalStretch</span><span class="p">)</span>
    <span class="n">progressBar</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">sizePolicy</span><span class="p">)</span>
    <span class="n">progressBar</span><span class="o">.</span><span class="n">setMaximum</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
    <span class="n">progressBar</span><span class="o">.</span><span class="n">setProperty</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="c1">#def utool_prog_hook(count, length):</span>
    <span class="c1">#    progressBar.setProperty(&#39;value&#39;, int(100 * count / length))</span>
    <span class="c1">#    # major hack</span>
    <span class="c1">#    import wbia.guitool</span>
    <span class="c1">#    qtapp = guitool.get_qtapp()</span>
    <span class="c1">#    qtapp.processEvents()</span>
    <span class="c1">#    pass</span>
    <span class="n">progressBar</span><span class="o">.</span><span class="n">utool_prog_hook</span> <span class="o">=</span> <span class="n">ProgHook</span><span class="p">(</span><span class="n">progressBar</span><span class="p">)</span>
    <span class="c1">#progressBar.setTextVisible(False)</span>
    <span class="n">progressBar</span><span class="o">.</span><span class="n">setTextVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">progressBar</span><span class="o">.</span><span class="n">setFormat</span><span class="p">(</span><span class="s1">&#39;%p%&#39;</span><span class="p">)</span>
    <span class="n">progressBar</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">visible</span><span class="p">)</span>
    <span class="n">progressBar</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">600</span><span class="p">)</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">progressBar</span><span class="p">,</span> <span class="s1">&#39;_guitool_sizepolicy&#39;</span><span class="p">,</span> <span class="n">sizePolicy</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">visible</span><span class="p">:</span>
        <span class="c1"># hack to make progres bar show up immediately</span>
        <span class="kn">import</span> <span class="nn">wbia.guitool</span>
        <span class="n">progressBar</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">qtapp</span> <span class="o">=</span> <span class="n">guitool</span><span class="o">.</span><span class="n">get_qtapp</span><span class="p">()</span>
        <span class="n">qtapp</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">progressBar</span></div>


<div class="viewcode-block" id="newOutputLog"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newOutputLog">[docs]</a><span class="k">def</span> <span class="nf">newOutputLog</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">pointSize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verticalStretch</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">wbia.guitool.guitool_misc</span> <span class="k">import</span> <span class="n">QLoggedOutput</span>
    <span class="n">outputLog</span> <span class="o">=</span> <span class="n">QLoggedOutput</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="n">visible</span><span class="p">)</span>
    <span class="n">sizePolicy</span> <span class="o">=</span> <span class="n">newSizePolicy</span><span class="p">(</span><span class="n">outputLog</span><span class="p">,</span>
                               <span class="c1">#verticalSizePolicy=QSizePolicy.Preferred,</span>
                               <span class="n">verticalStretch</span><span class="o">=</span><span class="n">verticalStretch</span><span class="p">)</span>
    <span class="n">outputLog</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">sizePolicy</span><span class="p">)</span>
    <span class="n">outputLog</span><span class="o">.</span><span class="n">setAcceptRichText</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">outputLog</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1">#outputLog.setVisible(visible)</span>
    <span class="c1">#outputLog.setFontPointSize(8)</span>
    <span class="n">outputLog</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">newFont</span><span class="p">(</span><span class="s1">&#39;Courier New&#39;</span><span class="p">,</span> <span class="n">pointSize</span><span class="p">))</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">outputLog</span><span class="p">,</span> <span class="s1">&#39;_guitool_sizepolicy&#39;</span><span class="p">,</span> <span class="n">sizePolicy</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">outputLog</span></div>


<div class="viewcode-block" id="newLabel"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newLabel">[docs]</a><span class="k">def</span> <span class="nf">newLabel</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">gpath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fontkw</span><span class="o">=</span><span class="p">{},</span>
             <span class="n">min_width</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        parent (None): (default = None)</span>
<span class="sd">        text (str):  (default = &#39;&#39;)</span>
<span class="sd">        align (str): (default = &#39;center&#39;)</span>
<span class="sd">        gpath (None): (default = None)</span>
<span class="sd">        fontkw (dict): (default = {})</span>

<span class="sd">    Kwargs:</span>
<span class="sd">        parent, text, align, gpath, fontkw</span>

<span class="sd">    Returns:</span>
<span class="sd">        ?: label</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m wbia.guitool.guitool_components --exec-newLabel --show</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import wbia.guitool</span>
<span class="sd">        &gt;&gt;&gt; guitool.ensure_qtapp()</span>
<span class="sd">        &gt;&gt;&gt; parent = None</span>
<span class="sd">        &gt;&gt;&gt; text = &#39;&#39;</span>
<span class="sd">        &gt;&gt;&gt; align = &#39;center&#39;</span>
<span class="sd">        &gt;&gt;&gt; gpath = ut.grab_test_imgpath(&#39;lena.png&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fontkw = {}</span>
<span class="sd">        &gt;&gt;&gt; label = newLabel(parent, text, align, gpath, fontkw)</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--show)</span>
<span class="sd">        &gt;&gt;&gt; ut.quit_if_noshow()</span>
<span class="sd">        &gt;&gt;&gt; label.show()</span>
<span class="sd">        &gt;&gt;&gt; guitool.qtapp_loop(qwin=label, freq=10)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">label</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
    <span class="c1">#label.setAlignment(ALIGN_DICT[align])</span>
    <span class="n">align</span> <span class="o">=</span> <span class="n">rectifyQtEnum</span><span class="p">(</span><span class="s1">&#39;Alignment&#39;</span><span class="p">,</span> <span class="n">align</span><span class="p">)</span>
    <span class="c1"># if isinstance(align, six.string_types):</span>
    <span class="c1">#     align = ALIGN_DICT[align]</span>
    <span class="n">label</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">align</span><span class="p">)</span>
    <span class="n">adjust_font</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">fontkw</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">gpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># http://stackoverflow.com/questions/8211982/qt-resizing-a-qlabel-containing-a-qpixmap-while-keeping-its-aspect-ratio</span>
        <span class="c1"># TODO</span>
        <span class="n">label</span><span class="o">.</span><span class="n">_orig_pixmap</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="n">gpath</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">_orig_pixmap</span><span class="o">.</span><span class="n">scaled</span><span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">Qt</span><span class="o">.</span><span class="n">KeepAspectRatio</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">SmoothTransformation</span><span class="p">))</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setScaledContents</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">_on_resize_slot</span><span class="p">():</span>
            <span class="c1">#print(&#39;_on_resize_slot&#39;)</span>
            <span class="n">label</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">_orig_pixmap</span><span class="o">.</span><span class="n">scaled</span><span class="p">(</span><span class="n">label</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">Qt</span><span class="o">.</span><span class="n">KeepAspectRatio</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">SmoothTransformation</span><span class="p">))</span>
            <span class="c1">#label.setPixmap(label._orig_pixmap.scaled(label.size()))</span>
        <span class="n">label</span><span class="o">.</span><span class="n">_on_resize_slot</span> <span class="o">=</span> <span class="n">_on_resize_slot</span>
        <span class="c1">#ut.embed()</span>

    <span class="k">def</span> <span class="nf">setColorFG</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fgcolor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        fgcolor: a tuple or list of [R, G, B] in 255 format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#current_sheet = self.styleSheet()</span>
        <span class="n">style_sheet_str</span> <span class="o">=</span> <span class="n">make_style_sheet</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fgcolor</span><span class="o">=</span><span class="n">fgcolor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">style_sheet_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">style_sheet_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">style_sheet_str</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fgcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        fgcolor: a tuple or list of [R, G, B] in 255 format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#current_sheet = self.styleSheet()</span>
        <span class="n">style_sheet_str</span> <span class="o">=</span> <span class="n">make_style_sheet</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="n">bgcolor</span><span class="p">,</span> <span class="n">fgcolor</span><span class="o">=</span><span class="n">fgcolor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">style_sheet_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">style_sheet_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">style_sheet_str</span><span class="p">)</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">inject_func_as_method</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">setColorFG</span><span class="p">)</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">inject_func_as_method</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">setColor</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">min_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">min_width</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">label</span></div>


<div class="viewcode-block" id="ResizableTextEdit"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ResizableTextEdit">[docs]</a><span class="k">class</span> <span class="nc">ResizableTextEdit</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTextEdit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    http://stackoverflow.com/questions/3050537/resizing-qts-qtextedit-to-match-text-height-maximumviewportsize</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="ResizableTextEdit.sizeHint"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ResizableTextEdit.sizeHint">[docs]</a>    <span class="k">def</span> <span class="nf">sizeHint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()</span>
        <span class="n">font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">document</span><span class="p">()</span><span class="o">.</span><span class="n">defaultFont</span><span class="p">()</span>    <span class="c1"># or another font if you change it</span>
        <span class="n">fontMetrics</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QFontMetrics</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>      <span class="c1"># a QFontMetrics based on our font</span>
        <span class="n">textSize</span> <span class="o">=</span> <span class="n">fontMetrics</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

        <span class="n">textWidth</span> <span class="o">=</span> <span class="n">textSize</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span> <span class="mi">30</span>       <span class="c1"># constant may need to be tweaked</span>
        <span class="n">textHeight</span> <span class="o">=</span> <span class="n">textSize</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">+</span> <span class="mi">30</span>     <span class="c1"># constant may need to be tweaked</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">textWidth</span><span class="p">,</span> <span class="n">textHeight</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="newTextEdit"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newTextEdit">[docs]</a><span class="k">def</span> <span class="nf">newTextEdit</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="s1">&#39;above&#39;</span><span class="p">,</span>
                <span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">editable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">fit_to_text</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rich</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This is a text area &quot;&quot;&quot;</span>
    <span class="c1">#if fit_to_text:</span>
    <span class="c1">#outputEdit = ResizableTextEdit(parent)</span>
    <span class="c1">#else:</span>
    <span class="n">outputEdit</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTextEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="c1"># sizePolicy = newSizePolicy(outputEdit, verticalStretch=1)</span>
    <span class="c1"># outputEdit.setSizePolicy(sizePolicy)</span>
    <span class="n">outputEdit</span><span class="o">.</span><span class="n">setAcceptRichText</span><span class="p">(</span><span class="n">rich</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">visible</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">outputEdit</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">visible</span><span class="p">)</span>
    <span class="n">outputEdit</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enabled</span><span class="p">)</span>
    <span class="n">outputEdit</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="ow">not</span> <span class="n">editable</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">outputEdit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">align</span> <span class="o">=</span> <span class="n">rectifyQtEnum</span><span class="p">(</span><span class="s1">&#39;Alignment&#39;</span><span class="p">,</span> <span class="n">align</span><span class="p">)</span>
    <span class="c1"># if isinstance(align, six.string_types):</span>
    <span class="c1">#     align = ALIGN_DICT[align]</span>
    <span class="n">outputEdit</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">align</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">if</span> <span class="n">fit_to_text</span><span class="p">:</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">outputEdit</span><span class="o">.</span><span class="n">document</span><span class="p">()</span><span class="o">.</span><span class="n">defaultFont</span><span class="p">()</span>    <span class="c1"># or another font if you change it</span>
        <span class="n">fontMetrics</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QFontMetrics</span><span class="p">(</span><span class="n">font</span><span class="p">)</span>      <span class="c1"># a QFontMetrics based on our font</span>
        <span class="n">textSize</span> <span class="o">=</span> <span class="n">fontMetrics</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

        <span class="n">textWidth</span> <span class="o">=</span> <span class="n">textSize</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span> <span class="mi">30</span>       <span class="c1"># constant may need to be tweaked</span>
        <span class="n">textHeight</span> <span class="o">=</span> <span class="n">textSize</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">+</span> <span class="mi">30</span>     <span class="c1"># constant may need to be tweaked</span>
        <span class="n">outputEdit</span><span class="o">.</span><span class="n">setMinimumSize</span><span class="p">(</span><span class="n">textWidth</span><span class="p">,</span> <span class="n">textHeight</span><span class="p">)</span>
    <span class="c1">#else:</span>
    <span class="c1">#    outputEdit.setMinimumHeight(0)</span>

    <span class="c1"># setattr(outputEdit, &#39;_guitool_sizepolicy&#39;, sizePolicy)</span>
    <span class="k">return</span> <span class="n">outputEdit</span></div>


<div class="viewcode-block" id="newLineEdit"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newLineEdit">[docs]</a><span class="k">def</span> <span class="nf">newLineEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                <span class="n">textChangedSlot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">textEditedSlot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">editingFinishedSlot</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">readOnly</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">editable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">verticalStretch</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fontkw</span><span class="o">=</span><span class="p">{}):</span>
    <span class="sd">&quot;&quot;&quot; This is a text line</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; parent = None</span>
<span class="sd">        &gt;&gt;&gt; text = None</span>
<span class="sd">        &gt;&gt;&gt; visible = True</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; widget = newLineEdit(parent, text, visible)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; result = str(widget)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">editable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">readOnly</span> <span class="o">=</span> <span class="n">editable</span>
    <span class="n">widget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLineEdit</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="c1"># sizePolicy = newSizePolicy(widget,</span>
    <span class="c1">#                            verticalSizePolicy=QtWidgets.QSizePolicy.Fixed,</span>
    <span class="c1">#                            verticalStretch=verticalStretch)</span>
    <span class="c1"># widget.setSizePolicy(sizePolicy)</span>
    <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enabled</span><span class="p">)</span>
    <span class="n">align</span> <span class="o">=</span> <span class="n">rectifyQtEnum</span><span class="p">(</span><span class="s1">&#39;Alignment&#39;</span><span class="p">,</span> <span class="n">align</span><span class="p">)</span>
    <span class="c1"># if isinstance(align, six.string_types):</span>
    <span class="c1">#     align = ALIGN_DICT[align]</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">align</span><span class="p">)</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="n">readOnly</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">textChangedSlot</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">textChangedSlot</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">editingFinishedSlot</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">editingFinished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">editingFinishedSlot</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">textEditedSlot</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">textEdited</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">textEditedSlot</span><span class="p">)</span>

    <span class="c1">#outputEdit.setAcceptRichText(False)</span>
    <span class="c1">#outputEdit.setVisible(visible)</span>
    <span class="n">adjust_font</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="o">**</span><span class="n">fontkw</span><span class="p">)</span>
    <span class="c1"># setattr(widget, &#39;_guitool_sizepolicy&#39;, sizePolicy)</span>
    <span class="k">return</span> <span class="n">widget</span></div>


<div class="viewcode-block" id="TagEdit"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.TagEdit">[docs]</a><span class="k">class</span> <span class="nc">TagEdit</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLineEdit</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            self (?):</span>
<span class="sd">            parent (None): (default = None)</span>
<span class="sd">            tags (None): (default = None)</span>
<span class="sd">            editor_mode (str): (default = &#39;line&#39;)</span>

<span class="sd">        CommandLine:</span>
<span class="sd">            python -m wbia.guitool.guitool_components TagEdit</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">            &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">            &gt;&gt;&gt; import wbia.guitool as gt</span>
<span class="sd">            &gt;&gt;&gt; gt.ensure_qtapp()</span>
<span class="sd">            &gt;&gt;&gt; self = TagEdit(tags=[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;])</span>
<span class="sd">            &gt;&gt;&gt; self.show()</span>
<span class="sd">            &gt;&gt;&gt; # xdoctest: +REQUIRES(--show)</span>
<span class="sd">            &gt;&gt;&gt; ut.quit_if_noshow()</span>
<span class="sd">            &gt;&gt;&gt; gt.qtapp_loop(qwin=self, freq=10)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">valid_tags</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TagEdit</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1"># self.layout = QtWidgets.QHBoxLayout(self)</span>
        <span class="c1"># if editor_mode == &#39;line&#39;:</span>
        <span class="c1">#     self.editor = QtWidgets.QLineEdit(parent=self)</span>
        <span class="c1"># else:</span>
        <span class="c1">#     raise NotImplementedError(&#39;no fancy tag editing yet&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valid_tags</span> <span class="o">=</span> <span class="n">valid_tags</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sep</span> <span class="o">=</span> <span class="s1">&#39;;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setTags</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>

    <span class="c1"># def setSizePolicy(self, *args):</span>
    <span class="c1">#     super(TagEdit, self).setSizePolicy(*args)</span>
    <span class="c1">#     self.editor.setSizePolicy(*args)</span>

<div class="viewcode-block" id="TagEdit.tags"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.TagEdit.tags">[docs]</a>    <span class="k">def</span> <span class="nf">tags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tag_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="n">tag_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sep</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tags</span></div>

<div class="viewcode-block" id="TagEdit.setTags"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.TagEdit.setTags">[docs]</a>    <span class="k">def</span> <span class="nf">setTags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tags</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">tags</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tags</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid_tags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">tag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid_tags</span>
        <span class="n">tag_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">tag_text</span><span class="p">)</span></div></div>


<span class="k">def</span> <span class="nf">_inject_new_widget_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    helper for guitool widgets</span>

<span class="sd">    adds the addNewXXX functions to the widget.</span>
<span class="sd">    Bypasses having to set layouts. Can simply add widgets to other widgets.</span>
<span class="sd">    Layouts are specified in the addNew constructors.</span>
<span class="sd">    As such, this is less flexible, but quicker to get started.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">wbia.guitool</span> <span class="k">as</span> <span class="nn">gt</span>
    <span class="kn">from</span> <span class="nn">wbia.guitool</span> <span class="k">import</span> <span class="n">PrefWidget2</span>
    <span class="c1"># Creates addNewWidget and newWidget</span>

    <span class="k">def</span> <span class="nf">_make_new_widget_func</span><span class="p">(</span><span class="n">widget_cls</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">new_widget_maker</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="c1"># verticalStretch = kwargs.pop(&#39;verticalStretch&#39;, 1)</span>
            <span class="n">vStretch</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;verticalStretch&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="n">widget_cls</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">_inject_new_widget_methods</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
            <span class="c1"># This line makes the widget resize with the widget</span>
            <span class="n">adjustSizePolicy</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">vStretch</span><span class="o">=</span><span class="n">vStretch</span><span class="p">)</span>
            <span class="c1"># sizePolicy = newSizePolicy(widget, verticalStretch=verticalStretch)</span>
            <span class="c1"># widget.setSizePolicy(sizePolicy)</span>
            <span class="c1"># setattr(widget, &#39;_guitool_sizepolicy&#39;, sizePolicy)</span>
            <span class="k">return</span> <span class="n">widget</span>
        <span class="k">return</span> <span class="n">new_widget_maker</span>

    <span class="k">def</span> <span class="nf">_addnew_factory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newfunc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; helper for addNew guitool widgets &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">_addnew</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span>
            <span class="n">layout_kw</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QGridLayout</span><span class="p">):</span>
                <span class="n">layout_kw</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
                    <span class="s1">&#39;fromRow&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fromRow&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)),</span>
                    <span class="s1">&#39;fromColumn&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fromColumn&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;column&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)),</span>
                    <span class="s1">&#39;rowSpan&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;rowSpan&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="s1">&#39;columnSpan&#39;</span><span class="p">:</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;columnSpan&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">})</span>
            <span class="n">new_widget</span> <span class="o">=</span> <span class="n">newfunc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">new_widget</span><span class="p">,</span> <span class="o">**</span><span class="n">layout_kw</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">new_widget</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">new_widget</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">new_widget</span>
        <span class="k">return</span> <span class="n">_addnew</span>

    <span class="c1"># Black magic</span>
    <span class="n">guitype_list</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Widget&#39;</span><span class="p">,</span> <span class="s1">&#39;Button&#39;</span><span class="p">,</span> <span class="s1">&#39;LineEdit&#39;</span><span class="p">,</span> <span class="s1">&#39;ComboBox&#39;</span><span class="p">,</span> <span class="s1">&#39;Label&#39;</span><span class="p">,</span> <span class="s1">&#39;Spoiler&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CheckBox&#39;</span><span class="p">,</span> <span class="s1">&#39;TextEdit&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Frame&#39;</span><span class="p">,</span> <span class="s1">&#39;Splitter&#39;</span><span class="p">,</span> <span class="s1">&#39;TabWidget&#39;</span><span class="p">,</span> <span class="s1">&#39;ProgressBar&#39;</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;RadioButton&#39;</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QRadioButton</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;RadioButtonGroup&#39;</span><span class="p">,</span> <span class="n">RadioButtonGroup</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;EditConfigWidget&#39;</span><span class="p">,</span> <span class="n">PrefWidget2</span><span class="o">.</span><span class="n">EditConfigWidget</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;TableWidget&#39;</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTableWidget</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;TagEdit&#39;</span><span class="p">,</span> <span class="n">TagEdit</span><span class="p">),</span>
        <span class="s1">&#39;ScrollArea&#39;</span><span class="p">,</span>
        <span class="c1">#(&#39;ScrollArea&#39;, QtWidgets.QScrollArea),</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">guitype</span> <span class="ow">in</span> <span class="n">guitype_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">guitype</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">guitype</span><span class="p">,</span> <span class="n">widget_cls</span> <span class="o">=</span> <span class="n">guitype</span>
            <span class="n">newfunc</span> <span class="o">=</span> <span class="n">_make_new_widget_func</span><span class="p">(</span><span class="n">widget_cls</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">gt</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span> <span class="o">+</span> <span class="n">guitype</span><span class="p">):</span>
                <span class="n">newfunc</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">gt</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span> <span class="o">+</span> <span class="n">guitype</span><span class="p">)</span>
                <span class="n">ut</span><span class="o">.</span><span class="n">inject_func_as_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newfunc</span><span class="p">,</span> <span class="s1">&#39;new&#39;</span> <span class="o">+</span> <span class="n">guitype</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newfunc</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">gt</span><span class="p">,</span> <span class="n">guitype</span><span class="p">)</span>
        <span class="n">addnew_func</span> <span class="o">=</span> <span class="n">_addnew_factory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newfunc</span><span class="p">)</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">inject_func_as_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addnew_func</span><span class="p">,</span> <span class="s1">&#39;addNew&#39;</span> <span class="o">+</span> <span class="n">guitype</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;addWidget&#39;</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">_make_add_new_widgets</span><span class="p">():</span>

            <span class="k">def</span> <span class="nf">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="c1"># fromRow, fromColumn, rowSpan, columnSpan</span>
                <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QGridLayout</span><span class="p">):</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fromRow&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                    <span class="n">col</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fromColumn&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;column&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                    <span class="n">rowSpan</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;rowSpan&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">columnSpan</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;columnSpan&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;only both or neither can be None&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">row</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span><span class="p">,</span>
                                         <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="c1"># qt weirdness</span>
                            <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># qt weirdness</span>
                        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">widget</span>

            <span class="k">def</span> <span class="nf">addItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layout_item</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QGridLayout</span><span class="p">):</span>
                    <span class="n">row</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fromRow&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                    <span class="n">col</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;fromColumn&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;column&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">row</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">col</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;only both or neither can be None&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">row</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">layout</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">layout_item</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">layout</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">layout_item</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">layout</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">layout_item</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="c1"># TODO: depricate in favor of addNewHWidget</span>
            <span class="k">def</span> <span class="nf">newHWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addNewWidget</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="c1"># TODO: depricate in favor of addNewVWidget</span>
            <span class="k">def</span> <span class="nf">newVWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addNewWidget</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">Vertical</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">addNewHWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addNewWidget</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">addNewVWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addNewWidget</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">Vertical</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">(</span>
                <span class="n">addWidget</span><span class="p">,</span> <span class="n">addItem</span><span class="p">,</span> <span class="n">newVWidget</span><span class="p">,</span> <span class="n">newHWidget</span><span class="p">,</span> <span class="n">addNewHWidget</span><span class="p">,</span>
                <span class="n">addNewVWidget</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">func</span>  <span class="ow">in</span> <span class="n">_make_add_new_widgets</span><span class="p">():</span>
            <span class="n">ut</span><span class="o">.</span><span class="n">inject_func_as_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_funcname</span><span class="p">(</span><span class="n">func</span><span class="p">))</span>

    <span class="n">ut</span><span class="o">.</span><span class="n">inject_func_as_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">print_widget_heirarchy</span><span class="p">)</span>
    <span class="c1"># Above code is the same as saying</span>
    <span class="c1">#     self.newButton = ut.partial(newButton, self)</span>
    <span class="c1">#     self.newWidget = ut.partial(newWidget, self)</span>
    <span class="c1">#     ... etc</span>


<div class="viewcode-block" id="newWidget"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newWidget">[docs]</a><span class="k">def</span> <span class="nf">newWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        parent (QWidget):</span>
<span class="sd">        orientation (Orientation): (default = 2)</span>
<span class="sd">        verticalSizePolicy (Policy): (default = 7)</span>
<span class="sd">        horizontalSizePolicy (Policy): (default = 7)</span>
<span class="sd">        verticalStretch (int): (default = 1)</span>

<span class="sd">    Returns:</span>
<span class="sd">        GuitoolWidget: widget</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">widget</span> <span class="o">=</span> <span class="n">GuitoolWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">widget</span></div>


<div class="viewcode-block" id="newLayout"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newLayout">[docs]</a><span class="k">def</span> <span class="nf">newLayout</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ori</span> <span class="o">==</span> <span class="s1">&#39;grid&#39;</span><span class="p">:</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QGridLayout</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ori</span> <span class="o">==</span> <span class="s1">&#39;flow&#39;</span><span class="p">:</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">FlowLayout</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ori</span> <span class="o">=</span> <span class="n">rectifyQtEnum</span><span class="p">(</span><span class="s1">&#39;Orientation&#39;</span><span class="p">,</span> <span class="n">ori</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Vertical</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ori</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Vertical</span><span class="p">:</span>
            <span class="n">layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ori</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">:</span>
            <span class="n">layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;ori=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ori</span><span class="p">,))</span>
    <span class="k">if</span> <span class="n">spacing</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="n">spacing</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">margin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="s1">&#39;setMargin&#39;</span><span class="p">):</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">setMargin</span><span class="p">(</span><span class="n">margin</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="n">margin</span><span class="p">,</span> <span class="n">margin</span><span class="p">,</span> <span class="n">margin</span><span class="p">,</span> <span class="n">margin</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">layout</span></div>


<div class="viewcode-block" id="newFrame"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newFrame">[docs]</a><span class="k">def</span> <span class="nf">newFrame</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">widget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="p">()</span>
    <span class="n">ori</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ori&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;orientation&#39;</span><span class="p">))</span>
    <span class="n">spacing</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;spacing&#39;</span><span class="p">)</span>
    <span class="n">margin</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;margin&#39;</span><span class="p">)</span>
    <span class="n">layout</span> <span class="o">=</span> <span class="n">newLayout</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">widget</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="n">ori</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="n">spacing</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">)</span>
    <span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
    <span class="n">_inject_new_widget_methods</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">widget</span></div>


<div class="viewcode-block" id="newSpacer"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newSpacer">[docs]</a><span class="k">def</span> <span class="nf">newSpacer</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vPolicy</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">hPolicy</span> <span class="o">=</span> <span class="n">rectifySizePolicy</span><span class="p">(</span><span class="n">hPolicy</span><span class="p">,</span> <span class="s1">&#39;Expanding&#39;</span><span class="p">)</span>
    <span class="n">vPolicy</span> <span class="o">=</span> <span class="n">rectifySizePolicy</span><span class="p">(</span><span class="n">vPolicy</span><span class="p">,</span> <span class="s1">&#39;Expanding&#39;</span><span class="p">)</span>
    <span class="n">spacer</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSpacerItem</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">hPolicy</span><span class="p">,</span> <span class="n">vPolicy</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">spacer</span></div>


<span class="c1">#class GuitoolWidget(QtWidgets.QWidget):</span>
<div class="viewcode-block" id="GuitoolWidget"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.GuitoolWidget">[docs]</a><span class="k">class</span> <span class="nc">GuitoolWidget</span><span class="p">(</span><span class="n">WIDGET_BASE</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CommandLine:</span>
<span class="sd">        python -m wbia.guitool.guitool_components GuitoolWidget --show</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import wbia.guitool as gt</span>
<span class="sd">        &gt;&gt;&gt; gt.ensure_qtapp()</span>
<span class="sd">        &gt;&gt;&gt; ut.exec_funckw(newWidget, globals())</span>
<span class="sd">        &gt;&gt;&gt; widget = GuitoolWidget(parent)</span>
<span class="sd">        &gt;&gt;&gt; widget.addWidget(gt.newButton(</span>
<span class="sd">        &gt;&gt;&gt;     widget, &#39;Print Hi&#39;, lambda: print(&#39;hi&#39;)))</span>
<span class="sd">        &gt;&gt;&gt; widget.addWidget(gt.newButton(</span>
<span class="sd">        &gt;&gt;&gt;     widget, &#39;Popup Hi&#39;, lambda: gt.user_info(widget, &#39;hi&#39;)))</span>
<span class="sd">        &gt;&gt;&gt; #widget.addRow(&#39;input 1&#39;, gt.newLineEdit(widget))</span>
<span class="sd">        &gt;&gt;&gt; #widget.addRow(&#39;input 2&#39;, gt.newComboBox(widget, [&#39;one&#39;, &#39;two&#39;]))</span>
<span class="sd">        &gt;&gt;&gt; widget.show()</span>
<span class="sd">        &gt;&gt;&gt; widget.resize(int(ut.PHI * 500), 500)</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--show)</span>
<span class="sd">        &gt;&gt;&gt; ut.quit_if_noshow()</span>
<span class="sd">        &gt;&gt;&gt; gt.qtapp_loop(qwin=widget, freq=10)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">closed</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">verticalSizePolicy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizontalSizePolicy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">verticalStretch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizontalStretch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">margin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GuitoolWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="c1">#sizePolicy = newSizePolicy(self,</span>
        <span class="c1">#                           horizontalSizePolicy=horizontalSizePolicy,</span>
        <span class="c1">#                           verticalSizePolicy=verticalSizePolicy,</span>
        <span class="c1">#                           verticalStretch=verticalStretch,</span>
        <span class="c1">#                           horizontalStretch=horizontalStretch)</span>
        <span class="c1">#self.setSizePolicy(sizePolicy)</span>
        <span class="c1">#setattr(self, &#39;_guitool_sizepolicy&#39;, sizePolicy)</span>
        <span class="k">if</span> <span class="n">orientation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ori</span> <span class="o">=</span> <span class="n">orientation</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">newLayout</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">ori</span><span class="o">=</span><span class="n">ori</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="n">spacing</span><span class="p">,</span>
                           <span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_guitool_layout</span> <span class="o">=</span> <span class="n">layout</span>
        <span class="c1">#layout.setAlignment(Qt.AlignBottom)</span>
        <span class="n">_inject_new_widget_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">DEBUG_WIDGET</span><span class="p">:</span>
            <span class="c1"># debug code</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: rgb(255,0,0); margin:1px; border:1px solid rgb(0, 255, 0); &quot;</span><span class="p">)</span>
            <span class="c1">#self.setStyleSheet(&quot;background-color: border:5px solid rgb(255, 0, 0); &quot;)</span>

<div class="viewcode-block" id="GuitoolWidget.addNewSpacer"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.GuitoolWidget.addNewSpacer">[docs]</a>    <span class="k">def</span> <span class="nf">addNewSpacer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vPolicy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">spacer</span> <span class="o">=</span> <span class="n">newSpacer</span><span class="p">(</span><span class="n">w</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="n">hPolicy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">spacer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">spacer</span></div>

<div class="viewcode-block" id="GuitoolWidget.set_all_margins"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.GuitoolWidget.set_all_margins">[docs]</a>    <span class="k">def</span> <span class="nf">set_all_margins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">margin</span><span class="p">):</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_guitool_layout</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">layout</span><span class="p">,</span> <span class="s1">&#39;setMargin&#39;</span><span class="p">):</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">setMargin</span><span class="p">(</span><span class="n">margin</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="n">margin</span><span class="p">,</span> <span class="n">margin</span><span class="p">,</span> <span class="n">margin</span><span class="p">,</span> <span class="n">margin</span><span class="p">)</span></div>

<div class="viewcode-block" id="GuitoolWidget.as_dialog"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.GuitoolWidget.as_dialog">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">as_dialog</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">widget</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialog</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="c1">#dlg.setSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Expanding)</span>
        <span class="c1">#dlg.setSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Preferred)</span>
        <span class="c1">#dlg.setSizePolicy(QtWidgets.QSizePolicy.Minimum, QtWidgets.QSizePolicy.Minimum)</span>
        <span class="c1">#widget.setSizePolicy(QtWidgets.QSizePolicy.Minimum, QtWidgets.QSizePolicy.Minimum)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">widget</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">vlayout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">dlg</span><span class="p">)</span>
        <span class="c1">#dlg.vlayout.setAlignment(Qt.AlignBottom)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">vlayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">closed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dlg</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">widget</span><span class="o">.</span><span class="n">windowTitle</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">DEBUG_WIDGET</span><span class="p">:</span>
            <span class="n">dlg</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: rgb(255,0,0); margin:0px; border:1px solid rgb(0, 255, 0); &quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dlg</span></div>

<div class="viewcode-block" id="GuitoolWidget.initialize"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.GuitoolWidget.initialize">[docs]</a>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="GuitoolWidget.addLayout"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.GuitoolWidget.addLayout">[docs]</a>    <span class="k">def</span> <span class="nf">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_guitool_layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="GuitoolWidget.closeEvent"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.GuitoolWidget.closeEvent">[docs]</a>    <span class="k">def</span> <span class="nf">closeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">closed</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GuitoolWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">closeEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="prop_text_map"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.prop_text_map">[docs]</a><span class="k">def</span> <span class="nf">prop_text_map</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s1">&#39;QtWidgets.QSizePolicy&#39;</span><span class="p">:</span>
        <span class="n">pol_info</span> <span class="o">=</span> <span class="p">{</span><span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;QtWidgets.QSizePolicy.&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="p">):</span> <span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span>
                    <span class="p">[</span><span class="s1">&#39;Fixed&#39;</span><span class="p">,</span> <span class="s1">&#39;Minimum&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum&#39;</span><span class="p">,</span> <span class="s1">&#39;Preferred&#39;</span><span class="p">,</span> <span class="s1">&#39;Expanding&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;MinimumExpanding&#39;</span><span class="p">,</span> <span class="s1">&#39;Ignored&#39;</span><span class="p">,</span> <span class="p">]}</span>
        <span class="k">return</span> <span class="n">pol_info</span><span class="p">[</span><span class="n">val</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">val</span></div>


<div class="viewcode-block" id="get_nested_attr"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.get_nested_attr">[docs]</a><span class="k">def</span> <span class="nf">get_nested_attr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    attr = &#39;sizePolicy().verticalPolicy()&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">attr_list</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">current</span> <span class="o">=</span> <span class="n">obj</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">attr_list</span><span class="p">:</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;()&#39;</span><span class="p">)</span>
        <span class="n">a_</span> <span class="o">=</span> <span class="n">a</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="k">if</span> <span class="n">flag</span> <span class="k">else</span> <span class="n">a</span>
        <span class="n">current</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">current</span><span class="p">,</span> <span class="n">a_</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">current</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">current</span></div>


<div class="viewcode-block" id="walk_widget_heirarchy"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.walk_widget_heirarchy">[docs]</a><span class="k">def</span> <span class="nf">walk_widget_heirarchy</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    print(&#39;\n&#39;.join(gt.walk_widget_heirarchy(self, attrs=[&#39;minimumWidth&#39;], skip=True)))</span>
<span class="sd">    print(&#39;\n&#39;.join(gt.walk_widget_heirarchy(self, attrs=[&#39;sizePolicy&#39;], skip=True)))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">default_attrs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;sizePolicy&#39;</span>
        <span class="s1">&#39;widgetResizable&#39;</span>
        <span class="s1">&#39;maximumHeight&#39;</span>
        <span class="s1">&#39;minimumHeight&#39;</span>
        <span class="s1">&#39;alignment&#39;</span>
        <span class="s1">&#39;spacing&#39;</span><span class="p">,</span>
        <span class="s1">&#39;margin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;sizeHint&#39;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">attrs</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;attrs&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">max_depth</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;max_depth&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">skip</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;skip&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">level</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">attrs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="n">default_attrs</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">ensure_iterable</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span>

    <span class="n">children</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">children</span><span class="p">()</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">info</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">type_str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;PyQt4&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">objectName</span><span class="p">())</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">attrs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="s1">&#39;sizePolicy&#39;</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;sizePolicy&#39;</span><span class="p">):</span>
            <span class="n">vval</span> <span class="o">=</span> <span class="n">prop_text_map</span><span class="p">(</span><span class="s1">&#39;QtWidgets.QSizePolicy&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">sizePolicy</span><span class="p">()</span><span class="o">.</span><span class="n">verticalPolicy</span><span class="p">())</span>
            <span class="n">hval</span> <span class="o">=</span> <span class="n">prop_text_map</span><span class="p">(</span><span class="s1">&#39;QtWidgets.QSizePolicy&#39;</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">sizePolicy</span><span class="p">()</span><span class="o">.</span><span class="n">horizontalPolicy</span><span class="p">())</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;  * verticalSizePolicy   = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">vval</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;  * horizontalSizePolicy = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">hval</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">get_nested_attr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span> <span class="o">+</span> <span class="s1">&#39;()&#39;</span><span class="p">)</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;  * </span><span class="si">%s</span><span class="s1"> = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">prop_text_map</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="n">val</span><span class="p">)))</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>
    <span class="k">if</span> <span class="n">skip</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1">#if hasattr(obj, &#39;alignment&#39;):</span>
    <span class="c1">#    val = obj.alignment()</span>
    <span class="c1">#    lines.append(&#39;  * widgetResizable = %r&#39; % prop_text_map(&#39;widgetResizable&#39;, val))</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="n">level</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
    <span class="n">next_level</span> <span class="o">=</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">kwargs_</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">kwargs_</span><span class="p">[</span><span class="s1">&#39;level&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">next_level</span> <span class="o">&lt;=</span> <span class="n">max_depth</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">children</span><span class="p">:</span>
            <span class="n">child_info</span> <span class="o">=</span> <span class="n">walk_widget_heirarchy</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">child_info</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lines</span></div>


<div class="viewcode-block" id="print_widget_heirarchy"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.print_widget_heirarchy">[docs]</a><span class="k">def</span> <span class="nf">print_widget_heirarchy</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">walk_widget_heirarchy</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">text</span><span class="p">)</span></div>


<div class="viewcode-block" id="fix_child_attr_heirarchy"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.fix_child_attr_heirarchy">[docs]</a><span class="k">def</span> <span class="nf">fix_child_attr_heirarchy</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">)(</span><span class="n">val</span><span class="p">)</span>
        <span class="c1"># obj.setSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Expanding)</span>
    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">children</span><span class="p">():</span>
        <span class="n">fix_child_attr_heirarchy</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span></div>


<div class="viewcode-block" id="fix_child_size_heirarchy"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.fix_child_size_heirarchy">[docs]</a><span class="k">def</span> <span class="nf">fix_child_size_heirarchy</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">pol</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s1">&#39;sizePolicy&#39;</span><span class="p">):</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">children</span><span class="p">():</span>
        <span class="n">fix_child_size_heirarchy</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">pol</span><span class="p">)</span></div>


<div class="viewcode-block" id="ConfigConfirmWidget"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ConfigConfirmWidget">[docs]</a><span class="k">class</span> <span class="nc">ConfigConfirmWidget</span><span class="p">(</span><span class="n">GuitoolWidget</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m wbia.guitool.guitool_components ConfigConfirmWidget --show</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import wbia.guitool</span>
<span class="sd">        &gt;&gt;&gt; import dtool</span>
<span class="sd">        &gt;&gt;&gt; guitool.ensure_qapp()  # must be ensured before any embeding</span>
<span class="sd">        &gt;&gt;&gt; tablename = None</span>
<span class="sd">        &gt;&gt;&gt; dict_ = {&#39;K&#39;: 1, &#39;Knorm&#39;: 5,</span>
<span class="sd">        &gt;&gt;&gt;          &#39;choice&#39;: ut.ParamInfo(varname=&#39;choice&#39;, default=&#39;one&#39;,</span>
<span class="sd">        &gt;&gt;&gt;                                 valid_values=[&#39;one&#39;, &#39;two&#39;])}</span>
<span class="sd">        &gt;&gt;&gt; config = dtool.Config.from_dict(dict_, tablename)</span>
<span class="sd">        &gt;&gt;&gt; dlg = guitool.ConfigConfirmWidget.as_dialog(</span>
<span class="sd">        &gt;&gt;&gt;     title=&#39;Confirm Merge Query&#39;,</span>
<span class="sd">        &gt;&gt;&gt;     msg=&#39;Confirm&#39;,</span>
<span class="sd">        &gt;&gt;&gt;     detailed_msg=ut.lorium_ipsum()*10,</span>
<span class="sd">        &gt;&gt;&gt;     config=config)</span>
<span class="sd">        &gt;&gt;&gt; #dlg.resize(700, 500)</span>
<span class="sd">        &gt;&gt;&gt; self = dlg.widget</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--show)</span>
<span class="sd">        &gt;&gt;&gt; ut.quit_if_noshow()</span>
<span class="sd">        &gt;&gt;&gt; import wbia.plottool as pt</span>
<span class="sd">        &gt;&gt;&gt; dlg.show()</span>
<span class="sd">        &gt;&gt;&gt; guitool.qtapp_loop(qwin=dlg)</span>
<span class="sd">        &gt;&gt;&gt; updated_config = self.config  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;orig_config = %r&#39; % (config,))</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;updated_config = %r&#39; % (updated_config,))</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># FIXME: http://doc.qt.io/qt-5/qsizepolicy.html</span>
        <span class="c1">#kwargs[&#39;horizontalSizePolicy&#39;] = QSizePolicy.Minimum</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;horizontalSizePolicy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;verticalSizePolicy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ConfigConfirmWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="ConfigConfirmWidget.initialize"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ConfigConfirmWidget.initialize">[docs]</a>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">detailed_msg</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_spoiler</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="c1">#import copy</span>
        <span class="kn">from</span> <span class="nn">wbia.guitool</span> <span class="k">import</span> <span class="n">PrefWidget2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orig_config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confirm_option</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

        <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span>

        <span class="k">if</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">msg_widget</span> <span class="o">=</span> <span class="n">newLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
            <span class="c1">#msg_widget = newTextEdit(self, text=msg, align=&#39;left&#39;, editable=False, fit_to_text=True)</span>
            <span class="n">msg_widget</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s1">&#39;msg_widget&#39;</span><span class="p">)</span>
            <span class="n">msg_widget</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">newSizePolicy</span><span class="p">(</span>
                <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Expanding&#39;</span><span class="p">,</span> <span class="s1">&#39;Maximum&#39;</span><span class="p">,</span> <span class="n">verticalStretch</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">msg_widget</span><span class="p">)</span>

        <span class="k">if</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">editConfig</span> <span class="o">=</span> <span class="n">PrefWidget2</span><span class="o">.</span><span class="n">EditConfigWidget</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="n">user_mode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">with_spoiler</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spoiler</span> <span class="o">=</span> <span class="n">Spoiler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Advanced Configuration&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spoiler</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s1">&#39;spoiler&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spoiler</span><span class="o">.</span><span class="n">setContentLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editConfig</span><span class="p">)</span>
                <span class="c1">#self.layout().addStretch(1)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spoiler</span><span class="p">)</span>
                <span class="c1">#self.addWidget(self.spoiler, alignment=Qt.AlignTop)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spoiler</span><span class="o">.</span><span class="n">toggle_finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size_adjust_slot</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editConfig</span><span class="p">)</span>

        <span class="k">if</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">detailed_msg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">detailed_msg_widget</span> <span class="o">=</span> <span class="n">newTextEdit</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">detailed_msg</span><span class="p">,</span> <span class="n">editable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">detailed_msg_widget</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s1">&#39;detailed_msg_widget&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spoiler2</span> <span class="o">=</span> <span class="n">Spoiler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Details&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spoiler2</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s1">&#39;spoiler2&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spoiler2</span><span class="o">.</span><span class="n">setContentLayout</span><span class="p">(</span><span class="n">detailed_msg_widget</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spoiler2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spoiler2</span><span class="o">.</span><span class="n">toggle_finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size_adjust_slot</span><span class="p">)</span>
            <span class="c1">#self.spoiler2.setAlignment(Qt.AlignBottom)</span>

        <span class="k">if</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newHWidget</span><span class="p">(</span><span class="n">verticalStretch</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_row</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s1">&#39;button_row&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_row</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">newSizePolicy</span><span class="p">(</span>
                <span class="kc">None</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span>
                <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Maximum</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_row</span><span class="o">.</span><span class="n">_guitool_layout</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignBottom</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Confirm&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">default</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">def</span> <span class="nf">_make_option_pressed</span><span class="p">(</span><span class="n">opt</span><span class="p">):</span>
                <span class="k">def</span> <span class="nf">_wrap</span><span class="p">():</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">confirm</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">_wrap</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">default_button</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
                <span class="n">button</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_row</span><span class="o">.</span><span class="n">addNewButton</span><span class="p">(</span>
                    <span class="n">opt</span><span class="p">,</span> <span class="n">pressed</span><span class="o">=</span><span class="n">_make_option_pressed</span><span class="p">(</span><span class="n">opt</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">opt</span> <span class="o">==</span> <span class="n">default</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">default_button</span> <span class="o">=</span> <span class="n">button</span>

            <span class="n">button</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_row</span><span class="o">.</span><span class="n">addNewButton</span><span class="p">(</span><span class="s1">&#39;Cancel&#39;</span><span class="p">,</span> <span class="n">pressed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cancel</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_button</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">default_button</span> <span class="o">=</span> <span class="n">button</span>
            <span class="c1"># button.setDefault(True)</span>
            <span class="c1"># button.setAutoDefault(True)</span>
            <span class="c1"># button.setFocus(Qt.OtherFocusReason)</span>
            <span class="c1"># button.setFocus(Qt.ActiveWindowFocusReason)</span>

            <span class="c1"># button.setFocusPolicy(QtCore.Qt.TabFocus)</span>
            <span class="c1"># button.setFocus(True)</span>
            <span class="c1"># QtCore.Qt.TabFocus)</span>
            <span class="c1"># import utool</span>
            <span class="c1"># utool.embed()</span>
            <span class="c1"># button.setFocus(True)</span>
            <span class="c1"># button.</span>
            <span class="n">button</span><span class="o">.</span><span class="n">activateWindow</span><span class="p">()</span>
            <span class="c1"># import utool</span>
            <span class="c1"># utool.embed()</span>

        <span class="c1"># self.print_widget_heirarchy()</span>

        <span class="c1">#self.layout().setAlignment(Qt.AlignBottom)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignTop</span><span class="p">)</span></div>
        <span class="c1">#self.layout().setSizeConstraint(QtWidgets.QLayout.SetFixedSize)</span>
        <span class="c1">#self.resize(668, 530)</span>
        <span class="c1">#self.update_state()</span>

<div class="viewcode-block" id="ConfigConfirmWidget.as_dialog"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ConfigConfirmWidget.as_dialog">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">as_dialog</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ConfigConfirmWidget</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">as_dialog</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># import utool</span>
        <span class="c1"># utool.embed()</span>
        <span class="c1"># Set focust after creating window</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">default_button</span><span class="o">.</span><span class="n">setFocus</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dlg</span></div>
        <span class="c1"># Set default button</span>

<div class="viewcode-block" id="ConfigConfirmWidget.update_state"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ConfigConfirmWidget.update_state">[docs]</a>    <span class="k">def</span> <span class="nf">update_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*args = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">args</span><span class="p">,))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Update state&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_info_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Need dtool config&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">pi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_info_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">pi</span><span class="o">.</span><span class="n">type_</span> <span class="ow">is</span> <span class="nb">bool</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">currentValue</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Changed: key, value = </span><span class="si">%r</span><span class="s1">, </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">pi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_info_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">row_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">pi</span><span class="o">.</span><span class="n">is_hidden</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
            <span class="n">row</span><span class="o">.</span><span class="n">edit</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span></div>

<div class="viewcode-block" id="ConfigConfirmWidget.confirm"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ConfigConfirmWidget.confirm">[docs]</a>    <span class="k">def</span> <span class="nf">confirm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">confirm_option</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[gt] Confirmed config&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;confirm_option = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">confirm_option</span><span class="p">,))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confirm_option</span> <span class="o">=</span> <span class="n">confirm_option</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_size_adjust_slot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>

        <span class="c1">#def adjusted_size(q):</span>
        <span class="c1">#    &quot;&quot;&quot;</span>
        <span class="c1">#    gvim ~/code/qt4/src/gui/kernel/qwidget.cpp</span>
        <span class="c1">#    &quot;&quot;&quot;</span>
        <span class="c1">#    #Q_Q(const QWidget);</span>
        <span class="c1">#    s = q.sizeHint()</span>
        <span class="c1">#    layout = q.layout()</span>

        <span class="c1">#    if (q.isWindow()):</span>
        <span class="c1">#        exp = Qt.Orientations()</span>
        <span class="c1">#        if (layout) :</span>
        <span class="c1">#            if (layout.hasHeightForWidth()):</span>
        <span class="c1">#                s.setHeight(layout.totalHeightForWidth(s.width()))</span>
        <span class="c1">#            exp = layout.expandingDirections()</span>
        <span class="c1">#        else:</span>
        <span class="c1">#            if (q.sizePolicy().hasHeightForWidth()):</span>
        <span class="c1">#                s.setHeight(q.heightForWidth(s.width()))</span>
        <span class="c1">#            exp = q.sizePolicy().expandingDirections()</span>
        <span class="c1">#        if (exp &amp; Qt.Horizontal):</span>
        <span class="c1">#            s.setWidth(max(s.width(), 200))</span>
        <span class="c1">#        if (exp &amp; Qt.Vertical):</span>
        <span class="c1">#            s.setHeight(max(s.height(), 100))</span>

        <span class="c1">#        #if defined(Q_WS_X11)</span>
        <span class="c1">#        try:</span>
        <span class="c1">#            screen = QtWidgets.QApplication.desktop().screenGeometry(q.pos())</span>
        <span class="c1">#        except Exception:</span>
        <span class="c1">#            #else // all others</span>
        <span class="c1">#            screen = QtWidgets.QApplication.desktop().screenGeometry(q.x11Info().screen())</span>
        <span class="c1">#            #endif</span>

        <span class="c1">#        #if defined (Q_WS_WINCE) || defined (Q_OS_SYMBIAN)</span>
        <span class="c1">#        try:</span>
        <span class="c1">#            s.setWidth(min(s.width(), screen.width()))</span>
        <span class="c1">#            s.setHeight(min(s.height(), screen.height()))</span>
        <span class="c1">#        except Exception:</span>
        <span class="c1">#            #else</span>
        <span class="c1">#            s.setWidth(min(s.width(), screen.width() * 2 / 3))</span>
        <span class="c1">#            s.setHeight(min(s.height(), screen.height() * 2 / 3))</span>
        <span class="c1">#            #endif</span>
        <span class="c1">#        #if (QTLWExtra *extra = maybeTopData())</span>
        <span class="c1">#        #    extra.sizeAdjusted = true</span>

        <span class="c1">#    if (not s.isValid()):</span>
        <span class="c1">#        r = q.childrenRect()  # get children rectangle</span>
        <span class="c1">#        if (not r.isNull()):</span>
        <span class="c1">#            s = r.size() + QtCore.QSize(2 * r.x(), 2 * r.y())</span>
        <span class="c1">#    return s</span>

        <span class="k">def</span> <span class="nf">_adjust_widget</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;w = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">w</span><span class="p">,))</span>
            <span class="n">orig_size</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
            <span class="n">hint_size</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span>
            <span class="c1">#adj_size = adjusted_size(w)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">childrenRect</span><span class="p">()</span>  <span class="c1"># get children rectangle</span>
            <span class="n">adj_size</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
            <span class="c1">#+ QtCore.QSize(2 * r.x(), 2 * r.y())</span>
            <span class="c1">#height = min(adj_size.height(), hint_size.height())</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">hint_size</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
            <span class="n">newsize</span> <span class="o">=</span> <span class="p">(</span><span class="n">orig_size</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">height</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;orig_size = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">orig_size</span><span class="p">,))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hint_size = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">hint_size</span><span class="p">,))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;adj_size = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">adj_size</span><span class="p">,))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;newsize = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">newsize</span><span class="p">,))</span>
            <span class="c1">#w.setMinimumSize(*newsize)</span>
            <span class="n">w</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="o">*</span><span class="n">newsize</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Actual new size = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">size</span><span class="p">()))</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;topLevelWidget&#39;</span><span class="p">):</span>
            <span class="n">top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">topLevelWidget</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">()</span>
        <span class="c1">#top.ensurePolished()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">checked</span><span class="p">:</span>
            <span class="n">_adjust_widget</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
        <span class="c1">#_adjust_widget(self)</span>

        <span class="c1">#parent = self.parent()</span>
        <span class="c1">#_adjust_widget(self)</span>
        <span class="c1">#if parent is not None:</span>
        <span class="c1">#    _adjust_widget(parent)</span>

<div class="viewcode-block" id="ConfigConfirmWidget.cancel"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ConfigConfirmWidget.cancel">[docs]</a>    <span class="k">def</span> <span class="nf">cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[gt] Canceled confirm config&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="newButton"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newButton">[docs]</a><span class="k">def</span> <span class="nf">newButton</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clicked</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pressed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">qicon</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fgcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">fontkw</span><span class="o">=</span><span class="p">{},</span> <span class="n">shrink_to_text</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">min_width</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    wrapper around QtWidgets.QPushButton</span>

<span class="sd">    Args:</span>
<span class="sd">        parent (None): (default = None)</span>
<span class="sd">        text (str):  (default = None)</span>
<span class="sd">        clicked (None): (default = None)</span>
<span class="sd">        pressed (None): (default = None)</span>
<span class="sd">        qicon (None): (default = None)</span>
<span class="sd">        visible (bool): (default = True)</span>
<span class="sd">        enabled (bool): (default = True)</span>
<span class="sd">        bgcolor (None): (default = None)</span>
<span class="sd">        fgcolor (None): (default = None)</span>
<span class="sd">        fontkw (dict): (default = {})</span>
<span class="sd">        shrink_to_text (bool): (default = False)</span>
<span class="sd">        min_width (None): (default = None)</span>

<span class="sd">    connectable signals:</span>
<span class="sd">        void clicked(bool checked=false)</span>
<span class="sd">        void pressed()</span>
<span class="sd">        void released()</span>
<span class="sd">        void toggled(bool checked)</span>

<span class="sd">    Returns:</span>
<span class="sd">       QtWidgets.QPushButton</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m wbia.guitool.guitool_components --exec-newButton</span>
<span class="sd">        python -m wbia.guitool.guitool_components --test-newButton</span>
<span class="sd">        python -m wbia.guitool.guitool_components newButton --show</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import wbia.guitool as gt</span>
<span class="sd">        &gt;&gt;&gt; gt.ensure_qtapp()</span>
<span class="sd">        &gt;&gt;&gt; exec(ut.execstr_funckw(newButton), globals())</span>
<span class="sd">        &gt;&gt;&gt; button = newButton(text=&#39;button&#39;)</span>
<span class="sd">        &gt;&gt;&gt; result = (&#39;button = %s&#39; % (ut.repr2(button),))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--show)</span>
<span class="sd">        &gt;&gt;&gt; ut.quit_if_noshow()</span>
<span class="sd">        &gt;&gt;&gt; gt.qtapp_loop(qwin=button, freq=10)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pressed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_funcname</span><span class="p">(</span><span class="n">pressed</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">clicked</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_funcname</span><span class="p">(</span><span class="n">clicked</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="n">but_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">text</span><span class="p">]</span>
    <span class="n">but_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;parent&#39;</span><span class="p">:</span> <span class="n">parent</span>
    <span class="p">}</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">clicked</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">but_kwargs</span><span class="p">[</span><span class="s1">&#39;clicked&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clicked</span>
        <span class="n">enabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">pressed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">but_kwargs</span><span class="p">[</span><span class="s1">&#39;pressed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pressed</span>
        <span class="n">enabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">qicon</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">but_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">qicon</span><span class="p">]</span> <span class="o">+</span> <span class="n">but_args</span>
    <span class="n">button</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">(</span><span class="o">*</span><span class="n">but_args</span><span class="p">,</span> <span class="o">**</span><span class="n">but_kwargs</span><span class="p">)</span>
    <span class="n">style_sheet_str</span> <span class="o">=</span> <span class="n">make_style_sheet</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="n">bgcolor</span><span class="p">,</span> <span class="n">fgcolor</span><span class="o">=</span><span class="n">fgcolor</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">style_sheet_str</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">button</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="n">style_sheet_str</span><span class="p">)</span>

    <span class="n">button</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">visible</span><span class="p">)</span>
    <span class="n">button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enabled</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">clicked</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">button</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">adjust_font</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="o">**</span><span class="n">fontkw</span><span class="p">)</span>
    <span class="n">sizePolicy</span> <span class="o">=</span> <span class="n">newSizePolicy</span><span class="p">(</span>
        <span class="n">button</span><span class="p">,</span>
        <span class="n">verticalSizePolicy</span><span class="o">=</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Maximum</span><span class="p">,</span>
        <span class="n">horizontalSizePolicy</span><span class="o">=</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span>
        <span class="c1"># verticalStretch=0</span>
    <span class="p">)</span>
    <span class="n">button</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">sizePolicy</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">shrink_to_text</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">get_widget_text_width</span><span class="p">(</span><span class="n">button</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span>
        <span class="n">button</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">min_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">button</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="n">min_width</span><span class="p">)</span>
    <span class="c1"># button.setMaximumWidth(1)</span>
    <span class="k">return</span> <span class="n">button</span></div>


<div class="viewcode-block" id="get_widget_text_width"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.get_widget_text_width">[docs]</a><span class="k">def</span> <span class="nf">get_widget_text_width</span><span class="p">(</span><span class="n">widget</span><span class="p">):</span>
    <span class="c1"># http://stackoverflow.com/questions/14418375/shrink-a-button-width</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
    <span class="n">double</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;&amp;&amp;&#39;</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39;&amp;&#39;</span> <span class="o">*</span> <span class="n">double</span><span class="p">)</span>
    <span class="n">text_width</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">fontMetrics</span><span class="p">()</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">text_width</span></div>


<div class="viewcode-block" id="newComboBox"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newComboBox">[docs]</a><span class="k">def</span> <span class="nf">newComboBox</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">changed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fgcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">fontkw</span><span class="o">=</span><span class="p">{},</span> <span class="n">editor_mode</span><span class="o">=</span><span class="s1">&#39;combo&#39;</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    wrapper around QtWidgets.QComboBox</span>

<span class="sd">    Args:</span>
<span class="sd">        parent (None):</span>
<span class="sd">        options (list): a list of tuples, which are a of the following form:</span>
<span class="sd">            [</span>
<span class="sd">                (visible text 1, backend value 1),</span>
<span class="sd">                (visible text 2, backend value 2),</span>
<span class="sd">                (visible text 3, backend value 3),</span>
<span class="sd">            ]</span>
<span class="sd">        changed (None):</span>
<span class="sd">        default (str): backend value of default item</span>
<span class="sd">        visible (bool):</span>
<span class="sd">        enabled (bool):</span>
<span class="sd">        bgcolor (None):</span>
<span class="sd">        fgcolor (None):</span>
<span class="sd">        bold (bool):</span>

<span class="sd">    Returns:</span>
<span class="sd">        QtWidgets.QComboBox: combo</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m wbia.guitool.guitool_components --test-newComboBox --show</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import wbia.guitool as gt</span>
<span class="sd">        &gt;&gt;&gt; gt.ensure_qtapp()</span>
<span class="sd">        &gt;&gt;&gt; exec(ut.execstr_funckw(newComboBox), globals())</span>
<span class="sd">        &gt;&gt;&gt; parent = None</span>
<span class="sd">        &gt;&gt;&gt; options = [&#39;red&#39;, &#39;blue&#39;]</span>
<span class="sd">        &gt;&gt;&gt; combo = newComboBox(parent, options)</span>
<span class="sd">        &gt;&gt;&gt; result = str(combo)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--show)</span>
<span class="sd">        &gt;&gt;&gt; ut.quit_if_noshow()</span>
<span class="sd">        &gt;&gt;&gt; combo.show()</span>
<span class="sd">        &gt;&gt;&gt; gt.qtapp_loop(qwin=combo, freq=10)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">combo_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;parent&#39;</span> <span class="p">:</span> <span class="n">parent</span><span class="p">,</span>
        <span class="s1">&#39;options&#39;</span><span class="p">:</span> <span class="n">options</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">default</span><span class="p">,</span>
        <span class="s1">&#39;changed&#39;</span><span class="p">:</span> <span class="n">changed</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">editor_mode</span> <span class="o">==</span> <span class="s1">&#39;combo&#39;</span><span class="p">:</span>
        <span class="n">combo</span> <span class="o">=</span> <span class="n">CustomComboBox</span><span class="p">(</span><span class="o">**</span><span class="n">combo_kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">editor_mode</span> <span class="o">==</span> <span class="s1">&#39;radio&#39;</span><span class="p">:</span>
        <span class="n">combo</span> <span class="o">=</span> <span class="n">RadioButtonGroup</span><span class="p">(</span><span class="o">**</span><span class="n">combo_kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">editor_mode</span> <span class="o">==</span> <span class="s1">&#39;hybrid&#39;</span><span class="p">:</span>
        <span class="n">combo</span> <span class="o">=</span> <span class="n">ComboRadioHybrid</span><span class="p">(</span><span class="n">num</span><span class="o">=</span><span class="n">num</span><span class="p">,</span> <span class="o">**</span><span class="n">combo_kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;editor_mode=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">editor_mode</span><span class="p">,))</span>
    <span class="c1">#if changed is None:</span>
    <span class="c1">#    enabled = False</span>
    <span class="n">combo</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">visible</span><span class="p">)</span>
    <span class="n">combo</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enabled</span><span class="p">)</span>
    <span class="n">adjust_font</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span> <span class="o">**</span><span class="n">fontkw</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">combo</span></div>


<div class="viewcode-block" id="CustomComboBox"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.CustomComboBox">[docs]</a><span class="k">class</span> <span class="nc">CustomComboBox</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QComboBox</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">changed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CustomComboBox</span><span class="p">,</span> <span class="n">combo</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

        <span class="c1"># Check for tuple option formating</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="n">opt</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span>
                   <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">opt</span><span class="p">),</span> <span class="n">opt</span><span class="p">)</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">options</span><span class="p">]</span>

        <span class="c1"># QtWidgets.QComboBox.__init__(combo, parent)</span>
        <span class="n">combo</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">options</span>
        <span class="n">combo</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="n">changed</span>
        <span class="n">combo</span><span class="o">.</span><span class="n">updateOptions</span><span class="p">()</span>
        <span class="c1">#combo.allow_add = allow_add  # TODO</span>
        <span class="c1"># combo.setEditable(True)</span>
        <span class="c1"># combo.setSizePolicy(QtWidgets.QSizePolicy.Preferred,</span>
        <span class="c1">#                     QtWidgets.QSizePolicy.Preferred)</span>

        <span class="n">combo</span><span class="o">.</span><span class="n">setDefault</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
        <span class="n">combo</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="p">[</span><span class="s1">&#39;int&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">combo</span><span class="o">.</span><span class="n">currentIndexChangedCustom</span><span class="p">)</span>

<div class="viewcode-block" id="CustomComboBox.currentValue"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.CustomComboBox.currentValue">[docs]</a>    <span class="k">def</span> <span class="nf">currentValue</span><span class="p">(</span><span class="n">combo</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">combo</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">combo</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">opt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="CustomComboBox.setOptions"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.CustomComboBox.setOptions">[docs]</a>    <span class="k">def</span> <span class="nf">setOptions</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">options</span><span class="p">]</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="n">opt</span> <span class="k">if</span> <span class="n">flag</span> <span class="k">else</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">opt</span><span class="p">),</span> <span class="n">opt</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">flag</span><span class="p">,</span> <span class="n">opt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="n">options</span><span class="p">)]</span>
        <span class="n">combo</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">options</span></div>

<div class="viewcode-block" id="CustomComboBox.updateOptions"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.CustomComboBox.updateOptions">[docs]</a>    <span class="k">def</span> <span class="nf">updateOptions</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span> <span class="n">reselect</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reselect_index</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">reselect_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">reselect_index</span> <span class="o">=</span> <span class="n">combo</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="n">combo</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">combo</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span> <span class="p">[</span> <span class="n">option</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">combo</span><span class="o">.</span><span class="n">options</span> <span class="p">]</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">reselect</span> <span class="ow">and</span> <span class="n">reselect_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">combo</span><span class="o">.</span><span class="n">options</span><span class="p">):</span>
            <span class="n">combo</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">reselect_index</span><span class="p">)</span></div>

<div class="viewcode-block" id="CustomComboBox.setOptionText"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.CustomComboBox.setOptionText">[docs]</a>    <span class="k">def</span> <span class="nf">setOptionText</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span> <span class="n">option_text_list</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">option_text_list</span><span class="p">):</span>
            <span class="n">combo</span><span class="o">.</span><span class="n">setItemText</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span></div>
        <span class="c1">#combo.removeItem()</span>

<div class="viewcode-block" id="CustomComboBox.currentIndexChangedCustom"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.CustomComboBox.currentIndexChangedCustom">[docs]</a>    <span class="k">def</span> <span class="nf">currentIndexChangedCustom</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">combo</span><span class="o">.</span><span class="n">changed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">combo</span><span class="o">.</span><span class="n">changed</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">combo</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span></div>

<div class="viewcode-block" id="CustomComboBox.setDefault"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.CustomComboBox.setDefault">[docs]</a>    <span class="k">def</span> <span class="nf">setDefault</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">combo</span><span class="o">.</span><span class="n">setCurrentValue</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">combo</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="CustomComboBox.setCurrentValue"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.CustomComboBox.setCurrentValue">[docs]</a>    <span class="k">def</span> <span class="nf">setCurrentValue</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">combo</span><span class="o">.</span><span class="n">findValueIndex</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">combo</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span></div>

<div class="viewcode-block" id="CustomComboBox.findValueIndex"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.CustomComboBox.findValueIndex">[docs]</a>    <span class="k">def</span> <span class="nf">findValueIndex</span><span class="p">(</span><span class="n">combo</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; finds index of backend value and sets the current index &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">combo</span><span class="o">.</span><span class="n">options</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">val</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">index</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Hack, try the text if value doesnt work</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">combo</span><span class="o">.</span><span class="n">options</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">text</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">index</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No such option value=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">,))</span></div></div>


<div class="viewcode-block" id="RadioButtonGroup"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.RadioButtonGroup">[docs]</a><span class="k">class</span> <span class="nc">RadioButtonGroup</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mutually exclusive set of options (alternative to combo box)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[],</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">changed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RadioButtonGroup</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="n">opt</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span>
                   <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">opt</span><span class="p">),</span> <span class="n">opt</span><span class="p">)</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">options</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QHBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># self.layout = FlowLayout(self)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radio_buttons</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">odict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">nice</span><span class="p">,</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="n">rb</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QRadioButton</span><span class="p">(</span><span class="n">nice</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="n">default</span><span class="p">:</span>
                <span class="n">rb</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">rb</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radio_buttons</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="n">rb</span>

        <span class="k">if</span> <span class="n">changed</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;not implemented for radio buttons yet&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="RadioButtonGroup.setCurrentValue"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.RadioButtonGroup.setCurrentValue">[docs]</a>    <span class="k">def</span> <span class="nf">setCurrentValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radio_buttons</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="RadioButtonGroup.currentText"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.RadioButtonGroup.currentText">[docs]</a>    <span class="k">def</span> <span class="nf">currentText</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">rb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">radio_buttons</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">rb</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">rb</span><span class="o">.</span><span class="n">text</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="newCheckBox"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newCheckBox">[docs]</a><span class="k">def</span> <span class="nf">newCheckBox</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">changed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">checked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fgcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">direction</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    wrapper around QtWidgets.QCheckBox</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m wbia.guitool.guitool_components newCheckBox</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import wbia.guitool as gt</span>
<span class="sd">        &gt;&gt;&gt; app = gt.ensure_qtapp()[0]</span>
<span class="sd">        &gt;&gt;&gt; parent = newWidget()</span>
<span class="sd">        &gt;&gt;&gt; cb1 = gt.newCheckBox(parent, text=&#39;check_text1&#39;,</span>
<span class="sd">        &gt;&gt;&gt;                      direction=&#39;RightToLeft&#39;)</span>
<span class="sd">        &gt;&gt;&gt; parent.addWidget(cb1)</span>
<span class="sd">        &gt;&gt;&gt; cb2 = parent.addNewCheckBox(text=&#39;check_text2&#39;,</span>
<span class="sd">        &gt;&gt;&gt;                             direction=&#39;LeftToRight&#39;)</span>
<span class="sd">        &gt;&gt;&gt; parent.show()</span>
<span class="sd">        &gt;&gt;&gt; parent.resize(600, 40)</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--show)</span>
<span class="sd">        &gt;&gt;&gt; ut.quit_if_noshow()</span>
<span class="sd">        &gt;&gt;&gt; gt.print_widget_heirarchy(cb1)</span>
<span class="sd">        &gt;&gt;&gt; gt.qtapp_loop(qwin=parent, freq=10)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">changed</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_funcname</span><span class="p">(</span><span class="n">changed</span><span class="p">)</span>
    <span class="n">check_kwargs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;text&#39;</span>   <span class="p">:</span> <span class="n">text</span><span class="p">,</span>
        <span class="s1">&#39;checked&#39;</span><span class="p">:</span> <span class="n">checked</span><span class="p">,</span>
        <span class="s1">&#39;parent&#39;</span> <span class="p">:</span> <span class="n">parent</span><span class="p">,</span>
        <span class="s1">&#39;changed&#39;</span><span class="p">:</span> <span class="n">changed</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">checkbox</span> <span class="o">=</span> <span class="n">CustomCheckBox</span><span class="p">(</span><span class="o">**</span><span class="n">check_kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">direction</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="n">rectifyQtEnum</span><span class="p">(</span><span class="s1">&#39;LayoutDirection&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="p">)</span>
        <span class="n">checkbox</span><span class="o">.</span><span class="n">setLayoutDirection</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span>
    <span class="c1"># if changed is None:</span>
    <span class="c1">#     enabled = False</span>
    <span class="n">checkbox</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="n">visible</span><span class="p">)</span>
    <span class="n">checkbox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enabled</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">checkbox</span></div>


<div class="viewcode-block" id="CustomCheckBox"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.CustomCheckBox">[docs]</a><span class="k">class</span> <span class="nc">CustomCheckBox</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QCheckBox</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">checked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">changed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># QtWidgets.QCheckBox.__init__(self, text, parent=parent)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CustomCheckBox</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="o">=</span> <span class="n">changed</span>
        <span class="k">if</span> <span class="n">checked</span><span class="p">:</span>
            <span class="c1"># 2 is equivelant to checked, 1 to partial, 0 to not checked</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stateChangedCustom</span><span class="p">)</span>

<div class="viewcode-block" id="CustomCheckBox.stateChangedCustom"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.CustomCheckBox.stateChangedCustom">[docs]</a>    <span class="k">def</span> <span class="nf">stateChangedCustom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">changed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">changed</span><span class="p">(</span><span class="n">state</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="newFont"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.newFont">[docs]</a><span class="k">def</span> <span class="nf">newFont</span><span class="p">(</span><span class="n">fontname</span><span class="o">=</span><span class="s1">&#39;Courier New&#39;</span><span class="p">,</span> <span class="n">pointSize</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; wrapper around QtGui.QFont &quot;&quot;&quot;</span>
    <span class="c1">#fontname = &#39;Courier New&#39;</span>
    <span class="c1">#pointSize = 8</span>
    <span class="c1">#weight = -1</span>
    <span class="c1">#italic = False</span>
    <span class="n">font</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QFont</span><span class="p">(</span><span class="n">fontname</span><span class="p">,</span> <span class="n">pointSize</span><span class="o">=</span><span class="n">pointSize</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="n">italic</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">font</span></div>


<div class="viewcode-block" id="adjust_font"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.adjust_font">[docs]</a><span class="k">def</span> <span class="nf">adjust_font</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pointSize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">bold</span> <span class="ow">or</span> <span class="n">pointSize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">font</span><span class="p">()</span>
        <span class="n">font</span><span class="o">.</span><span class="n">setBold</span><span class="p">(</span><span class="n">bold</span><span class="p">)</span>
        <span class="n">font</span><span class="o">.</span><span class="n">setItalic</span><span class="p">(</span><span class="n">italic</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pointSize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">font</span><span class="o">.</span><span class="n">setPointSize</span><span class="p">(</span><span class="n">pointSize</span><span class="p">)</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">font</span><span class="p">)</span></div>


<div class="viewcode-block" id="make_style_sheet"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.make_style_sheet">[docs]</a><span class="k">def</span> <span class="nf">make_style_sheet</span><span class="p">(</span><span class="n">bgcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fgcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">style_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fmtdict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">bgcolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bgcolor</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
            <span class="n">bgcolor</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">.</span><span class="n">upper</span><span class="p">())[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">255</span>
        <span class="n">style_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;background-color: rgb(</span><span class="si">{bgcolor}</span><span class="s1">)&#39;</span><span class="p">)</span>
        <span class="n">fmtdict</span><span class="p">[</span><span class="s1">&#39;bgcolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">bgcolor</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">fgcolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fgcolor</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">):</span>
            <span class="kn">import</span> <span class="nn">wbia.plottool</span> <span class="k">as</span> <span class="nn">pt</span>
            <span class="n">fgcolor</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">fgcolor</span><span class="o">.</span><span class="n">upper</span><span class="p">())[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">255</span>
        <span class="n">style_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;color: rgb(</span><span class="si">{fgcolor}</span><span class="s1">)&#39;</span><span class="p">)</span>
        <span class="n">fmtdict</span><span class="p">[</span><span class="s1">&#39;fgcolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">fgcolor</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">style_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">style_sheet_fmt</span> <span class="o">=</span> <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">style_list</span><span class="p">)</span>
        <span class="n">style_sheet_str</span> <span class="o">=</span> <span class="n">style_sheet_fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">fmtdict</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">style_sheet_str</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<span class="c1">#def make_qstyle():</span>
<span class="c1">#    style_factory = QtWidgets.QStyleFactory()</span>
<span class="c1">#    style = style_factory.create(&#39;cleanlooks&#39;)</span>
<span class="c1">#    #app_style = QtGui.Q Application.style()</span>


<div class="viewcode-block" id="getAvailableFonts"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.getAvailableFonts">[docs]</a><span class="k">def</span> <span class="nf">getAvailableFonts</span><span class="p">():</span>
    <span class="n">fontdb</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QFontDatabase</span><span class="p">()</span>
    <span class="n">available_fonts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">fontdb</span><span class="o">.</span><span class="n">families</span><span class="p">())))</span>
    <span class="k">return</span> <span class="n">available_fonts</span></div>


<div class="viewcode-block" id="layoutSplitter"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.layoutSplitter">[docs]</a><span class="k">def</span> <span class="nf">layoutSplitter</span><span class="p">(</span><span class="n">splitter</span><span class="p">):</span>
    <span class="n">old_sizes</span> <span class="o">=</span> <span class="n">splitter</span><span class="o">.</span><span class="n">sizes</span><span class="p">()</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">get_phi</span><span class="p">()</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">old_sizes</span><span class="p">)</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">phi</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">size</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">old_sizes</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">new_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">total</span> <span class="o">*</span> <span class="n">ratio</span><span class="p">))</span>
        <span class="n">total</span> <span class="o">-=</span> <span class="n">new_size</span>
        <span class="n">sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_size</span><span class="p">)</span>
    <span class="n">sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>
    <span class="n">splitter</span><span class="o">.</span><span class="n">setSizes</span><span class="p">(</span><span class="n">sizes</span><span class="p">)</span></div>


<div class="viewcode-block" id="msg_event"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.msg_event">[docs]</a><span class="k">def</span> <span class="nf">msg_event</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Returns a message event slot &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">guitool_dialogs</span><span class="o">.</span><span class="n">msgbox</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span></div>


<div class="viewcode-block" id="Spoiler"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.Spoiler">[docs]</a><span class="k">class</span> <span class="nc">Spoiler</span><span class="p">(</span><span class="n">WIDGET_BASE</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    References:</span>
<span class="sd">        # Adapted from c++ version</span>
<span class="sd">        http://stackoverflow.com/questions/32476006/how-to-make-an-expandable-collapsable-section-widget-in-qt</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m wbia.guitool.guitool_components Spoiler --show</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; import wbia.guitool</span>
<span class="sd">        &gt;&gt;&gt; import wbia.guitool as gt</span>
<span class="sd">        &gt;&gt;&gt; guitool.ensure_qtapp()</span>
<span class="sd">        &gt;&gt;&gt; #ut.exec_funckw(newWidget, globals())</span>
<span class="sd">        &gt;&gt;&gt; parent = None</span>
<span class="sd">        &gt;&gt;&gt; widget1 = GuitoolWidget(parent)</span>
<span class="sd">        &gt;&gt;&gt; widget1.addWidget(gt.newButton(</span>
<span class="sd">        &gt;&gt;&gt;      widget1, &#39;Print Hi&#39;, lambda: print(&#39;hi&#39;)))</span>
<span class="sd">        &gt;&gt;&gt; #widget2 = GuitoolWidget(parent)</span>
<span class="sd">        &gt;&gt;&gt; #widget2.addWidget(gt.newButton(</span>
<span class="sd">        &gt;&gt;&gt; #    widget2, &#39;Popup Hi&#39;, lambda: gt.user_info(widget2, &#39;hi&#39;)))</span>
<span class="sd">        &gt;&gt;&gt; spoiler = Spoiler(title=&#39;spoiler title&#39;)</span>
<span class="sd">        &gt;&gt;&gt; widget1.layout().addWidget(spoiler)</span>
<span class="sd">        &gt;&gt;&gt; #top = widget1.addNewFrame()</span>
<span class="sd">        &gt;&gt;&gt; #top.layout().addWidget(spoiler)</span>
<span class="sd">        &gt;&gt;&gt; detailed_msg = &#39;Foo\nbar&#39;</span>
<span class="sd">        &gt;&gt;&gt; child_widget = QtWidgets.QTextEdit()</span>
<span class="sd">        &gt;&gt;&gt; #child_widget.setWordWrap(True)</span>
<span class="sd">        &gt;&gt;&gt; #child_widget = QtWidgets.QPushButton()</span>
<span class="sd">        &gt;&gt;&gt; child_widget.setObjectName(&#39;child_widget&#39;)</span>
<span class="sd">        &gt;&gt;&gt; child_widget.setText(ut.lorium_ipsum() * 10)</span>
<span class="sd">        &gt;&gt;&gt; spoiler.setContentLayout(child_widget)</span>
<span class="sd">        &gt;&gt;&gt; widget1.print_widget_heirarchy()</span>
<span class="sd">        &gt;&gt;&gt; widget1.layout().setAlignment(Qt.AlignBottom)</span>
<span class="sd">        &gt;&gt;&gt; widget1.show()</span>
<span class="sd">        &gt;&gt;&gt; #widget1.resize(int(ut.PHI * 500), 500)</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--show)</span>
<span class="sd">        &gt;&gt;&gt; ut.quit_if_noshow()</span>
<span class="sd">        &gt;&gt;&gt; gt.qtapp_loop(qwin=widget1, freq=10)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">toggle_finished</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">pyqtSignal</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">animationDuration</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">checked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">contentWidget</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Spoiler</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

        <span class="c1"># Maps checked states to arrows and animation directions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arrow_states</span> <span class="o">=</span> <span class="p">{</span>
            <span class="kc">False</span><span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">RightArrow</span><span class="p">,</span>
            <span class="kc">True</span><span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">DownArrow</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_animation_state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="kc">False</span><span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QAbstractAnimation</span><span class="o">.</span><span class="n">Backward</span><span class="p">,</span>
            <span class="kc">True</span><span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QAbstractAnimation</span><span class="o">.</span><span class="n">Forward</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_policy</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1">#:</span>
        <span class="n">QSizePolicy</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_header_size_policy_states</span> <span class="o">=</span> <span class="p">{</span>
            <span class="kc">False</span><span class="p">:</span> <span class="n">newSizePolicy</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">),</span>
            <span class="kc">True</span><span class="p">:</span> <span class="n">newSizePolicy</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_self_size_policy</span> <span class="o">=</span> <span class="p">{</span>
            <span class="kc">False</span><span class="p">:</span> <span class="n">newSizePolicy</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">),</span>
            <span class="kc">True</span><span class="p">:</span> <span class="n">newSizePolicy</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scroll_size_policy_states</span> <span class="o">=</span> <span class="p">{</span>
            <span class="kc">False</span><span class="p">:</span> <span class="n">newSizePolicy</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">),</span>
            <span class="kc">True</span><span class="p">:</span> <span class="n">newSizePolicy</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span> <span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_policy</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_header_size_policy_states</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scroll_size_policy_states</span><span class="p">[</span><span class="kc">True</span><span class="p">]</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scroll_size_policy_states</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checked</span> <span class="o">=</span> <span class="n">checked</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">animationDuration</span> <span class="o">=</span> <span class="mi">150</span>
        <span class="c1">#150</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">toggleButton</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QToolButton</span><span class="p">()</span>
        <span class="n">toggleButton</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggleButton</span>
        <span class="n">toggleButton</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;QToolButton { border: none; }&#39;</span><span class="p">)</span>
        <span class="n">toggleButton</span><span class="o">.</span><span class="n">setToolButtonStyle</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ToolButtonTextBesideIcon</span><span class="p">)</span>
        <span class="n">toggleButton</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">))</span>
        <span class="n">toggleButton</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">toggleButton</span><span class="o">.</span><span class="n">setArrowType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_arrow_states</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">checked</span><span class="p">])</span>
        <span class="n">toggleButton</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checked</span><span class="p">)</span>
        <span class="n">toggleButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggle_spoiler</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">headerLine</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headerLine</span><span class="o">.</span><span class="n">setFrameShape</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">HLine</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headerLine</span><span class="o">.</span><span class="n">setFrameShadow</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QFrame</span><span class="o">.</span><span class="n">Sunken</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_policy</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">headerLine</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_header_size_policy_states</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">checked</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">headerLine</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_header_size_policy_states</span><span class="p">[</span><span class="kc">False</span><span class="p">])</span>

        <span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">contentWidget</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QScrollArea</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;QScrollArea { background-color: white; border: none; }&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_policy</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scroll_size_policy_states</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">checked</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scroll_size_policy_states</span><span class="p">[</span><span class="kc">False</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s1">&#39;QScrollArea { border: none; }&#39;</span><span class="p">)</span>

                <span class="c1"># start out collapsed</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setWidgetResizable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span> <span class="o">=</span> <span class="n">contentWidget</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># let the entire widget grow and shrink with its content</span>
        <span class="c1"># The animation forces the minimum and maximum height to be equal</span>
        <span class="c1"># By having the minimum and maximum height simultaniously</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggleAnimation</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QParallelAnimationGroup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spoiler_animations</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">QtCore</span><span class="o">.</span><span class="n">QPropertyAnimation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="s1">&#39;minimumHeight&#39;</span><span class="p">)),</span>
            <span class="n">QtCore</span><span class="o">.</span><span class="n">QPropertyAnimation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="s1">&#39;maximumHeight&#39;</span><span class="p">)),</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_animations</span> <span class="o">=</span> <span class="p">[</span>
            <span class="c1">#QtCore.QPropertyAnimation(self.contentWidget, &#39;maximumHeight&#39;)</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">animation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spoiler_animations</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">content_animations</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggleAnimation</span><span class="o">.</span><span class="n">addAnimation</span><span class="p">(</span><span class="n">animation</span><span class="p">)</span>
        <span class="c1">#self.toggle_finished = self.toggleAnimation.finished</span>

        <span class="c1"># don&#39;t waste space</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QGridLayout</span><span class="p">()</span>
        <span class="c1">#self.mainLayout = QtWidgets.QVBoxLayout()</span>
        <span class="n">mainLayout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span>
        <span class="n">mainLayout</span><span class="o">.</span><span class="n">setVerticalSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">mainLayout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1">#mainLayout.addWidget(self.toggleButton, alignment=QtCore.Qt.AlignLeft)</span>
        <span class="c1">#mainLayout.addWidget(self.contentWidget)</span>
        <span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toggleButton</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignLeft</span> <span class="o">|</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignTop</span><span class="p">)</span>
        <span class="c1">#mainLayout.addWidget(self.headerLine, 1, 2, 1, 1)</span>
        <span class="c1">#mainLayout.addWidget(self.contentWidget, 1, 0, 1, 3)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">16777215</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">toggleAnimation</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">finalize_animation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_self_size_policy</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">checked</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">DEBUG_WIDGET</span><span class="p">:</span>
            <span class="c1"># debug code</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;background-color: rgb(255,0,0); margin:5px; border:1px solid rgb(0, 255, 0); &quot;</span><span class="p">)</span>

<div class="viewcode-block" id="Spoiler.finalize_animation"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.Spoiler.finalize_animation">[docs]</a>    <span class="k">def</span> <span class="nf">finalize_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checked</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">16777215</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">16777215</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="c1">#self.setMaximumHeight(0)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggle_finished</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checked</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spoiler.toggle_spoiler"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.Spoiler.toggle_spoiler">[docs]</a>    <span class="k">def</span> <span class="nf">toggle_spoiler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checked</span> <span class="o">=</span> <span class="n">checked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggleButton</span><span class="o">.</span><span class="n">setArrowType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_arrow_states</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">checked</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggleAnimation</span><span class="o">.</span><span class="n">setDirection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_animation_state</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">checked</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_self_size_policy</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">checked</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_policy</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">headerLine</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_header_size_policy_states</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">checked</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scroll_size_policy_states</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">checked</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggleAnimation</span><span class="o">.</span><span class="n">start</span><span class="p">()</span></div>

<div class="viewcode-block" id="Spoiler.setContentLayout"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.Spoiler.setContentLayout">[docs]</a>    <span class="k">def</span> <span class="nf">setContentLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">contentLayout</span><span class="p">):</span>
        <span class="c1"># Not sure if this is equivalent to self.contentWidget.destroy()</span>
        <span class="c1">#self.contentWidget.destroy()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">contentLayout</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1">#import utool</span>
            <span class="c1">#utool.embed()</span>
            <span class="c1"># HACKY</span>
            <span class="n">contentWidgetNew</span> <span class="o">=</span> <span class="n">contentLayout</span>
            <span class="n">contentWidgetOld</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span>
            <span class="c1">#self.contentWidget.setWidget(contentWidget)</span>

            <span class="k">if</span> <span class="n">contentWidgetOld</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Replace existing scrollbar with something else</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="n">contentWidgetOld</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">animation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content_animations</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">toggleAnimation</span><span class="o">.</span><span class="n">removeAnimation</span><span class="p">(</span><span class="n">animation</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span> <span class="o">=</span> <span class="n">contentWidgetNew</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">content_animations</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QPropertyAnimation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">b</span><span class="p">(</span><span class="s1">&#39;maximumHeight&#39;</span><span class="p">))</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">animation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content_animations</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toggleAnimation</span><span class="o">.</span><span class="n">addAnimation</span><span class="p">(</span><span class="n">animation</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">mainLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="c1">#if False:</span>
            <span class="c1">#    if self.change_policy:</span>
            <span class="c1">#        self.contentWidget.setSizePolicy(self._scroll_size_policy_states[self.checked])</span>
            <span class="c1">#    else:</span>
            <span class="c1">#        self.contentWidget.setSizePolicy(self._scroll_size_policy_states[False])</span>

        <span class="c1"># Find content height</span>
        <span class="n">collapsedConentHeight</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">expandedContentHeight</span> <span class="o">=</span> <span class="n">contentLayout</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>

        <span class="c1"># Container height</span>
        <span class="n">collapsedSpoilerHeight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">maximumHeight</span><span class="p">()</span>
        <span class="n">expandedSpoilerHeight</span> <span class="o">=</span> <span class="n">collapsedSpoilerHeight</span> <span class="o">+</span> <span class="n">expandedContentHeight</span>

        <span class="n">contentStart</span> <span class="o">=</span> <span class="n">collapsedConentHeight</span>
        <span class="n">contentEnd</span> <span class="o">=</span> <span class="n">expandedContentHeight</span>

        <span class="n">spoilerStart</span> <span class="o">=</span> <span class="n">collapsedSpoilerHeight</span>
        <span class="n">spoilerEnd</span> <span class="o">=</span> <span class="n">expandedSpoilerHeight</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">checked</span><span class="p">:</span>
            <span class="c1"># Start expanded</span>
            <span class="n">spoilerStart</span><span class="p">,</span> <span class="n">spoilerEnd</span> <span class="o">=</span> <span class="n">spoilerEnd</span><span class="p">,</span> <span class="n">spoilerStart</span>
            <span class="n">contentStart</span><span class="p">,</span> <span class="n">contentEnd</span> <span class="o">=</span> <span class="n">contentEnd</span><span class="p">,</span> <span class="n">contentStart</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">contentWidget</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="n">contentStart</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spoilerStart</span> <span class="o">=</span> <span class="n">spoilerStart</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spoilerEnd</span> <span class="o">=</span> <span class="n">spoilerEnd</span>

        <span class="k">for</span> <span class="n">spoilerAnimation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">spoiler_animations</span><span class="p">:</span>
            <span class="n">spoilerAnimation</span><span class="o">.</span><span class="n">setDuration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">animationDuration</span><span class="p">)</span>
            <span class="n">spoilerAnimation</span><span class="o">.</span><span class="n">setStartValue</span><span class="p">(</span><span class="n">spoilerStart</span><span class="p">)</span>
            <span class="n">spoilerAnimation</span><span class="o">.</span><span class="n">setEndValue</span><span class="p">(</span><span class="n">spoilerEnd</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">contentAnimation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">content_animations</span><span class="p">:</span>
            <span class="n">contentAnimation</span><span class="o">.</span><span class="n">setDuration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">animationDuration</span><span class="p">)</span>
            <span class="n">contentAnimation</span><span class="o">.</span><span class="n">setStartValue</span><span class="p">(</span><span class="n">contentStart</span><span class="p">)</span>
            <span class="n">contentAnimation</span><span class="o">.</span><span class="n">setEndValue</span><span class="p">(</span><span class="n">contentEnd</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SimpleTree"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.SimpleTree">[docs]</a><span class="k">class</span> <span class="nc">SimpleTree</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DEPRICATE IN FAVOR OF CONFIG WIDGETS? Need to make them heirarchical first</span>

<span class="sd">    References:</span>
<span class="sd">        http://stackoverflow.com/questions/12737721/developing-pyqt4-tree-widget</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SimpleTree</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTreeWidget</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent</span><span class="p">:</span>
            <span class="n">parent</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">setHeaderHidden</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">invisibleRootItem</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="o">.</span><span class="n">itemChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handleChanged</span><span class="p">)</span>
        <span class="c1"># print(&#39;x = %r&#39; % (x,))</span>
        <span class="c1"># self.tree.itemClicked.connect(self.handleClicked)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="SimpleTree.add_parent"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.SimpleTree.add_parent">[docs]</a>    <span class="k">def</span> <span class="nf">add_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;ff&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
        <span class="n">column</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTreeWidgetItem</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="p">[</span><span class="n">title</span><span class="p">])</span>
        <span class="n">item</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="n">item</span><span class="o">.</span><span class="n">setChildIndicatorPolicy</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTreeWidgetItem</span><span class="o">.</span><span class="n">ShowIndicator</span><span class="p">)</span>
        <span class="n">item</span><span class="o">.</span><span class="n">setExpanded</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">item</span></div>

<div class="viewcode-block" id="SimpleTree.add_checkbox"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.SimpleTree.add_checkbox">[docs]</a>    <span class="k">def</span> <span class="nf">add_checkbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;ff&#39;</span><span class="p">,</span> <span class="n">checked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">changed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">column</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">with</span> <span class="n">BlockSignals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="p">):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTreeWidgetItem</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="p">[</span><span class="n">title</span><span class="p">])</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span> <span class="k">if</span> <span class="n">checked</span> <span class="k">else</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">changed</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">changed</span>
            <span class="c1"># Inject helper method</span>

            <span class="k">def</span> <span class="nf">isChecked</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">item</span><span class="o">.</span><span class="n">checkState</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span>

            <span class="k">def</span> <span class="nf">setChecked</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">item</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span> <span class="k">if</span> <span class="n">checked</span> <span class="k">else</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">isChecked</span> <span class="o">=</span> <span class="n">isChecked</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setChecked</span> <span class="o">=</span> <span class="n">setChecked</span>
        <span class="k">return</span> <span class="n">item</span></div>

<div class="viewcode-block" id="SimpleTree.add_combobox"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.SimpleTree.add_combobox">[docs]</a>    <span class="k">def</span> <span class="nf">add_combobox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="s1">&#39;ff&#39;</span><span class="p">,</span> <span class="n">checked</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">changed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">column</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">with</span> <span class="n">BlockSignals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tree</span><span class="p">):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTreeWidgetItem</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="p">[</span><span class="n">title</span><span class="p">])</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span> <span class="k">if</span> <span class="n">checked</span> <span class="k">else</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">changed</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">changed</span>
            <span class="c1"># Inject helper method</span>

            <span class="k">def</span> <span class="nf">isChecked</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">item</span><span class="o">.</span><span class="n">checkState</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span>

            <span class="k">def</span> <span class="nf">setChecked</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">item</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span> <span class="k">if</span> <span class="n">checked</span> <span class="k">else</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">isChecked</span> <span class="o">=</span> <span class="n">isChecked</span>
            <span class="n">item</span><span class="o">.</span><span class="n">setChecked</span> <span class="o">=</span> <span class="n">setChecked</span>
        <span class="k">return</span> <span class="n">item</span></div>

    <span class="c1"># @QtCore.pyqtSlot(QtWidgets.QTreeWidgetItem, int)</span>
    <span class="c1"># def handleClicked(self, item, column):</span>
    <span class="c1">#     pass</span>
    <span class="c1">#     # print(&#39;item = %r&#39; % (item,))</span>

<div class="viewcode-block" id="SimpleTree.handleChanged"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.SimpleTree.handleChanged">[docs]</a>    <span class="nd">@QtCore</span><span class="o">.</span><span class="n">pyqtSlot</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QTreeWidgetItem</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">handleChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
        <span class="n">callback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">checkState</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">checkState</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">callback</span><span class="p">:</span>
            <span class="n">callback</span><span class="p">(</span><span class="n">state</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="BlockSignals"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.BlockSignals">[docs]</a><span class="k">class</span> <span class="nc">BlockSignals</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qobj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qobj</span> <span class="o">=</span> <span class="n">qobj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qobj</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tb</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qobj</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prev</span><span class="p">)</span></div>

        <span class="c1">#! /usr/bin/python2</span>
<span class="c1"># -*- coding: utf-8 -*-</span>


<div class="viewcode-block" id="FlowLayout"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.FlowLayout">[docs]</a><span class="k">class</span> <span class="nc">FlowLayout</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QLayout</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    References:</span>
<span class="sd">        https://gist.github.com/Cysu/7461066</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m wbia.guitool.guitool_components FlowLayout</span>

<span class="sd">    Ignore:</span>
<span class="sd">        &gt;&gt;&gt; import sys</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import wbia.guitool as gt</span>
<span class="sd">        &gt;&gt;&gt; app = gt.ensure_qtapp()[0]</span>
<span class="sd">        &gt;&gt;&gt; #</span>
<span class="sd">        &gt;&gt;&gt; class Window(QtWidgets.QWidget):</span>
<span class="sd">        &gt;&gt;&gt;     def __init__(self):</span>
<span class="sd">        &gt;&gt;&gt;         super(Window, self).__init__()</span>
<span class="sd">        &gt;&gt;&gt;         #</span>
<span class="sd">        &gt;&gt;&gt;         flowLayout = FlowLayout()</span>
<span class="sd">        &gt;&gt;&gt;         #flowLayout.setLayoutDirection(Qt.RightToLeft)</span>
<span class="sd">        &gt;&gt;&gt;         flowLayout.addWidget(QtWidgets.QPushButton(&quot;Short&quot;))</span>
<span class="sd">        &gt;&gt;&gt;         flowLayout.addWidget(QtWidgets.QPushButton(&quot;Longer&quot;))</span>
<span class="sd">        &gt;&gt;&gt;         flowLayout.addWidget(QtWidgets.QPushButton(&quot;Different text&quot;))</span>
<span class="sd">        &gt;&gt;&gt;         flowLayout.addWidget(QtWidgets.QPushButton(&quot;More text&quot;))</span>
<span class="sd">        &gt;&gt;&gt;         flowLayout.addWidget(QtWidgets.QPushButton(&quot;Even longer button text&quot;))</span>
<span class="sd">        &gt;&gt;&gt;         self.setLayout(flowLayout)</span>
<span class="sd">        &gt;&gt;&gt;         #</span>
<span class="sd">        &gt;&gt;&gt;         self.setWindowTitle(&quot;Flow Layout&quot;)</span>
<span class="sd">        &gt;&gt;&gt; mainWin = Window()</span>
<span class="sd">        &gt;&gt;&gt; mainWin.show()</span>
<span class="sd">        &gt;&gt;&gt; gt.qtapp_loop(freq=10)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FlowLayout</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;setMargin&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setMargin</span><span class="p">(</span><span class="n">margin</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="n">margin</span><span class="p">,</span> <span class="n">margin</span><span class="p">,</span> <span class="n">margin</span><span class="p">,</span> <span class="n">margin</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="n">spacing</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">itemList</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">takeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">item</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">takeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<div class="viewcode-block" id="FlowLayout.addItem"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.FlowLayout.addItem">[docs]</a>    <span class="k">def</span> <span class="nf">addItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">itemList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowLayout.count"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.FlowLayout.count">[docs]</a>    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemList</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowLayout.itemAt"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.FlowLayout.itemAt">[docs]</a>    <span class="k">def</span> <span class="nf">itemAt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemList</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemList</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="FlowLayout.takeAt"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.FlowLayout.takeAt">[docs]</a>    <span class="k">def</span> <span class="nf">takeAt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">itemList</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemList</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="FlowLayout.expandingDirections"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.FlowLayout.expandingDirections">[docs]</a>    <span class="k">def</span> <span class="nf">expandingDirections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Orientations</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Orientation</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span></div>

<div class="viewcode-block" id="FlowLayout.hasHeightForWidth"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.FlowLayout.hasHeightForWidth">[docs]</a>    <span class="k">def</span> <span class="nf">hasHeightForWidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="FlowLayout.heightForWidth"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.FlowLayout.heightForWidth">[docs]</a>    <span class="k">def</span> <span class="nf">heightForWidth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
        <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_doLayout</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">height</span></div>

<div class="viewcode-block" id="FlowLayout.setGeometry"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.FlowLayout.setGeometry">[docs]</a>    <span class="k">def</span> <span class="nf">setGeometry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">FlowLayout</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_doLayout</span><span class="p">(</span><span class="n">rect</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="FlowLayout.sizeHint"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.FlowLayout.sizeHint">[docs]</a>    <span class="k">def</span> <span class="nf">sizeHint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimumSize</span><span class="p">()</span></div>

<div class="viewcode-block" id="FlowLayout.minimumSize"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.FlowLayout.minimumSize">[docs]</a>    <span class="k">def</span> <span class="nf">minimumSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemList</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">size</span><span class="o">.</span><span class="n">expandedTo</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">minimumSize</span><span class="p">())</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;contentsMargins&#39;</span><span class="p">):</span>
            <span class="n">margin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">contentsMargins</span><span class="p">()</span>
            <span class="n">margin</span> <span class="o">=</span> <span class="p">(</span><span class="n">margin</span><span class="o">.</span><span class="n">left</span><span class="p">()</span> <span class="o">+</span> <span class="n">margin</span><span class="o">.</span><span class="n">right</span><span class="p">()</span> <span class="o">+</span> <span class="n">margin</span><span class="o">.</span><span class="n">bottom</span><span class="p">()</span> <span class="o">+</span>
                      <span class="n">margin</span><span class="o">.</span><span class="n">top</span><span class="p">())</span> <span class="o">/</span> <span class="mi">4</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">margin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">margin</span><span class="p">()</span>

        <span class="n">size</span> <span class="o">+=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">margin</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">margin</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">size</span></div>

    <span class="k">def</span> <span class="nf">_doLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="p">,</span> <span class="n">testOnly</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>
        <span class="n">lineHeight</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">itemList</span><span class="p">:</span>
            <span class="n">wid</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span>
            <span class="n">spaceX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spacing</span><span class="p">()</span> <span class="o">+</span> <span class="n">wid</span><span class="o">.</span><span class="n">style</span><span class="p">()</span><span class="o">.</span><span class="n">layoutSpacing</span><span class="p">(</span>
                <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">PushButton</span><span class="p">,</span>
                <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">PushButton</span><span class="p">,</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>

            <span class="n">spaceY</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spacing</span><span class="p">()</span> <span class="o">+</span> <span class="n">wid</span><span class="o">.</span><span class="n">style</span><span class="p">()</span><span class="o">.</span><span class="n">layoutSpacing</span><span class="p">(</span>
                <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">PushButton</span><span class="p">,</span>
                <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">PushButton</span><span class="p">,</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Vertical</span><span class="p">)</span>

            <span class="n">nextX</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">item</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span> <span class="n">spaceX</span>
            <span class="k">if</span> <span class="n">nextX</span> <span class="o">-</span> <span class="n">spaceX</span> <span class="o">&gt;</span> <span class="n">rect</span><span class="o">.</span><span class="n">right</span><span class="p">()</span> <span class="ow">and</span> <span class="n">lineHeight</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">lineHeight</span> <span class="o">+</span> <span class="n">spaceY</span>
                <span class="n">nextX</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">item</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span> <span class="n">spaceX</span>
                <span class="n">lineHeight</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">testOnly</span><span class="p">:</span>
                <span class="n">item</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span>
                    <span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">item</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()))</span>

            <span class="n">x</span> <span class="o">=</span> <span class="n">nextX</span>
            <span class="n">lineHeight</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">lineHeight</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">y</span> <span class="o">+</span> <span class="n">lineHeight</span> <span class="o">-</span> <span class="n">rect</span><span class="o">.</span><span class="n">y</span><span class="p">()</span></div>


<div class="viewcode-block" id="ComboRadioHybrid"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ComboRadioHybrid">[docs]</a><span class="k">class</span> <span class="nc">ComboRadioHybrid</span><span class="p">(</span><span class="n">GuitoolWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CommandLine:</span>
<span class="sd">        python -m wbia.guitool.guitool_components ComboRadioHybrid --show</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from wbia.guitool.guitool_components import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import wbia.guitool as gt</span>
<span class="sd">        &gt;&gt;&gt; gt.ensure_qtapp()</span>
<span class="sd">        &gt;&gt;&gt; parent = None</span>
<span class="sd">        &gt;&gt;&gt; options = [&#39;red&#39;, &#39;blue&#39;, &#39;green&#39;, &#39;blue&#39;, &#39;black&#39;, &#39;blah&#39;]</span>
<span class="sd">        &gt;&gt;&gt; options = [(a.title(), a) for a in options]</span>
<span class="sd">        &gt;&gt;&gt; self = ComboRadioHybrid(parent=parent, options=options)</span>
<span class="sd">        &gt;&gt;&gt; self.setCurrentValue(&#39;black&#39;)</span>
<span class="sd">        &gt;&gt;&gt; #self.print_widget_heirarchy(attrs=[&#39;sizePolicy&#39;])</span>
<span class="sd">        &gt;&gt;&gt; # xdoctest: +REQUIRES(--show)</span>
<span class="sd">        &gt;&gt;&gt; ut.quit_if_noshow()</span>
<span class="sd">        &gt;&gt;&gt; self.show()</span>
<span class="sd">        &gt;&gt;&gt; print(self.currentText())</span>
<span class="sd">        &gt;&gt;&gt; gt.qtapp_loop(qwin=self, freq=10)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ori&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;vert&#39;</span><span class="p">))</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ori&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;horiz&#39;</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;margin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ComboRadioHybrid</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="ComboRadioHybrid.on_toggle"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ComboRadioHybrid.on_toggle">[docs]</a>    <span class="k">def</span> <span class="nf">on_toggle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="p">,</span> <span class="n">checked</span><span class="p">):</span>
        <span class="k">pass</span></div>
        <span class="c1"># if button is self.combo_rb:</span>
        <span class="c1">#     self.combo.setEnabled(checked)</span>

<div class="viewcode-block" id="ComboRadioHybrid.initialize"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ComboRadioHybrid.initialize">[docs]</a>    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">[],</span> <span class="n">num</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">changed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Rectify options</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="n">opt</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">opt</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span>
                   <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">opt</span><span class="p">),</span> <span class="n">opt</span><span class="p">)</span> <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">options</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)</span> <span class="o">==</span> <span class="n">num</span><span class="p">:</span>
            <span class="n">num</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radio_options</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">num</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_options</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="n">num</span><span class="p">:]</span>

        <span class="c1"># Put all radio buttons in a group</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QButtonGroup</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">setExclusive</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">buttonToggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_toggle</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">radio_buttons</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">odict</span><span class="p">()</span>
        <span class="n">ori</span> <span class="o">=</span> <span class="s1">&#39;grid&#39;</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="p">(</span><span class="n">nice</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radio_options</span><span class="p">):</span>
            <span class="n">rb_widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">addNewWidget</span><span class="p">(</span><span class="n">ori</span><span class="o">=</span><span class="n">ori</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                          <span class="n">name</span><span class="o">=</span><span class="s1">&#39;opt_</span><span class="si">%d</span><span class="s1">_widget&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">count</span><span class="p">,))</span>
            <span class="n">adjustSizePolicy</span><span class="p">(</span><span class="n">rb_widget</span><span class="p">,</span> <span class="n">vPolicy</span><span class="o">=</span><span class="s1">&#39;Fixed&#39;</span><span class="p">)</span>
            <span class="c1"># rb_widget.addNewSpacer(row=0, column=0)</span>
            <span class="n">rb</span> <span class="o">=</span> <span class="n">rb_widget</span><span class="o">.</span><span class="n">addNewRadioButton</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                             <span class="n">name</span><span class="o">=</span><span class="s1">&#39;opt_</span><span class="si">%d</span><span class="s1">_rb&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">count</span><span class="p">,))</span>
            <span class="n">adjustSizePolicy</span><span class="p">(</span><span class="n">rb</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="s1">&#39;Fixed&#39;</span><span class="p">,</span> <span class="n">vPolicy</span><span class="o">=</span><span class="s1">&#39;Fixed&#39;</span><span class="p">)</span>
            <span class="c1"># rb.setLayoutDirection(Qt.RightToLeft)</span>
            <span class="c1"># rb_widget.addNewSpacer(row=0, column=2)</span>
            <span class="n">rb_widget</span><span class="o">.</span><span class="n">addNewLabel</span><span class="p">(</span><span class="n">nice</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnSpan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;opt_</span><span class="si">%d</span><span class="s1">_label&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">count</span><span class="p">,))</span>
            <span class="c1"># rb_widget.addNewSpacer(column=)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="n">rb</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="n">default</span><span class="p">:</span>
                <span class="n">rb</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radio_buttons</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="n">rb</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_options</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">rb_widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">addNewWidget</span><span class="p">(</span><span class="n">ori</span><span class="o">=</span><span class="n">ori</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                          <span class="n">name</span><span class="o">=</span><span class="s1">&#39;opt_rest_widget&#39;</span><span class="p">)</span>
            <span class="n">adjustSizePolicy</span><span class="p">(</span><span class="n">rb_widget</span><span class="p">,</span> <span class="n">vPolicy</span><span class="o">=</span><span class="s1">&#39;Fixed&#39;</span><span class="p">)</span>
            <span class="c1"># rb_widget.addNewSpacer(row=0, column=0)</span>
            <span class="n">adjustSizePolicy</span><span class="p">(</span><span class="n">rb_widget</span><span class="p">,</span> <span class="n">vPolicy</span><span class="o">=</span><span class="s1">&#39;Fixed&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo_rb</span> <span class="o">=</span> <span class="n">rb_widget</span><span class="o">.</span><span class="n">addNewRadioButton</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;opt_rest_rb&#39;</span><span class="p">)</span>
            <span class="n">adjustSizePolicy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_rb</span><span class="p">,</span> <span class="n">hPolicy</span><span class="o">=</span><span class="s1">&#39;Fixed&#39;</span><span class="p">,</span> <span class="n">vPolicy</span><span class="o">=</span><span class="s1">&#39;Fixed&#39;</span><span class="p">)</span>

            <span class="c1"># rb_widget.addNewSpacer(row=0, column=2)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo</span> <span class="o">=</span> <span class="n">rb_widget</span><span class="o">.</span><span class="n">addNewComboBox</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_options</span><span class="p">,</span>
                                                  <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnSpan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;opt_rest_combo&#39;</span><span class="p">)</span>

            <span class="c1"># model = self.combo.model()</span>
            <span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
                <span class="c1"># TODO: figure out how to align text without setting editable</span>
                <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_options</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setItemData</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">TextAlignmentRole</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_options</span><span class="p">)):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">itemData</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">itemData</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setEditable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">lineEdit</span><span class="p">()</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignCenter</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">lineEdit</span><span class="p">()</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># rb_widget.addNewSpacer()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_rb</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">default</span> <span class="ow">in</span> <span class="n">ut</span><span class="o">.</span><span class="n">take_column</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">rb</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># else:</span>
            <span class="c1">#     self.combo.setEnabled(False)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_rb</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span></div>

            <span class="c1"># self.combo.setStyleSheet(</span>
            <span class="c1">#     &#39;&#39;&#39;</span>
            <span class="c1">#     {</span>
            <span class="c1">#         text-align: center;</span>
            <span class="c1">#     }</span>
            <span class="c1">#     &#39;&#39;&#39;</span>
            <span class="c1"># )</span>

            <span class="c1"># self.combo.lineEdit().setAlignment(QtCore.Qt.AlignCenter)</span>
        <span class="c1"># self.set_all_margins(1)</span>

<div class="viewcode-block" id="ComboRadioHybrid.setCurrentValue"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ComboRadioHybrid.setCurrentValue">[docs]</a>    <span class="k">def</span> <span class="nf">setCurrentValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">radio_buttons</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radio_buttons</span><span class="p">[</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">setCurrentValue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">combo_rb</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="ComboRadioHybrid.currentText"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ComboRadioHybrid.currentText">[docs]</a>    <span class="k">def</span> <span class="nf">currentText</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_rb</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">rb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radio_buttons</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">rb</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">radio_options</span><span class="p">[</span><span class="n">count</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="ComboRadioHybrid.currentValue"><a class="viewcode-back" href="../../../wbia.guitool.html#wbia.guitool.guitool_components.ComboRadioHybrid.currentValue">[docs]</a>    <span class="k">def</span> <span class="nf">currentValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_rb</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo</span><span class="o">.</span><span class="n">currentValue</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">rb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radio_buttons</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">rb</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">radio_options</span><span class="p">[</span><span class="n">count</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CommandLine:</span>
<span class="sd">        python -m wbia.guitool.guitool_components</span>
<span class="sd">        python -m wbia.guitool.guitool_components --allexamples</span>
<span class="sd">        python -m wbia.guitool.guitool_components --allexamples --noface --nosrc</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">multiprocessing</span>
    <span class="n">multiprocessing</span><span class="o">.</span><span class="n">freeze_support</span><span class="p">()</span>  <span class="c1"># for win32</span>
    <span class="kn">import</span> <span class="nn">utool</span> <span class="k">as</span> <span class="nn">ut</span>  <span class="c1"># NOQA</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">doctest_funcs</span><span class="p">()</span>
</pre></div>

          </div>

        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../contents.html">wbia</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../contents.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  <li><a href="../../wbia.html">wbia</a><ul>
  <li><a href="../guitool.html">wbia.guitool</a><ul>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Wild Me.

      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>

    </div>




  </body>
</html>
