<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ibeis.control.manual_annot_funcs &mdash; ibeis 0.1.0.dev1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.1.0.dev1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="ibeis 0.1.0.dev1 documentation" href="../../../index.html" />
    <link rel="up" title="ibeis.control" href="../control.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">ibeis 0.1.0.dev1 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../ibeis.html" >ibeis</a> &raquo;</li>
          <li><a href="../control.html" accesskey="U">ibeis.control</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for ibeis.control.manual_annot_funcs</h1><div class="highlight"><pre>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">six</span>  <span class="c"># NOQA</span>
<span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">from</span> <span class="nn">ibeis</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
<span class="kn">from</span> <span class="nn">ibeis.control</span> <span class="kn">import</span> <span class="n">accessor_decors</span>
<span class="kn">from</span> <span class="nn">ibeis.control.accessor_decors</span> <span class="kn">import</span> <span class="p">(</span><span class="n">adder</span><span class="p">,</span> <span class="n">ider</span><span class="p">,</span> <span class="n">getter_1to1</span><span class="p">,</span> <span class="n">getter_1toM</span><span class="p">,</span> <span class="n">deleter</span><span class="p">,</span> <span class="n">setter</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span>
<span class="kn">from</span> <span class="nn">ibeis</span> <span class="kn">import</span> <span class="n">ibsfuncs</span>
<span class="kn">from</span> <span class="nn">ibeis.control.controller_inject</span> <span class="kn">import</span> <span class="n">make_ibs_register_decorator</span>
<span class="k">print</span><span class="p">,</span> <span class="n">print_</span><span class="p">,</span> <span class="n">printDBG</span><span class="p">,</span> <span class="n">rrr</span><span class="p">,</span> <span class="n">profile</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">inject</span><span class="p">(</span><span class="n">__name__</span><span class="p">,</span> <span class="s">&#39;[manual_annot]&#39;</span><span class="p">)</span>


<span class="n">CLASS_INJECT_KEY</span><span class="p">,</span> <span class="n">register_ibs_method</span> <span class="o">=</span> <span class="n">make_ibs_register_decorator</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>


<span class="n">ANNOT_NOTE</span>          <span class="o">=</span> <span class="s">&#39;annot_note&#39;</span>
<span class="n">ANNOT_NUM_VERTS</span>     <span class="o">=</span> <span class="s">&#39;annot_num_verts&#39;</span>
<span class="n">ANNOT_PARENT_ROWID</span>  <span class="o">=</span> <span class="s">&#39;annot_parent_rowid&#39;</span>
<span class="n">ANNOT_ROWID</span>         <span class="o">=</span> <span class="s">&#39;annot_rowid&#39;</span>
<span class="n">ANNOT_SEMANTIC_UUID</span> <span class="o">=</span> <span class="s">&#39;annot_semantic_uuid&#39;</span>
<span class="n">ANNOT_THETA</span>         <span class="o">=</span> <span class="s">&#39;annot_theta&#39;</span>
<span class="n">ANNOT_VERTS</span>         <span class="o">=</span> <span class="s">&#39;annot_verts&#39;</span>
<span class="n">ANNOT_UUID</span>          <span class="o">=</span> <span class="s">&#39;annot_uuid&#39;</span>
<span class="n">ANNOT_VIEWPOINT</span>     <span class="o">=</span> <span class="s">&#39;annot_viewpoint&#39;</span>
<span class="n">ANNOT_VISUAL_UUID</span>   <span class="o">=</span> <span class="s">&#39;annot_visual_uuid&#39;</span>
<span class="n">CONFIG_ROWID</span>        <span class="o">=</span> <span class="s">&#39;config_rowid&#39;</span>
<span class="n">FEATWEIGHT_ROWID</span>    <span class="o">=</span> <span class="s">&#39;featweight_rowid&#39;</span>
<span class="n">IMAGE_ROWID</span>         <span class="o">=</span> <span class="s">&#39;image_rowid&#39;</span>
<span class="n">NAME_ROWID</span>          <span class="o">=</span> <span class="s">&#39;name_rowid&#39;</span>
<span class="n">SPECIES_ROWID</span>       <span class="o">=</span> <span class="s">&#39;species_rowid&#39;</span>
<span class="n">ANNOT_EXEMPLAR_FLAG</span> <span class="o">=</span> <span class="s">&#39;annot_exemplar_flag&#39;</span>


<span class="n">tmp</span> <span class="o">=</span> <span class="bp">None</span>


<span class="nd">@register_ibs_method</span>
<span class="nd">@ider</span>
<span class="k">def</span> <span class="nf">_get_all_aids</span><span class="p">(</span><span class="n">ibs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list_ (list):  all unfiltered aids (annotation rowids)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">tmp</span>
    <span class="k">if</span> <span class="n">tmp</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">all_aids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_all_rowids</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">)</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">all_aids</span>
        <span class="k">return</span> <span class="n">all_aids</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">tmp</span>


<span class="nd">@register_ibs_method</span>
<span class="nd">@adder</span>
<div class="viewcode-block" id="add_annots"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.add_annots">[docs]</a><span class="k">def</span> <span class="nf">add_annots</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">gid_list</span><span class="p">,</span> <span class="n">bbox_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">theta_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">species_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">nid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">detect_confidence_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">notes_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">vert_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">annot_uuid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">viewpoint_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">annot_visual_uuid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">annot_semantic_uuid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">species_rowid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">quiet_delete_thumbs</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                <span class="n">prevent_visual_duplicates</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Adds an annotation to images</span>

<span class="sd">    Args:</span>
<span class="sd">        gid_list                 (list): image rowids to add annotation to</span>
<span class="sd">        bbox_list                (list): of [x, y, w, h] bounding boxes for each image (supply verts instead)</span>
<span class="sd">        theta_list               (list): orientations of annotations</span>
<span class="sd">        species_list             (list):</span>
<span class="sd">        nid_list                 (list):</span>
<span class="sd">        name_list                (list):</span>
<span class="sd">        detect_confidence_list   (list):</span>
<span class="sd">        notes_list               (list):</span>
<span class="sd">        vert_list                (list): alternative to bounding box</span>
<span class="sd">        annot_uuid_list          (list):</span>
<span class="sd">        viewpoint_list           (list):</span>
<span class="sd">        annot_visual_uuid_list   (list):</span>
<span class="sd">        annot_semantic_uuid_list (list):</span>
<span class="sd">        quiet_delete_thumbs      (bool):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: aid_list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-add_annots</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-add_annots --verbose --print-caller</span>

<span class="sd">    Ignore:</span>
<span class="sd">       theta_list = None</span>
<span class="sd">       species_list = None</span>
<span class="sd">       nid_list = None</span>
<span class="sd">       name_list = None</span>
<span class="sd">       detect_confidence_list = None</span>
<span class="sd">       notes_list = None</span>
<span class="sd">       vert_list = None</span>
<span class="sd">       annot_uuid_list = None</span>
<span class="sd">       viewpoint_list = None</span>
<span class="sd">       quiet_delete_thumbs = False</span>
<span class="sd">       prevent_visual_duplicates = False</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.IBEISControl import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; prevalid = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; num_add = 2</span>
<span class="sd">        &gt;&gt;&gt; gid_list = ibs.get_valid_gids()[0:num_add]</span>
<span class="sd">        &gt;&gt;&gt; bbox_list = [(int(w * .1), int(h * .6), int(w * .5), int(h *  .3))</span>
<span class="sd">        ...              for (w, h) in ibs.get_image_sizes(gid_list)]</span>
<span class="sd">        &gt;&gt;&gt; # Add a test annotation</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;Testing add_annots&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.add_annots(gid_list, bbox_list=bbox_list)</span>
<span class="sd">        &gt;&gt;&gt; bbox_list2 = ibs.get_annot_bboxes(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; vert_list2 = ibs.get_annot_verts(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; theta_list2 = ibs.get_annot_thetas(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; name_list2 = ibs.get_annot_names(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;Ensure=False. Should get back None chip fpaths&#39;)</span>
<span class="sd">        &gt;&gt;&gt; chip_fpaths2 = ibs.get_annot_chip_fpaths(aid_list, ensure=False)</span>
<span class="sd">        &gt;&gt;&gt; assert [fpath is None for fpath in chip_fpaths2]</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;Ensure=True. Should get back None chip fpaths&#39;)</span>
<span class="sd">        &gt;&gt;&gt; chip_fpaths = ibs.get_annot_chip_fpaths(aid_list, ensure=True)</span>
<span class="sd">        &gt;&gt;&gt; assert all([ut.checkpath(fpath, verbose=True) for fpath in chip_fpaths])</span>
<span class="sd">        &gt;&gt;&gt; assert len(aid_list) == num_add</span>
<span class="sd">        &gt;&gt;&gt; assert len(vert_list2[0]) == 4</span>
<span class="sd">        &gt;&gt;&gt; assert bbox_list2 == bbox_list</span>
<span class="sd">        &gt;&gt;&gt; # Be sure to remove test annotation</span>
<span class="sd">        &gt;&gt;&gt; # if this test fails a resetdbs might be nessary</span>
<span class="sd">        &gt;&gt;&gt; result = &#39;&#39;</span>
<span class="sd">        &gt;&gt;&gt; visual_uuid_list = ibs.get_annot_visual_uuids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; semantic_uuid_list = ibs.get_annot_semantic_uuids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; result += str(visual_uuid_list) + &#39;\n&#39;</span>
<span class="sd">        &gt;&gt;&gt; result += str(semantic_uuid_list) + &#39;\n&#39;</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;Cleaning up. Removing added annotations&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ibs.delete_annots(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; assert not any([ut.checkpath(fpath, verbose=True) for fpath in chip_fpaths])</span>
<span class="sd">        &gt;&gt;&gt; postvalid = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; assert prevalid == postvalid</span>
<span class="sd">        &gt;&gt;&gt; result += str(postvalid)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [UUID(&#39;30f7639b-5161-a561-2c4f-41aed64e5b65&#39;), UUID(&#39;5ccbb26d-104f-e655-cf2b-cf92e0ad2fd2&#39;)]</span>
<span class="sd">        [UUID(&#39;68160c90-4b82-dc96-dafa-b12948739577&#39;), UUID(&#39;03e74d19-1bf7-bc43-a291-8ee06a44da2e&#39;)]</span>
<span class="sd">        [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]</span>

<span class="sd">    Example2:</span>
<span class="sd">        &gt;&gt;&gt; # Test with prevent_visual_duplicates on</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.IBEISControl import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; prevalid = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; num_add = 1</span>
<span class="sd">        &gt;&gt;&gt; gid_list = ibs.get_valid_gids()[0:1] * num_add</span>
<span class="sd">        &gt;&gt;&gt; bbox_list = [(int(w * .1), int(h * .6), int(w * .5), int(h *  .3))</span>
<span class="sd">        ...              for (w, h) in ibs.get_image_sizes(gid_list)]</span>
<span class="sd">        &gt;&gt;&gt; bbox_list2 = [(int(w * .2), int(h * .6), int(w * .5), int(h *  .3))</span>
<span class="sd">        ...              for (w, h) in ibs.get_image_sizes(gid_list)]</span>
<span class="sd">        &gt;&gt;&gt; # Add a test annotation</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;Testing add_annots&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list1 = ibs.add_annots(gid_list, bbox_list=bbox_list, prevent_visual_duplicates=True)</span>
<span class="sd">        &gt;&gt;&gt; aid_list2 = ibs.add_annots(gid_list, bbox_list=bbox_list, prevent_visual_duplicates=True)</span>
<span class="sd">        &gt;&gt;&gt; aid_list3 = ibs.add_annots(gid_list, bbox_list=bbox_list2, prevent_visual_duplicates=True)</span>
<span class="sd">        &gt;&gt;&gt; assert aid_list1 == aid_list2</span>
<span class="sd">        &gt;&gt;&gt; assert aid_list1 != aid_list3</span>
<span class="sd">        &gt;&gt;&gt; aid_list_new = aid_list1 + aid_list3</span>
<span class="sd">        &gt;&gt;&gt; result = aid_list_new</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;Cleaning up. Removing added annotations&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ibs.delete_annots(aid_list_new)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [14, 15]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ibeis.model.preproc</span> <span class="kn">import</span> <span class="n">preproc_annot</span>
    <span class="kn">from</span> <span class="nn">vtool</span> <span class="kn">import</span> <span class="n">geometry</span>
    <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[ibs] adding annotations&#39;</span><span class="p">)</span>
    <span class="c"># Prepare the SQL input</span>
    <span class="k">assert</span> <span class="n">name_list</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">nid_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;cannot specify both names and nids&#39;</span>
    <span class="c"># For import only, we can specify both by setting import_override to True</span>
    <span class="k">assert</span> <span class="nb">bool</span><span class="p">(</span><span class="n">bbox_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">vert_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">),</span> <span class="s">&#39;must specify exactly one of bbox_list or vert_list&#39;</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">assert_all_not_None</span><span class="p">(</span><span class="n">gid_list</span><span class="p">,</span> <span class="s">&#39;gid_list&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">theta_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">theta_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">))]</span>
    <span class="k">if</span> <span class="n">name_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">nid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">add_names</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">nid_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">nid_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ibs</span><span class="o">.</span><span class="n">UNKNOWN_NAME_ROWID</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">))]</span>
        <span class="n">name_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_name_texts</span><span class="p">(</span><span class="n">nid_list</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">species_rowid_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">species_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;cannot mix species_rowid and species&#39;</span>
        <span class="n">species_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_species_texts</span><span class="p">(</span><span class="n">species_rowid_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">species_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">species_rowid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">add_species</span><span class="p">(</span><span class="n">species_list</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">species_rowid_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ibs</span><span class="o">.</span><span class="n">UNKNOWN_SPECIES_ROWID</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">))]</span>
            <span class="n">species_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_species_texts</span><span class="p">(</span><span class="n">species_rowid_list</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">detect_confidence_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">detect_confidence_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">))]</span>
    <span class="k">if</span> <span class="n">notes_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">notes_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;&#39;</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">))]</span>

    <span class="k">if</span> <span class="n">vert_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">vert_list</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">verts_list_from_bboxes_list</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">bbox_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">bbox_list</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">bboxes_from_vert_list</span><span class="p">(</span><span class="n">vert_list</span><span class="p">)</span>

    <span class="n">len_bbox</span>    <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">)</span>
    <span class="n">len_vert</span>    <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vert_list</span><span class="p">)</span>
    <span class="n">len_gid</span>     <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="n">len_notes</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">notes_list</span><span class="p">)</span>
    <span class="n">len_theta</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta_list</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">len_vert</span> <span class="o">==</span> <span class="n">len_bbox</span><span class="p">,</span> <span class="s">&#39;bbox and verts are not of same size&#39;</span>
        <span class="k">assert</span> <span class="n">len_gid</span>  <span class="o">==</span> <span class="n">len_bbox</span><span class="p">,</span> <span class="s">&#39;bbox and gid are not of same size&#39;</span>
        <span class="k">assert</span> <span class="n">len_gid</span>  <span class="o">==</span> <span class="n">len_theta</span><span class="p">,</span> <span class="s">&#39;bbox and gid are not of same size&#39;</span>
        <span class="k">assert</span> <span class="n">len_notes</span> <span class="o">==</span> <span class="n">len_gid</span><span class="p">,</span> <span class="s">&#39;notes and gids are not of same size&#39;</span>
    <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">printex</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="n">key_list</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;len_vert&#39;</span><span class="p">,</span> <span class="s">&#39;len_gid&#39;</span><span class="p">,</span> <span class="s">&#39;len_bbox&#39;</span>
                                    <span class="s">&#39;len_theta&#39;</span><span class="p">,</span> <span class="s">&#39;len_notes&#39;</span><span class="p">])</span>
        <span class="k">raise</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c"># nothing is being added</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[ibs] WARNING: 0 annotations are beign added!&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">ut</span><span class="o">.</span><span class="n">dict_str</span><span class="p">(</span><span class="nb">locals</span><span class="p">()))</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">viewpoint_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">viewpoint_list</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="n">nVert_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">verts</span><span class="p">)</span> <span class="k">for</span> <span class="n">verts</span> <span class="ow">in</span> <span class="n">vert_list</span><span class="p">]</span>
    <span class="n">vertstr_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">const</span><span class="o">.</span><span class="n">__STR__</span><span class="p">(</span><span class="n">verts</span><span class="p">)</span> <span class="k">for</span> <span class="n">verts</span> <span class="ow">in</span> <span class="n">vert_list</span><span class="p">]</span>
    <span class="n">xtl_list</span><span class="p">,</span> <span class="n">ytl_list</span><span class="p">,</span> <span class="n">width_list</span><span class="p">,</span> <span class="n">height_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">bbox_list</span><span class="p">))</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nVert_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">vertstr_list</span><span class="p">)</span>

    <span class="c"># Build ~~deterministic?~~ random and unique ANNOTATION ids</span>
    <span class="n">image_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_uuids</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">annot_uuid_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">annot_uuid_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gid_list</span><span class="p">))]</span>

    <span class="c"># Careful this code is very fragile. It might go out of sync</span>
    <span class="c"># with the updating of the determenistic uuids. Find a way to</span>
    <span class="c"># integrate both pieces of code without too much reundancy.</span>
    <span class="c"># Make sure these tuples are constructed correctly</span>
    <span class="k">if</span> <span class="n">annot_visual_uuid_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">visual_infotup</span> <span class="o">=</span> <span class="p">(</span><span class="n">image_uuid_list</span><span class="p">,</span> <span class="n">vert_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">)</span>
        <span class="n">annot_visual_uuid_list</span> <span class="o">=</span> <span class="n">preproc_annot</span><span class="o">.</span><span class="n">make_annot_visual_uuid</span><span class="p">(</span><span class="n">visual_infotup</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">annot_semantic_uuid_list</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">semantic_infotup</span> <span class="o">=</span> <span class="p">(</span><span class="n">image_uuid_list</span><span class="p">,</span> <span class="n">vert_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">,</span> <span class="n">viewpoint_list</span><span class="p">,</span>
                            <span class="n">name_list</span><span class="p">,</span> <span class="n">species_list</span><span class="p">)</span>
        <span class="n">annot_semantic_uuid_list</span> <span class="o">=</span> <span class="n">preproc_annot</span><span class="o">.</span><span class="n">make_annot_semantic_uuid</span><span class="p">(</span><span class="n">semantic_infotup</span><span class="p">)</span>

    <span class="c"># Define arguments to insert</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;annot_uuid&#39;</span><span class="p">,</span> <span class="s">&#39;image_rowid&#39;</span><span class="p">,</span> <span class="s">&#39;annot_xtl&#39;</span><span class="p">,</span> <span class="s">&#39;annot_ytl&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_width&#39;</span><span class="p">,</span> <span class="s">&#39;annot_height&#39;</span><span class="p">,</span> <span class="s">&#39;annot_theta&#39;</span><span class="p">,</span> <span class="s">&#39;annot_num_verts&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_verts&#39;</span><span class="p">,</span> <span class="s">&#39;annot_viewpoint&#39;</span><span class="p">,</span> <span class="s">&#39;annot_detect_confidence&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_note&#39;</span><span class="p">,</span> <span class="s">&#39;name_rowid&#39;</span><span class="p">,</span> <span class="s">&#39;species_rowid&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_visual_uuid&#39;</span><span class="p">,</span> <span class="s">&#39;annot_semantic_uuid&#39;</span><span class="p">)</span>

    <span class="n">params_iter</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">annot_uuid_list</span><span class="p">,</span> <span class="n">gid_list</span><span class="p">,</span> <span class="n">xtl_list</span><span class="p">,</span> <span class="n">ytl_list</span><span class="p">,</span>
                            <span class="n">width_list</span><span class="p">,</span> <span class="n">height_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">,</span> <span class="n">nVert_list</span><span class="p">,</span>
                            <span class="n">vertstr_list</span><span class="p">,</span> <span class="n">viewpoint_list</span><span class="p">,</span> <span class="n">detect_confidence_list</span><span class="p">,</span>
                            <span class="n">notes_list</span><span class="p">,</span> <span class="n">nid_list</span><span class="p">,</span> <span class="n">species_rowid_list</span><span class="p">,</span>
                           <span class="n">annot_visual_uuid_list</span><span class="p">,</span> <span class="n">annot_semantic_uuid_list</span><span class="p">))</span>

    <span class="c"># Execute add ANNOTATIONs SQL</span>
    <span class="k">if</span> <span class="n">prevent_visual_duplicates</span><span class="p">:</span>
        <span class="n">superkey_paramx</span> <span class="o">=</span> <span class="p">(</span><span class="mi">14</span><span class="p">,)</span>
        <span class="n">get_rowid_from_superkey</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_aids_from_visual_uuid</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">superkey_paramx</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,)</span>
        <span class="n">get_rowid_from_superkey</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_aids_from_uuid</span>
    <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">add_cleanly</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">params_iter</span><span class="p">,</span>
                                  <span class="n">get_rowid_from_superkey</span><span class="p">,</span> <span class="n">superkey_paramx</span><span class="p">)</span>
    <span class="c">#ibs.update_annot_visual_uuids(aid_list)</span>

    <span class="c"># Invalidate image thumbnails, quiet_delete_thumbs causes no output on deletion from ut</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">delete_image_thumbs</span><span class="p">(</span><span class="n">gid_list</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="n">quiet_delete_thumbs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">aid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<div class="viewcode-block" id="get_annot_rows"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_rows">[docs]</a><span class="k">def</span> <span class="nf">get_annot_rows</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;annot_uuid&#39;</span><span class="p">,</span> <span class="s">&#39;image_rowid&#39;</span><span class="p">,</span> <span class="s">&#39;annot_xtl&#39;</span><span class="p">,</span> <span class="s">&#39;annot_ytl&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_width&#39;</span><span class="p">,</span> <span class="s">&#39;annot_height&#39;</span><span class="p">,</span> <span class="s">&#39;annot_theta&#39;</span><span class="p">,</span> <span class="s">&#39;annot_num_verts&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_verts&#39;</span><span class="p">,</span> <span class="s">&#39;annot_viewpoint&#39;</span><span class="p">,</span> <span class="s">&#39;annot_detect_confidence&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_note&#39;</span><span class="p">,</span> <span class="s">&#39;name_rowid&#39;</span><span class="p">,</span> <span class="s">&#39;species_rowid&#39;</span><span class="p">,</span>
                <span class="s">&#39;annot_visual_uuid&#39;</span><span class="p">,</span> <span class="s">&#39;annot_semantic_uuid&#39;</span><span class="p">)</span>
    <span class="n">rows_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">unpack_scalars</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rows_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@deleter</span>
<div class="viewcode-block" id="delete_annot_nids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.delete_annot_nids">[docs]</a><span class="k">def</span> <span class="nf">delete_annot_nids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Deletes nids of a list of annotations &quot;&quot;&quot;</span>
    <span class="c"># FIXME: This should be implicit by setting the anotation name to the</span>
    <span class="c"># unknown name</span>
    <span class="c">#ibs.delete_annot_relations_oftype(aid_list, const.INDIVIDUAL_KEY)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">set_annot_name_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="p">[</span><span class="n">ibs</span><span class="o">.</span><span class="n">UNKNOWN_NAME_ROWID</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_list</span><span class="p">))</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@deleter</span>
<div class="viewcode-block" id="delete_annot_speciesids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.delete_annot_speciesids">[docs]</a><span class="k">def</span> <span class="nf">delete_annot_speciesids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Deletes nids of a list of annotations &quot;&quot;&quot;</span>
    <span class="c"># FIXME: This should be implicit by setting the anotation name to the</span>
    <span class="c"># unknown species</span>
    <span class="c">#ibs.delete_annot_relations_oftype(aid_list, const.SPECIES_KEY)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">set_annot_species_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="p">[</span><span class="n">ibs</span><span class="o">.</span><span class="n">UNKNOWN_SPECIES_ROWID</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_list</span><span class="p">))</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@deleter</span>
<span class="nd">@accessor_decors.cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">)</span>
<div class="viewcode-block" id="delete_annots"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.delete_annots">[docs]</a><span class="k">def</span> <span class="nf">delete_annots</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; deletes annotations from the database &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[ibs] deleting </span><span class="si">%d</span><span class="s"> annotations&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_list</span><span class="p">))</span>
    <span class="c"># Delete chips and features first</span>
    <span class="kn">from</span> <span class="nn">ibeis.model.preproc</span> <span class="kn">import</span> <span class="n">preproc_annot</span>
    <span class="n">preproc_annot</span><span class="o">.</span><span class="n">on_delete</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">delete_rowids</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_aids_from_semantic_uuid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_aids_from_semantic_uuid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_aids_from_semantic_uuid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">semantic_uuid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        semantic_uuid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot rowids</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">aids_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_ROWID</span><span class="p">,),</span>
                           <span class="n">semantic_uuid_list</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="n">ANNOT_SEMANTIC_UUID</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">aids_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_aids_from_uuid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_aids_from_uuid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_aids_from_uuid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">uuid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list_ (list): annot rowids</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># FIXME: MAKE SQL-METHOD FOR NON-ROWID GETTERS</span>
    <span class="n">aids_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_ROWID</span><span class="p">,),</span> <span class="n">uuid_list</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="n">ANNOT_UUID</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">aids_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_aids_from_visual_uuid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_aids_from_visual_uuid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_aids_from_visual_uuid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">visual_uuid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        visual_uuid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot rowids</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">aids_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_ROWID</span><span class="p">,),</span>
                           <span class="n">visual_uuid_list</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="n">ANNOT_VISUAL_UUID</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">aids_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@ut.accepts_numpy</span>
<span class="nd">@getter_1toM</span>
<div class="viewcode-block" id="get_annot_bboxes"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_bboxes">[docs]</a><span class="k">def</span> <span class="nf">get_annot_bboxes</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        bbox_list (list):  annotation bounding boxes in image space</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;annot_xtl&#39;</span><span class="p">,</span> <span class="s">&#39;annot_ytl&#39;</span><span class="p">,</span> <span class="s">&#39;annot_width&#39;</span><span class="p">,</span> <span class="s">&#39;annot_height&#39;</span><span class="p">,)</span>
    <span class="n">bbox_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bbox_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_chip_fpaths"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_chip_fpaths">[docs]</a><span class="k">def</span> <span class="nf">get_annot_chip_fpaths</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the cached chip uri based off of the current</span>
<span class="sd">    configuration.</span>

<span class="sd">    Returns:</span>
<span class="sd">        chip_fpath_list (list): cfpaths defined by ANNOTATIONs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#ut.assert_all_not_None(aid_list, &#39;aid_list&#39;)</span>
    <span class="c">#assert all([aid is not None for aid in aid_list])</span>
    <span class="c">#from ibeis.model.preproc import preproc_chip</span>
    <span class="c">#cfpath_list = preproc_chip.get_annot_cfpath_list(ibs, aid_list)</span>
    <span class="n">cid_list</span>  <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chip_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="n">ensure</span><span class="p">)</span>
    <span class="n">chip_fpath_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_chip_paths</span><span class="p">(</span><span class="n">cid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">chip_fpath_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<span class="nd">@accessor_decors.dev_cache_getter</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="s">&#39;chip_rowid&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="get_annot_chip_rowids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_chip_rowids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_chip_rowids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">all_configs</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                          <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">qreq_</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c"># TODO: DEPRICATE IN FAVOR OF AUTOGENERATED METHOD</span>
    <span class="c"># get_annot_chip_rowids. THEN ALIAS THAT TO THIS</span>
    <span class="c"># FIXME:</span>
    <span class="k">if</span> <span class="n">ensure</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ut</span><span class="o">.</span><span class="n">DEBUG2</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_issubset</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">()),</span> <span class="s">&#39;invalid aids&#39;</span>
            <span class="n">ibs</span><span class="o">.</span><span class="n">add_annot_chips</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">ut</span><span class="o">.</span><span class="n">printex</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="s">&#39;[!ibs.get_annot_chip_rowids]&#39;</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;[!ibs.get_annot_chip_rowids] aid_list = </span><span class="si">%r</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">aid_list</span><span class="p">,))</span>
            <span class="k">raise</span>
    <span class="k">if</span> <span class="n">all_configs</span><span class="p">:</span>
        <span class="c"># FIXME: MAKE SQL-METHOD FOR NON-ROWID GETTERS</span>
        <span class="n">cid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">dbcache</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">CHIP_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;chip_rowid&#39;</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">,</span>
                                   <span class="n">id_colname</span><span class="o">=</span><span class="s">&#39;annot_rowid&#39;</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="n">eager</span><span class="p">,</span>
                                   <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">chip_config_rowid</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_chip_config_rowid</span><span class="p">()</span>
        <span class="c">#print(chip_config_rowid)</span>
        <span class="n">where_clause</span> <span class="o">=</span> <span class="s">&#39;annot_rowid=? AND config_rowid=?&#39;</span>
        <span class="n">params_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,</span> <span class="n">chip_config_rowid</span><span class="p">)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
        <span class="n">cid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">dbcache</span><span class="o">.</span><span class="n">get_where</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">CHIP_TABLE</span><span class="p">,</span>  <span class="p">(</span><span class="s">&#39;chip_rowid&#39;</span><span class="p">,),</span>
                                         <span class="n">params_iter</span><span class="p">,</span> <span class="n">where_clause</span><span class="p">,</span>
                                         <span class="n">eager</span><span class="o">=</span><span class="n">eager</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ensure</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cid_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cid_list</span><span class="p">)</span>
            <span class="n">ut</span><span class="o">.</span><span class="n">assert_all_not_None</span><span class="p">(</span><span class="n">cid_list</span><span class="p">,</span> <span class="s">&#39;cid_list&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="n">valid_cids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_cids</span><span class="p">()</span>  <span class="c"># NOQA</span>
            <span class="n">ut</span><span class="o">.</span><span class="n">printex</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="s">&#39;Ensured cids returned None!&#39;</span><span class="p">,</span>
                          <span class="n">key_list</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;aid_list&#39;</span><span class="p">,</span> <span class="s">&#39;cid_list&#39;</span><span class="p">,</span> <span class="s">&#39;valid_cids&#39;</span><span class="p">])</span>
            <span class="k">raise</span>
    <span class="k">return</span> <span class="n">cid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_chip_thumbpath"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_chip_thumbpath">[docs]</a><span class="k">def</span> <span class="nf">get_annot_chip_thumbpath</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">thumbsize</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    just constructs the path. does not compute it. that is done by</span>
<span class="sd">    api_thumb_delegate</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">thumbsize</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">thumbsize</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">other_cfg</span><span class="o">.</span><span class="n">thumb_size</span>
    <span class="n">thumb_dpath</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">thumb_dpath</span>
    <span class="n">thumb_suffix</span> <span class="o">=</span> <span class="s">&#39;_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">thumbsize</span><span class="p">)</span> <span class="o">+</span> <span class="n">const</span><span class="o">.</span><span class="n">CHIP_THUMB_SUFFIX</span>
    <span class="n">annot_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_visual_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">thumbpath_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">join</span><span class="p">(</span><span class="n">thumb_dpath</span><span class="p">,</span> <span class="n">const</span><span class="o">.</span><span class="n">__STR__</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span> <span class="o">+</span> <span class="n">thumb_suffix</span><span class="p">)</span>
                      <span class="k">for</span> <span class="n">uuid</span> <span class="ow">in</span> <span class="n">annot_uuid_list</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">thumbpath_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_chip_thumbtup"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_chip_thumbtup">[docs]</a><span class="k">def</span> <span class="nf">get_annot_chip_thumbtup</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">thumbsize</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; get chip thumb info</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list  (list):</span>
<span class="sd">        thumbsize (int):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: thumbtup_list - [(thumb_path, img_path, imgsize, bboxes, thetas)]</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_chip_thumbtup</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; thumbsize = 128</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_chip_thumbtup(ibs, aid_list, thumbsize)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#import numpy as np</span>
    <span class="c">#isiterable = isinstance(aid_list, (list, tuple, np.ndarray))</span>
    <span class="c">#if not isiterable:</span>
    <span class="c">#   aid_list = [aid_list]</span>
    <span class="c"># HACK TO MAKE CHIPS COMPUTE</span>
    <span class="c">#cid_list = ibs.get_annot_chip_rowids(aid_list, ensure=True)  # NOQA</span>
    <span class="c">#thumbsize = 256</span>
    <span class="k">if</span> <span class="n">thumbsize</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">thumbsize</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">other_cfg</span><span class="o">.</span><span class="n">thumb_size</span>
    <span class="n">thumb_gpaths</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chip_thumbpath</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">thumbsize</span><span class="o">=</span><span class="n">thumbsize</span><span class="p">)</span>
    <span class="c">#print(thumb_gpaths)</span>
    <span class="n">chip_paths</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chip_fpaths</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">chipsize_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chipsizes</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">thumbtup_list</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">thumb_path</span><span class="p">,</span> <span class="n">chip_path</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">thumb_path</span><span class="p">,</span> <span class="n">chip_path</span><span class="p">,</span> <span class="n">chipsize</span><span class="p">)</span> <span class="ow">in</span>
        <span class="nb">zip</span><span class="p">(</span><span class="n">thumb_gpaths</span><span class="p">,</span> <span class="n">chip_paths</span><span class="p">,</span> <span class="n">chipsize_list</span><span class="p">,)</span>
    <span class="p">]</span>
    <span class="c">#if not isiterable:</span>
    <span class="c">#    return thumbtup_list[0]</span>
    <span class="k">return</span> <span class="n">thumbtup_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_chips"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_chips">[docs]</a><span class="k">def</span> <span class="nf">get_annot_chips</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">assert_all_not_None</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="s">&#39;aid_list&#39;</span><span class="p">)</span>
    <span class="n">cid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chip_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="n">ensure</span><span class="p">)</span>
    <span class="n">chip_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_chips</span><span class="p">(</span><span class="n">cid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="n">ensure</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">chip_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<span class="c">#@cache_getter(const.ANNOTATION_TABLE, &#39;chipsizes&#39;)</span>
<div class="viewcode-block" id="get_annot_chipsizes"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_chipsizes">[docs]</a><span class="k">def</span> <span class="nf">get_annot_chipsizes</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        chipsz_list (list): the imagesizes of computed annotation chips</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cid_list</span>  <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chip_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="n">ensure</span><span class="p">)</span>
    <span class="n">chipsz_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_chip_sizes</span><span class="p">(</span><span class="n">cid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">chipsz_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<div class="viewcode-block" id="get_annot_class_labels"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_class_labels">[docs]</a><span class="k">def</span> <span class="nf">get_annot_class_labels</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list of tuples: identifying animal name and viewpoint</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">name_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">view_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">name_list</span><span class="p">]</span>
    <span class="n">classlabel_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span> <span class="n">view_list</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">classlabel_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_detect_confidence"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_detect_confidence">[docs]</a><span class="k">def</span> <span class="nf">get_annot_detect_confidence</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list_ (list): a list confidences that the annotations is a valid detection</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annot_detect_confidence_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;annot_detect_confidence&#39;</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_detect_confidence_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_exemplar_flags"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_exemplar_flags">[docs]</a><span class="k">def</span> <span class="nf">get_annot_exemplar_flags</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="n">annot_exemplar_flag_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;annot_exemplar_flag&#39;</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_exemplar_flag_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_feat_rowids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_feat_rowids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_feat_rowids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">qreq_</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">cid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_chip_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="n">ensure</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="n">eager</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="n">fid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_chip_fids</span><span class="p">(</span><span class="n">cid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="n">ensure</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="n">eager</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@ut.accepts_numpy</span>
<span class="nd">@getter_1to1</span>
<span class="c">#@cache_getter(const.ANNOTATION_TABLE, &#39;image_rowid&#39;)</span>
<div class="viewcode-block" id="get_annot_gids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_gids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_gids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        gid_list (list):  image rowids</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_gids(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;image_rowid&#39;</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1toM</span>
<div class="viewcode-block" id="get_annot_contact_aids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_contact_aids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_contact_aids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the other aids that appear in the same image that this</span>
<span class="sd">    annotation is from.</span>

<span class="sd">    Args:</span>
<span class="sd">        ibs (IBEISController):  ibeis controller object</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_contact_aids</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; contact_aids = ibs.get_annot_contact_aids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; contact_gids = ibs.unflat_map(ibs.get_annot_gids, contact_aids)</span>
<span class="sd">        &gt;&gt;&gt; gid_list = ibs.get_annot_gids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; for gids, gid, aids, aid in zip(contact_gids, gid_list, contact_aids, aid_list):</span>
<span class="sd">        ...     assert ut.list_allsame(gids), &#39;annots should be from same image&#39;</span>
<span class="sd">        ...     assert len(gids) == 0 or gids[0] == gid, &#39;and same image as parent annot&#39;</span>
<span class="sd">        ...     assert aid not in aids, &#39;should not include self&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">other_aids_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_aids</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="c"># remove self</span>
    <span class="n">contact_aids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">aids</span><span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="n">aid</span><span class="p">})</span>
                    <span class="k">for</span> <span class="n">aids</span><span class="p">,</span> <span class="n">aid</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">other_aids_list</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">contact_aids</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_num_contact_aids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_num_contact_aids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_num_contact_aids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="n">nOther_aids_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_contact_aids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">nOther_aids_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1toM</span>
<div class="viewcode-block" id="get_annot_groundfalse"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_groundfalse">[docs]</a><span class="k">def</span> <span class="nf">get_annot_groundfalse</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">is_exemplar</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">valid_aids</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                          <span class="n">filter_unknowns</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">daid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    gets all annotations with different names</span>

<span class="sd">    Returns:</span>
<span class="sd">        groundfalse_list (list): a list of aids which are known to be different for each</span>

<span class="sd">    input aid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">valid_aids</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c"># get all valid aids if not specified</span>
        <span class="c"># really the examplar flag should not be allowed and only daids</span>
        <span class="c"># should be taken as input</span>
        <span class="n">valid_aids</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="n">is_exemplar</span><span class="o">=</span><span class="n">is_exemplar</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">daid_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">valid_aids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">daid_list</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">valid_aids</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">filter_unknowns</span><span class="p">:</span>
        <span class="c"># Remove aids which do not have a name</span>
        <span class="n">isunknown_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">is_aid_unknown</span><span class="p">(</span><span class="n">valid_aids</span><span class="p">)</span>
        <span class="n">valid_aids_</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">filterfalse_items</span><span class="p">(</span><span class="n">valid_aids</span><span class="p">,</span> <span class="n">isunknown_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">valid_aids_</span> <span class="o">=</span> <span class="n">valid_aids</span>
    <span class="c"># Build the set of groundfalse annotations</span>
    <span class="n">nid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">aids_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_name_aids</span><span class="p">(</span><span class="n">nid_list</span><span class="p">,</span> <span class="n">enable_unknown_fix</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">aids_setlist</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="n">aids_list</span><span class="p">)</span>
    <span class="n">valid_aids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">valid_aids_</span><span class="p">)</span>
    <span class="n">groundfalse_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">valid_aids</span> <span class="o">-</span> <span class="n">aids</span><span class="p">)</span> <span class="k">for</span> <span class="n">aids</span> <span class="ow">in</span> <span class="n">aids_setlist</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">groundfalse_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1toM</span>
<div class="viewcode-block" id="get_annot_groundtruth"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_groundtruth">[docs]</a><span class="k">def</span> <span class="nf">get_annot_groundtruth</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">is_exemplar</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">noself</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                          <span class="n">daid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    gets all annotations with the same names</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list    (list): list of annotation rowids to get groundtruth of</span>
<span class="sd">        is_exemplar (None):</span>
<span class="sd">        noself      (bool):</span>
<span class="sd">        daid_list   (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        groundtruth_list (list): a list of aids with the same name foreach</span>
<span class="sd">        aid in aid_list.  a set of aids belonging to the same name is called</span>
<span class="sd">        a groundtruth.  A list of these is called a groundtruth_list.</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_groundtruth:0</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_groundtruth:1</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_groundtruth:2</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; is_exemplar, noself, daid_list = None, True, None</span>
<span class="sd">        &gt;&gt;&gt; groundtruth_list = ibs.get_annot_groundtruth(aid_list, is_exemplar, noself, daid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = str(groundtruth_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[], [3], [2], [], [6], [5], [], [], [], [], [], [], []]</span>

<span class="sd">    Example1:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; is_exemplar, noself, daid_list = True, True, None</span>
<span class="sd">        &gt;&gt;&gt; groundtruth_list = ibs.get_annot_groundtruth(aid_list, is_exemplar, noself, daid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = str(groundtruth_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[], [3], [2], [], [6], [5], [], [], [], [], [], [], []]</span>

<span class="sd">    Example2:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; is_exemplar, noself, daid_list = False, False, None</span>
<span class="sd">        &gt;&gt;&gt; groundtruth_list = ibs.get_annot_groundtruth(aid_list, is_exemplar, noself, daid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = str(groundtruth_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [[1], [], [], [4], [], [], [], [], [9], [], [11], [], []]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO: Optimize</span>
    <span class="n">nid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">aids_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_name_aids</span><span class="p">(</span><span class="n">nid_list</span><span class="p">,</span> <span class="n">enable_unknown_fix</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_exemplar</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">groundtruth_list_</span> <span class="o">=</span> <span class="n">aids_list</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c"># Filter out non-exemplars</span>
        <span class="n">exemplar_flags_list</span> <span class="o">=</span> <span class="n">ibsfuncs</span><span class="o">.</span><span class="n">unflat_map</span><span class="p">(</span><span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_exemplar_flags</span><span class="p">,</span> <span class="n">aids_list</span><span class="p">)</span>
        <span class="n">isvalids_list</span> <span class="o">=</span> <span class="p">[[</span><span class="n">flag</span> <span class="o">==</span> <span class="n">is_exemplar</span> <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">]</span> <span class="k">for</span> <span class="n">flags</span> <span class="ow">in</span> <span class="n">exemplar_flags_list</span><span class="p">]</span>
        <span class="n">groundtruth_list_</span> <span class="o">=</span> <span class="p">[</span><span class="n">ut</span><span class="o">.</span><span class="n">filter_items</span><span class="p">(</span><span class="n">aids</span><span class="p">,</span> <span class="n">isvalids</span><span class="p">)</span>
                             <span class="k">for</span> <span class="n">aids</span><span class="p">,</span> <span class="n">isvalids</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">aids_list</span><span class="p">,</span> <span class="n">isvalids_list</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">noself</span><span class="p">:</span>
        <span class="c"># Remove yourself from the set</span>
        <span class="n">groundtruth_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">aids</span><span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="n">aid</span><span class="p">})</span>
                            <span class="k">for</span> <span class="n">aids</span><span class="p">,</span> <span class="n">aid</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">groundtruth_list_</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">groundtruth_list</span> <span class="o">=</span> <span class="n">groundtruth_list_</span>

    <span class="k">if</span> <span class="n">daid_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c"># filter out any groundtruth that isn&#39;t allowed</span>
        <span class="n">daid_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">daid_list</span><span class="p">)</span>
        <span class="n">groundtruth_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">daid_set</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">aids</span><span class="p">)))</span> <span class="k">for</span> <span class="n">aids</span> <span class="ow">in</span> <span class="n">groundtruth_list</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">groundtruth_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_has_groundtruth"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_has_groundtruth">[docs]</a><span class="k">def</span> <span class="nf">get_annot_has_groundtruth</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">is_exemplar</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">noself</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">daid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list    (list):</span>
<span class="sd">        is_exemplar (None):</span>
<span class="sd">        noself      (bool):</span>
<span class="sd">        daid_list   (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: has_gt_list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_has_groundtruth</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; is_exemplar = None</span>
<span class="sd">        &gt;&gt;&gt; noself = True</span>
<span class="sd">        &gt;&gt;&gt; daid_list = None</span>
<span class="sd">        &gt;&gt;&gt; has_gt_list = get_annot_has_groundtruth(ibs, aid_list, is_exemplar, noself, daid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = str(has_gt_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO: Optimize</span>
    <span class="n">numgts_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_num_groundtruth</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">is_exemplar</span><span class="o">=</span><span class="n">is_exemplar</span><span class="p">,</span>
                                                <span class="n">noself</span><span class="o">=</span><span class="n">noself</span><span class="p">,</span>
                                                <span class="n">daid_list</span><span class="o">=</span><span class="n">daid_list</span><span class="p">)</span>

    <span class="n">has_gt_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">num_gts</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">num_gts</span> <span class="ow">in</span> <span class="n">numgts_list</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">has_gt_list</span>


<span class="c">#@register_ibs_method</span>
<span class="c">#def get_annot_hashid_rowid(ibs, aid_list, prefix=&#39;&#39;):</span>
<span class="c">#    raise AssertionError(&#39;You probably want to call a uuid hash id method&#39;)</span>
<span class="c">#    label = &#39;&#39;.join((&#39;_&#39;, prefix, &#39;UUIDS&#39;))</span>
<span class="c">#    aids_hashid = ut.hashstr_arr(aid_list, label)</span>
<span class="c">#    return aids_hashid</span>

</div>
<span class="nd">@register_ibs_method</span>
<div class="viewcode-block" id="get_annot_hashid_uuid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_hashid_uuid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_hashid_uuid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
    <span class="n">uuid_list</span>    <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s">&#39;_&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="s">&#39;UUIDS&#39;</span><span class="p">))</span>
    <span class="n">uuid_hashid</span>  <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr_arr</span><span class="p">(</span><span class="n">uuid_list</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">uuid_hashid</span>

</div>
<span class="nd">@register_ibs_method</span>
<div class="viewcode-block" id="get_annot_hashid_visual_uuid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_hashid_visual_uuid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_hashid_visual_uuid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
    <span class="n">visual_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_visual_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s">&#39;_&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="s">&#39;VUUIDS&#39;</span><span class="p">))</span>
    <span class="n">visual_uuid_hashid</span>  <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr_arr</span><span class="p">(</span><span class="n">visual_uuid_list</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">visual_uuid_hashid</span>

</div>
<span class="nd">@register_ibs_method</span>
<div class="viewcode-block" id="get_annot_hashid_semantic_uuid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_hashid_semantic_uuid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_hashid_semantic_uuid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
    <span class="n">semantic_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_semantic_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">label</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s">&#39;_&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="s">&#39;SUUIDS&#39;</span><span class="p">))</span>
    <span class="n">semantic_uuid_hashid</span>  <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">hashstr_arr</span><span class="p">(</span><span class="n">semantic_uuid_list</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">semantic_uuid_hashid</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_image_names"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_image_names">[docs]</a><span class="k">def</span> <span class="nf">get_annot_image_names</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of strs: gname_list the image names of each annotation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">gname_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_gnames</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gname_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_image_unixtimes"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_image_unixtimes">[docs]</a><span class="k">def</span> <span class="nf">get_annot_image_unixtimes</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: unixtime_list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">unixtime_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_unixtime</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">unixtime_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_image_paths"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_image_paths">[docs]</a><span class="k">def</span> <span class="nf">get_annot_image_paths</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of strs: gpath_list the image paths of each annotation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ut</span><span class="o">.</span><span class="n">assert_all_not_None</span><span class="p">(</span><span class="n">gid_list</span><span class="p">,</span> <span class="s">&#39;gid_list&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[!get_annot_image_paths] &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_dbgstr</span><span class="p">(</span><span class="s">&#39;aid_list&#39;</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;[!get_annot_image_paths] &#39;</span> <span class="o">+</span> <span class="n">ut</span><span class="o">.</span><span class="n">list_dbgstr</span><span class="p">(</span><span class="s">&#39;gid_list&#39;</span><span class="p">))</span>
        <span class="k">raise</span>
    <span class="n">gpath_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_paths</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">assert_all_not_None</span><span class="p">(</span><span class="n">gpath_list</span><span class="p">,</span> <span class="s">&#39;gpath_list&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gpath_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_image_uuids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_image_uuids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_image_uuids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: image_uuid_list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_image_uuids --enableall</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[0:1]</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_image_uuids(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [UUID(&#39;66ec193a-1619-b3b6-216d-1784b4833b61&#39;)]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">assert_all_not_None</span><span class="p">(</span><span class="n">gid_list</span><span class="p">,</span> <span class="s">&#39;gid_list&#39;</span><span class="p">)</span>
    <span class="n">image_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_image_uuids</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">image_uuid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_images"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_images">[docs]</a><span class="k">def</span> <span class="nf">get_annot_images</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list of ndarrays: the images of each annotation</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_images</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[0:1]</span>
<span class="sd">        &gt;&gt;&gt; image_list = ibs.get_annot_images(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = str(map(np.shape, image_list))</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [(715, 1047, 3)]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">gid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">image_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_images</span><span class="p">(</span><span class="n">gid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">image_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@ut.accepts_numpy</span>
<span class="nd">@getter_1toM</span>
<span class="c">#@cache_getter(const.ANNOTATION_TABLE, &#39;kpts&#39;)</span>
<div class="viewcode-block" id="get_annot_kpts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_kpts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_kpts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        kpts_list (list): annotation descriptor keypoints</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fid_list</span>  <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_feat_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="n">ensure</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="n">eager</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="n">kpts_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_feat_kpts</span><span class="p">(</span><span class="n">fid_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="n">eager</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">kpts_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@ut.accepts_numpy</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_name_rowids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_name_rowids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_name_rowids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">distinguish_unknowns</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list_ (list): the name id of each annotation.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.IBEISControl import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; distinguish_unknowns = True</span>
<span class="sd">        &gt;&gt;&gt; nid_arr1 = np.array(ibs.get_annot_name_rowids(aid_list, distinguish_unknowns))</span>
<span class="sd">        &gt;&gt;&gt; nid_arr2 = np.array(ibs.get_annot_name_rowids(aid_list, False))</span>
<span class="sd">        &gt;&gt;&gt; assert ibs.UNKNOWN_LBLANNOT_ROWID == 0</span>
<span class="sd">        &gt;&gt;&gt; assert np.all(nid_arr1[np.where(ibs.UNKNOWN_LBLANNOT_ROWID == nid_arr2)[0]] &lt; 0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">NAME_ROWID</span><span class="p">,)</span>
    <span class="n">nid_list_</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="s">&#39;rowid&#39;</span><span class="p">)</span>

    <span class="c">## OLD LBLANNOT WAY</span>
    <span class="c">## Get all the annotation lblannot relationships</span>
    <span class="c">## filter out only the ones which specify names</span>
    <span class="c">#alrids_list = ibs.get_annot_alrids_oftype(aid_list, ibs.lbltype_ids[const.INDIVIDUAL_KEY])</span>
    <span class="c">#lblannot_rowids_list = ibsfuncs.unflat_map(ibs.get_alr_lblannot_rowids, alrids_list)</span>
    <span class="c">## Get a single nid from the list of lblannot_rowids of type INDIVIDUAL</span>
    <span class="c">## TODO: get index of highest confidence name</span>
    <span class="c">#nid_list_ = [lblannot_rowids[0] if len(lblannot_rowids) &gt; 0 else ibs.UNKNOWN_LBLANNOT_ROWID for</span>
    <span class="c">#             lblannot_rowids in lblannot_rowids_list]</span>

    <span class="k">if</span> <span class="n">distinguish_unknowns</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">ibeis.model.preproc</span> <span class="kn">import</span> <span class="n">preproc_annot</span>
        <span class="n">nid_list</span> <span class="o">=</span> <span class="n">preproc_annot</span><span class="o">.</span><span class="n">distinguish_unknown_nids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">nid_list_</span><span class="p">)</span>
        <span class="c">#nid_list = [-aid if nid == ibs.UNKNOWN_LBLANNOT_ROWID else nid</span>
        <span class="c">#            for nid, aid in zip(nid_list_, aid_list)]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nid_list</span> <span class="o">=</span> <span class="n">nid_list_</span>
    <span class="k">return</span> <span class="n">nid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<div class="viewcode-block" id="get_annot_nids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_nids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_nids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">distinguish_unknowns</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; alias &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">distinguish_unknowns</span><span class="o">=</span><span class="n">distinguish_unknowns</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_names"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_names">[docs]</a><span class="k">def</span> <span class="nf">get_annot_names</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; alias &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_texts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_name_texts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_name_texts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_name_texts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list or strs: name_list. e.g: [&#39;fred&#39;, &#39;sue&#39;, ...]</span>
<span class="sd">             for each annotation identifying the individual</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[::2]</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_name_texts(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [&#39;____&#39;, u&#39;easy&#39;, u&#39;hard&#39;, u&#39;jeff&#39;, &#39;____&#39;, &#39;____&#39;, u&#39;zebra&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_name_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">name_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_name_texts</span><span class="p">(</span><span class="n">nid_list</span><span class="p">)</span>
    <span class="c">#name_list = ibs.get_annot_lblannot_value_of_lbltype(aid_list, const.INDIVIDUAL_KEY, ibs.get_name_texts)</span>
    <span class="k">return</span> <span class="n">name_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_notes"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_notes">[docs]</a><span class="k">def</span> <span class="nf">get_annot_notes</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        annotation_notes_list (list): a list of annotation notes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annotation_notes_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_NOTE</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annotation_notes_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_num_feats"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_num_feats">[docs]</a><span class="k">def</span> <span class="nf">get_annot_num_feats</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        nFeats_list (list): num descriptors per annotation</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_num_feats</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; # this test might fail on different machines due to</span>
<span class="sd">        &gt;&gt;&gt; # determenism bugs in hesaff maybe? or maybe jpeg...</span>
<span class="sd">        &gt;&gt;&gt; # in which case its hopeless</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[0:3]</span>
<span class="sd">        &gt;&gt;&gt; nFeats_list = get_annot_num_feats(ibs, aid_list, ensure=True)</span>
<span class="sd">        &gt;&gt;&gt; assert len(nFeats_list) == 3</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_inbounds(nFeats_list[0], 1256, 1258)</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_inbounds(nFeats_list[1],  910,  921)</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_inbounds(nFeats_list[2], 1340, 1343)</span>

<span class="sd">    [1257, 920, 1342]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_feat_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="n">ensure</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="n">nFeats_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_num_feats</span><span class="p">(</span><span class="n">fid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nFeats_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_num_groundtruth"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_num_groundtruth">[docs]</a><span class="k">def</span> <span class="nf">get_annot_num_groundtruth</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">is_exemplar</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">noself</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                              <span class="n">daid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list_ (list): number of other chips with the same name</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_num_groundtruth</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_num_groundtruth:0</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_num_groundtruth:1</span>

<span class="sd">    Example1:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; noself = True</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_num_groundtruth(ibs, aid_list, noself=noself)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0]</span>

<span class="sd">    Example2:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; noself = False</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_num_groundtruth(ibs, aid_list, noself=noself)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [1, 2, 2, 1, 2, 2, 1, 1, 1, 1, 1, 1, 1]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># TODO: Optimize</span>
    <span class="n">groundtruth_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_groundtruth</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span>
                                                 <span class="n">is_exemplar</span><span class="o">=</span><span class="n">is_exemplar</span><span class="p">,</span>
                                                 <span class="n">noself</span><span class="o">=</span><span class="n">noself</span><span class="p">,</span>
                                                 <span class="n">daid_list</span><span class="o">=</span><span class="n">daid_list</span><span class="p">)</span>
    <span class="n">nGt_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">groundtruth_list</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">nGt_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_num_verts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_num_verts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_num_verts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        nVerts_list (list): the number of vertices that form the polygon of each chip</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nVerts_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_NUM_VERTS</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nVerts_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_parent_aid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_parent_aid">[docs]</a><span class="k">def</span> <span class="nf">get_annot_parent_aid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list_ (list): a list of parent (in terms of parts) annotation rowids.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annot_parent_rowid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_PARENT_ROWID</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_parent_rowid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_probchip_fpaths"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_probchip_fpaths">[docs]</a><span class="k">def</span> <span class="nf">get_annot_probchip_fpaths</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns paths to probability images.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># FIXME: this is implemented very poorly. Caches not robust. IE they are</span>
    <span class="c"># never invalidated. Not all config information is passed through</span>
    <span class="kn">from</span> <span class="nn">ibeis.model.preproc</span> <span class="kn">import</span> <span class="n">preproc_probchip</span>
    <span class="n">probchip_fpath_list</span> <span class="o">=</span> <span class="n">preproc_probchip</span><span class="o">.</span><span class="n">compute_and_write_probchip</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">probchip_fpath_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_species"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_species">[docs]</a><span class="k">def</span> <span class="nf">get_annot_species</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; alias&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_species_texts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_species_texts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_species_texts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_species_texts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list : species_list - a list of strings [&#39;plains_zebra&#39;,</span>
<span class="sd">        &#39;grevys_zebra&#39;, ...] for each annotation</span>
<span class="sd">        identifying the species</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_species_texts</span>

<span class="sd">    Example1:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[1::3]</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_species_texts(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [u&#39;zebra_plains&#39;, u&#39;zebra_plains&#39;, &#39;____&#39;, u&#39;bear_polar&#39;]</span>

<span class="sd">    Example2:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;PZ_MTEST&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; species_list = get_annot_species_texts(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = set(species_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        set([u&#39;zebra_plains&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">species_rowid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_species_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">speceis_text_list</span>  <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_species_texts</span><span class="p">(</span><span class="n">species_rowid_list</span><span class="p">)</span>
    <span class="c">#speceis_text_list = ibs.get_annot_lblannot_value_of_lbltype(</span>
    <span class="c">#    aid_list, const.SPECIES_KEY, ibs.get_species)</span>
    <span class="k">return</span> <span class="n">speceis_text_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@ut.accepts_numpy</span>
<span class="nd">@getter_1to1</span>
<span class="nd">@accessor_decors.dev_cache_getter</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">SPECIES_ROWID</span><span class="p">,</span> <span class="n">native_rowids</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<div class="viewcode-block" id="get_annot_species_rowids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_species_rowids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_species_rowids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    species_rowid_list &lt;- annot.species_rowid[aid_list]</span>

<span class="sd">    gets data from the &quot;native&quot; column &quot;species_rowid&quot; in the &quot;annot&quot; table</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: species_rowid_list</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">SPECIES_ROWID</span><span class="p">,)</span>
    <span class="n">species_rowid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="s">&#39;rowid&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">species_rowid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_thetas"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_thetas">[docs]</a><span class="k">def</span> <span class="nf">get_annot_thetas</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        theta_list (list): a list of floats describing the angles of each chip</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_thetas</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;NAUT_test&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_thetas(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [2.75742, 0.792917, 2.53605, 2.67795, 0.946773, 2.56729]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">theta_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;annot_theta&#39;</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">theta_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_uuids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_uuids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_uuids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        list: annot_uuid_list a list of image uuids by aid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">annot_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;annot_uuid&#39;</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_uuid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<span class="nd">@accessor_decors.dev_cache_getter</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">ANNOT_SEMANTIC_UUID</span><span class="p">)</span>
<div class="viewcode-block" id="get_annot_semantic_uuids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_semantic_uuids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_semantic_uuids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; annot_semantic_uuid_list &lt;- annot.annot_semantic_uuid[aid_list]</span>

<span class="sd">    gets data from the &quot;native&quot; column &quot;annot_semantic_uuid&quot; in the &quot;annot&quot; table</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot_semantic_uuid_list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_semantic_uuids</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control._autogen_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; ibs, qreq_ = get_autogen_testdata()</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs._get_all_aids()[0:1]</span>
<span class="sd">        &gt;&gt;&gt; annot_semantic_uuid_list = ibs.get_annot_semantic_uuids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; assert len(aid_list) == len(annot_semantic_uuid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = annot_semantic_uuid_list</span>
<span class="sd">        [UUID(&#39;215ab5f9-fe53-d7d1-59b8-d6b5ce7e6ca6&#39;)]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_SEMANTIC_UUID</span><span class="p">,)</span>
    <span class="n">annot_semantic_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="s">&#39;rowid&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_semantic_uuid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<span class="nd">@accessor_decors.dev_cache_getter</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">ANNOT_VISUAL_UUID</span><span class="p">,</span> <span class="n">native_rowids</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<div class="viewcode-block" id="get_annot_visual_uuids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_visual_uuids">[docs]</a><span class="k">def</span> <span class="nf">get_annot_visual_uuids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; annot_visual_uuid_list &lt;- annot.annot_visual_uuid[aid_list]</span>

<span class="sd">    gets data from the &quot;native&quot; column &quot;annot_visual_uuid&quot; in the &quot;annot&quot; table</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: annot_visual_uuid_list</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_visual_uuids</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control._autogen_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; ibs, qreq_ = get_autogen_testdata()</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs._get_all_aids()[0:1]</span>
<span class="sd">        &gt;&gt;&gt; annot_visual_uuid_list = ibs.get_annot_visual_uuids(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; assert len(aid_list) == len(annot_visual_uuid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = annot_visual_uuid_list</span>
<span class="sd">        [UUID(&#39;8687dcb6-1f1f-fdd3-8b72-8f36f9f41905&#39;)]</span>

<span class="sd">        [UUID(&#39;76de0416-7c92-e1b3-4a17-25df32e9c2b4&#39;)]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_VISUAL_UUID</span><span class="p">,)</span>
    <span class="n">annot_visual_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">,</span> <span class="n">id_colname</span><span class="o">=</span><span class="s">&#39;rowid&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annot_visual_uuid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1toM</span>
<div class="viewcode-block" id="get_annot_vecs"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_vecs">[docs]</a><span class="k">def</span> <span class="nf">get_annot_vecs</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        vecs_list (list): annotation descriptor vectors</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fid_list</span>  <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_feat_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">ensure</span><span class="o">=</span><span class="n">ensure</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="n">eager</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="n">vecs_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_feat_vecs</span><span class="p">(</span><span class="n">fid_list</span><span class="p">,</span> <span class="n">eager</span><span class="o">=</span><span class="n">eager</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">vecs_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_verts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_verts">[docs]</a><span class="k">def</span> <span class="nf">get_annot_verts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        vert_list (list): the vertices that form the polygon of each chip</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ibeis.model.preproc</span> <span class="kn">import</span> <span class="n">preproc_annot</span>
    <span class="n">vertstr_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;annot_verts&#39;</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">vert_list</span> <span class="o">=</span> <span class="n">preproc_annot</span><span class="o">.</span><span class="n">postget_annot_verts</span><span class="p">(</span><span class="n">vertstr_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">vert_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@getter_1to1</span>
<div class="viewcode-block" id="get_annot_viewpoints"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_viewpoints">[docs]</a><span class="k">def</span> <span class="nf">get_annot_viewpoints</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        viewpoint_list (list): the viewpoint (in radians) for the annotation</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_viewpoints</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[::3]</span>
<span class="sd">        &gt;&gt;&gt; result = get_annot_viewpoints(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [None, None, None, None, None]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#from ibeis.model.preproc import preproc_annot</span>
    <span class="n">viewpoint_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;annot_viewpoint&#39;</span><span class="p">,),</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">viewpoint_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">viewpoint</span> <span class="k">if</span> <span class="n">viewpoint</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="k">else</span> <span class="bp">None</span> <span class="k">for</span> <span class="n">viewpoint</span> <span class="ow">in</span> <span class="n">viewpoint_list</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">viewpoint_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<div class="viewcode-block" id="get_num_annotations"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_num_annotations">[docs]</a><span class="k">def</span> <span class="nf">get_num_annotations</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Number of valid annotations &quot;&quot;&quot;</span>
    <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_valid_aids</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@ider</span>
<div class="viewcode-block" id="get_valid_aids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_valid_aids">[docs]</a><span class="k">def</span> <span class="nf">get_valid_aids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">eid</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">include_only_gid_list</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">viewpoint</span><span class="o">=</span><span class="s">&#39;no-filter&#39;</span><span class="p">,</span> <span class="n">is_exemplar</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">species</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">is_known</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Note: The viewpoint value cannot be None as a default because None is used as a</span>
<span class="sd">          filtering value</span>

<span class="sd">    Args:</span>
<span class="sd">        ibs (IBEISController):  ibeis controller object</span>
<span class="sd">        eid (None):</span>
<span class="sd">        include_only_gid_list (list):</span>
<span class="sd">        viewpoint (str):</span>
<span class="sd">        is_exemplar (None):</span>
<span class="sd">        species (None):</span>
<span class="sd">        is_known (None):</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: aid_list - a list of valid ANNOTATION unique ids</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_valid_aids</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; from ibeis import constants as const</span>
<span class="sd">        &gt;&gt;&gt; # build test data</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; eid = 1</span>
<span class="sd">        &gt;&gt;&gt; include_only_gid_list = None</span>
<span class="sd">        &gt;&gt;&gt; viewpoint = &#39;no-filter&#39;</span>
<span class="sd">        &gt;&gt;&gt; is_exemplar = None</span>
<span class="sd">        &gt;&gt;&gt; species = const.Species.ZEB_PLAIN</span>
<span class="sd">        &gt;&gt;&gt; is_known = False</span>
<span class="sd">        &gt;&gt;&gt; # execute function</span>
<span class="sd">        &gt;&gt;&gt; aid_list = get_valid_aids(ibs, eid, include_only_gid_list, viewpoint, is_exemplar, species, is_known)</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(ibs.get_annot_names(aid_list), [const.UNKNOWN])</span>
<span class="sd">        &gt;&gt;&gt; ut.assert_eq(ibs.get_annot_species(aid_list), [const.Species.ZEB_PLAIN])</span>
<span class="sd">        &gt;&gt;&gt; # verify results</span>
<span class="sd">        &gt;&gt;&gt; result = str(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        [4]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># getting encounter aid</span>
    <span class="k">if</span> <span class="n">eid</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_exemplar</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c"># Optimization Hack</span>
            <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get_all_rowids_where</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="s">&#39;annot_exemplar_flag=?&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">is_exemplar</span><span class="p">,))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">_get_all_aids</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c"># HACK: Check to see if you want the</span>
        <span class="c"># exemplar &quot;encounter&quot; (image group)</span>
        <span class="n">enctext</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_encounter_enctext</span><span class="p">(</span><span class="n">eid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">enctext</span> <span class="o">==</span> <span class="n">const</span><span class="o">.</span><span class="n">EXEMPLAR_ENCTEXT</span><span class="p">:</span>
            <span class="n">is_exemplar</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_encounter_aids</span><span class="p">(</span><span class="n">eid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_exemplar</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c"># corresponding unoptimized hack for is_exemplar</span>
            <span class="n">flag_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_exemplar_flags</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
            <span class="n">aid_list</span>  <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">filter_items</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">)</span>
    <span class="c"># -- valid aid filtering --</span>
    <span class="k">if</span> <span class="n">include_only_gid_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">gid_list</span>     <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_gids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
        <span class="n">is_valid_gid</span> <span class="o">=</span> <span class="p">[</span><span class="n">gid</span> <span class="ow">in</span> <span class="n">include_only_gid_list</span> <span class="k">for</span> <span class="n">gid</span> <span class="ow">in</span> <span class="n">gid_list</span><span class="p">]</span>
        <span class="n">aid_list</span>     <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">filter_items</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">is_valid_gid</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">viewpoint</span> <span class="o">!=</span> <span class="s">&#39;no-filter&#39;</span><span class="p">:</span>
        <span class="n">viewpoint_list</span>     <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_viewpoints</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
        <span class="n">is_valid_viewpoint</span> <span class="o">=</span> <span class="p">[</span><span class="n">viewpoint</span> <span class="o">==</span> <span class="n">flag</span> <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">viewpoint_list</span><span class="p">]</span>
        <span class="n">aid_list</span>           <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">filter_items</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">is_valid_viewpoint</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">species</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">species_rowid</span>      <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_species_rowids_from_text</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>
        <span class="n">species_rowid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_species_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
        <span class="n">is_valid_species</span>   <span class="o">=</span> <span class="p">[</span><span class="n">sid</span> <span class="o">==</span> <span class="n">species_rowid</span> <span class="k">for</span> <span class="n">sid</span> <span class="ow">in</span> <span class="n">species_rowid_list</span><span class="p">]</span>
        <span class="n">aid_list</span>           <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">filter_items</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">is_valid_species</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">is_known</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">is_unknown_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">is_aid_unknown</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_known</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">filterfalse_items</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">is_unknown_list</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">is_known</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">aid_list</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">filter_items</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">is_unknown_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">aid_list</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@setter</span>
<div class="viewcode-block" id="set_annot_bboxes"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_bboxes">[docs]</a><span class="k">def</span> <span class="nf">set_annot_bboxes</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">bbox_list</span><span class="p">,</span> <span class="n">delete_thumbs</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets bboxes of a list of annotations by aid,</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list of rowids): list of annotation rowids</span>
<span class="sd">        bbox_list (list of (x, y, w, h)): new bounding boxes for each aid</span>

<span class="sd">    Note:</span>
<span class="sd">        set_annot_bboxes is a proxy for set_annot_verts</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">vtool</span> <span class="kn">import</span> <span class="n">geometry</span>
    <span class="c"># changing the bboxes also changes the bounding polygon</span>
    <span class="n">vert_list</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">verts_list_from_bboxes_list</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">)</span>
    <span class="c"># naively overwrite the bounding polygon with a rectangle - for now trust the user!</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">set_annot_verts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">vert_list</span><span class="p">,</span> <span class="n">delete_thumbs</span><span class="o">=</span><span class="n">delete_thumbs</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@setter</span>
<div class="viewcode-block" id="set_annot_detect_confidence"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_detect_confidence">[docs]</a><span class="k">def</span> <span class="nf">set_annot_detect_confidence</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">confidence_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Sets annotation notes &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">val_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">confidence</span><span class="p">,)</span> <span class="k">for</span> <span class="n">confidence</span> <span class="ow">in</span> <span class="n">confidence_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;annot_detect_confidence&#39;</span><span class="p">,),</span> <span class="n">val_iter</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@setter</span>
<span class="nd">@accessor_decors.dev_cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">ANNOT_EXEMPLAR_FLAG</span><span class="p">,</span> <span class="n">native_rowids</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<div class="viewcode-block" id="set_annot_exemplar_flags"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_exemplar_flags">[docs]</a><span class="k">def</span> <span class="nf">set_annot_exemplar_flags</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">flag_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Sets if an annotation is an exemplar &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">val_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">flag</span><span class="p">,)</span> <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flag_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_EXEMPLAR_FLAG</span><span class="p">,),</span> <span class="n">val_iter</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@setter</span>
<span class="c">#@cache_invalidator(const.NAME_TABLE)</span>
<span class="nd">@accessor_decors.dev_cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">NAME_ROWID</span><span class="p">,</span> <span class="n">native_rowids</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<div class="viewcode-block" id="set_annot_name_rowids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_name_rowids">[docs]</a><span class="k">def</span> <span class="nf">set_annot_name_rowids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">name_rowid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; name_rowid_list -&gt; annot.name_rowid[aid_list]</span>

<span class="sd">    Sets names/nids of a list of annotations.</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list</span>
<span class="sd">        name_rowid_list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#ibsfuncs.assert_lblannot_rowids_are_type(ibs, name_rowid_list, ibs.lbltype_ids[const.INDIVIDUAL_KEY])</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">NAME_ROWID</span><span class="p">,)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">name_rowid_list</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>
    <span class="c"># postset nids</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">update_annot_semantic_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@setter</span>
<div class="viewcode-block" id="set_annot_names"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_names">[docs]</a><span class="k">def</span> <span class="nf">set_annot_names</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">name_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the attrlbl_value of type(INDIVIDUAL_KEY) Sets names/nids of a</span>
<span class="sd">    list of annotations.</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-set_annot_names --enableall</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # DISABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.control.manual_annot_funcs import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()</span>
<span class="sd">        &gt;&gt;&gt; name_list1 = get_annot_names(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; name_list2 = [name + &#39;_TESTAUG&#39; for name in name_list1]</span>
<span class="sd">        &gt;&gt;&gt; set_annot_names(ibs, aid_list, name_list2)</span>
<span class="sd">        &gt;&gt;&gt; name_list3 = get_annot_names(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; set_annot_names(ibs, aid_list, name_list1)</span>
<span class="sd">        &gt;&gt;&gt; name_list4 = get_annot_names(ibs, aid_list)</span>
<span class="sd">        &gt;&gt;&gt; assert name_list2 == name_list3</span>
<span class="sd">        &gt;&gt;&gt; assert name_list4 == name_list1</span>
<span class="sd">        &gt;&gt;&gt; assert name_list4 != name_list2</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#ibs.get_nids_from_text</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name_list</span><span class="p">,</span> <span class="n">six</span><span class="o">.</span><span class="n">string_types</span><span class="p">)</span>
    <span class="c">#name_rowid_list = ibs.get_name_rowids_from_text(name_list, ensure=True)</span>
    <span class="n">name_rowid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">add_names</span><span class="p">(</span><span class="n">name_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">set_annot_name_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">name_rowid_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">update_annot_semantic_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@setter</span>
<div class="viewcode-block" id="set_annot_notes"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_notes">[docs]</a><span class="k">def</span> <span class="nf">set_annot_notes</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">notes_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Sets annotation notes &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">val_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">notes</span><span class="p">,)</span> <span class="k">for</span> <span class="n">notes</span> <span class="ow">in</span> <span class="n">notes_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_NOTE</span><span class="p">,),</span> <span class="n">val_iter</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@setter</span>
<div class="viewcode-block" id="set_annot_parent_rowid"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_parent_rowid">[docs]</a><span class="k">def</span> <span class="nf">set_annot_parent_rowid</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">parent_aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Sets the annotation&#39;s parent aid &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">val_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">parent_aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">parent_aid</span> <span class="ow">in</span> <span class="n">parent_aid_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_PARENT_ROWID</span><span class="p">,),</span> <span class="n">val_iter</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@setter</span>
<div class="viewcode-block" id="set_annot_species"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_species">[docs]</a><span class="k">def</span> <span class="nf">set_annot_species</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">species_text_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets species/speciesids of a list of annotations.</span>
<span class="sd">    Convenience function for set_annot_lblannot_from_value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#ibs.get_nids_from_text</span>
    <span class="n">species_rowid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_species_rowids_from_text</span><span class="p">(</span><span class="n">species_text_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">set_annot_species_rowids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">species_rowid_list</span><span class="p">)</span>
    <span class="c">#ibs.set_annot_lblannot_from_value(aid_list, species_text_list, const.SPECIES_KEY)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">update_annot_semantic_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@setter</span>
<span class="nd">@accessor_decors.dev_cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">SPECIES_ROWID</span><span class="p">,</span> <span class="n">native_rowids</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<div class="viewcode-block" id="set_annot_species_rowids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_species_rowids">[docs]</a><span class="k">def</span> <span class="nf">set_annot_species_rowids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">species_rowid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; species_rowid_list -&gt; annot.species_rowid[aid_list]</span>

<span class="sd">    Sets species/speciesids of a list of annotations.</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list</span>
<span class="sd">        species_rowid_list</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">#ibs.set_annot_lblannot_from_rowid(aid_list, speciesid_list, const.SPECIES_KEY)</span>
    <span class="c">#ibsfuncs.assert_lblannot_rowids_are_type(ibs, species_rowid_list, ibs.lbltype_ids[const.SPECIES_KEY])</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="n">aid_list</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">SPECIES_ROWID</span><span class="p">,)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">species_rowid_list</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@setter</span>
<div class="viewcode-block" id="set_annot_thetas"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_thetas">[docs]</a><span class="k">def</span> <span class="nf">set_annot_thetas</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">,</span> <span class="n">delete_thumbs</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Sets thetas of a list of chips by aid &quot;&quot;&quot;</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">val_list</span> <span class="o">=</span> <span class="p">((</span><span class="n">theta</span><span class="p">,)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">theta_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_THETA</span><span class="p">,),</span> <span class="n">val_list</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">delete_thumbs</span><span class="p">:</span>
        <span class="n">ibs</span><span class="o">.</span><span class="n">delete_annot_chips</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>  <span class="c"># Changing theta redefines the chips</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">update_annot_visual_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@setter</span>
<div class="viewcode-block" id="set_annot_verts"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_verts">[docs]</a><span class="k">def</span> <span class="nf">set_annot_verts</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">verts_list</span><span class="p">,</span> <span class="n">delete_thumbs</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Sets the vertices [(x, y), ...] of a list of chips by aid &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">vtool</span> <span class="kn">import</span> <span class="n">geometry</span>
    <span class="n">nInput</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="c"># Compute data to set</span>
    <span class="n">num_verts_list</span>   <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">verts_list</span><span class="p">))</span>
    <span class="n">verts_as_strings</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">__STR__</span><span class="p">,</span> <span class="n">verts_list</span><span class="p">))</span>
    <span class="n">id_iter1</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="c"># also need to set the internal number of vertices</span>
    <span class="n">val_iter1</span> <span class="o">=</span> <span class="p">((</span><span class="n">num_verts</span><span class="p">,</span> <span class="n">verts</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">num_verts</span><span class="p">,</span> <span class="n">verts</span><span class="p">)</span>
                 <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">num_verts_list</span><span class="p">,</span> <span class="n">verts_as_strings</span><span class="p">))</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="n">ANNOT_NUM_VERTS</span><span class="p">,</span> <span class="n">ANNOT_VERTS</span><span class="p">,)</span>
    <span class="c"># SET VERTS in ANNOTATION_TABLE</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">val_iter1</span><span class="p">,</span> <span class="n">id_iter1</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="c"># changing the vertices also changes the bounding boxes</span>
    <span class="n">bbox_list</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">bboxes_from_vert_list</span><span class="p">(</span><span class="n">verts_list</span><span class="p">)</span>      <span class="c"># new bboxes</span>
    <span class="n">xtl_list</span><span class="p">,</span> <span class="n">ytl_list</span><span class="p">,</span> <span class="n">width_list</span><span class="p">,</span> <span class="n">height_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">bbox_list</span><span class="p">))</span>
    <span class="n">val_iter2</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xtl_list</span><span class="p">,</span> <span class="n">ytl_list</span><span class="p">,</span> <span class="n">width_list</span><span class="p">,</span> <span class="n">height_list</span><span class="p">)</span>
    <span class="n">id_iter2</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="n">colnames</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;annot_xtl&#39;</span><span class="p">,</span> <span class="s">&#39;annot_ytl&#39;</span><span class="p">,</span> <span class="s">&#39;annot_width&#39;</span><span class="p">,</span> <span class="s">&#39;annot_height&#39;</span><span class="p">,)</span>
    <span class="c"># SET BBOX in ANNOTATION_TABLE</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">colnames</span><span class="p">,</span> <span class="n">val_iter2</span><span class="p">,</span> <span class="n">id_iter2</span><span class="p">,</span> <span class="n">nInput</span><span class="o">=</span><span class="n">nInput</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">delete_thumbs</span><span class="p">:</span>
        <span class="n">ibs</span><span class="o">.</span><span class="n">delete_annot_chips</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>  <span class="c"># INVALIDATE THUMBNAILS</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">update_annot_visual_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@setter</span>
<div class="viewcode-block" id="set_annot_viewpoint"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.set_annot_viewpoint">[docs]</a><span class="k">def</span> <span class="nf">set_annot_viewpoint</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">viewpoint_list</span><span class="p">,</span> <span class="n">convert_radians</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Sets the vertices [(x, y), ...] of a list of chips by aid &quot;&quot;&quot;</span>
    <span class="c">#import numpy as np</span>
    <span class="n">id_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">aid</span><span class="p">,)</span> <span class="k">for</span> <span class="n">aid</span> <span class="ow">in</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="c">#viewpoint_list = [-1 if viewpoint is None else viewpoint for viewpoint in viewpoint_list]</span>
    <span class="k">if</span> <span class="n">convert_radians</span><span class="p">:</span>
        <span class="n">viewpoint_list</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">viewpoint</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">ut</span><span class="o">.</span><span class="n">deg_to_rad</span><span class="p">(</span><span class="n">viewpoint</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">viewpoint</span> <span class="ow">in</span> <span class="n">viewpoint_list</span><span class="p">]</span>
    <span class="c">#assert all([0.0 &lt;= viewpoint &lt; 2 * np.pi or viewpoint == -1.0 for viewpoint in viewpoint_list])</span>
    <span class="n">val_iter</span> <span class="o">=</span> <span class="p">((</span><span class="n">viewpoint</span><span class="p">,</span> <span class="p">)</span> <span class="k">for</span> <span class="n">viewpoint</span> <span class="ow">in</span> <span class="n">viewpoint_list</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;annot_viewpoint&#39;</span><span class="p">,),</span> <span class="n">val_iter</span><span class="p">,</span> <span class="n">id_iter</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">update_annot_visual_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<div class="viewcode-block" id="get_annot_visual_uuid_info"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_visual_uuid_info">[docs]</a><span class="k">def</span> <span class="nf">get_annot_visual_uuid_info</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns annotation UUID that is unique for the visual qualities</span>
<span class="sd">    of the annoation. does not include name ore species information.</span>

<span class="sd">    get_annot_visual_uuid_info</span>

<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple: visual_infotup (image_uuid_list, verts_list, theta_list)</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_visual_uuid_info</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.model.preproc.preproc_annot import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[0:2]</span>
<span class="sd">        &gt;&gt;&gt; visual_infotup = ibs.get_annot_visual_uuid_info(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = str(list(zip(*visual_infotup))[0])</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        (UUID(&#39;66ec193a-1619-b3b6-216d-1784b4833b61&#39;), ((0, 0), (1047, 0), (1047, 715), (0, 715)), 0.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">image_uuid_list</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_image_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">verts_list</span>      <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_verts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">theta_list</span>      <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_thetas</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="c">#visual_info_iter = zip(image_uuid_list, verts_list, theta_list, view_list)</span>
    <span class="c">#visual_info_list = list(visual_info_iter)</span>
    <span class="n">visual_infotup</span> <span class="o">=</span> <span class="p">(</span><span class="n">image_uuid_list</span><span class="p">,</span> <span class="n">verts_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">visual_infotup</span>

</div>
<span class="nd">@register_ibs_method</span>
<div class="viewcode-block" id="get_annot_semantic_uuid_info"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.get_annot_semantic_uuid_info">[docs]</a><span class="k">def</span> <span class="nf">get_annot_semantic_uuid_info</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">_visual_infotup</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        aid_list (list):</span>
<span class="sd">        _visual_infotup (tuple) : internal use only</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple:  semantic_infotup (image_uuid_list, verts_list, theta_list, view_list, name_list, species_list)</span>

<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --test-get_annot_semantic_uuid_info</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # ENABLE_DOCTEST</span>
<span class="sd">        &gt;&gt;&gt; from ibeis.model.preproc.preproc_annot import *  # NOQA</span>
<span class="sd">        &gt;&gt;&gt; import ibeis</span>
<span class="sd">        &gt;&gt;&gt; ibs = ibeis.opendb(&#39;testdb1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; aid_list = ibs.get_valid_aids()[0:2]</span>
<span class="sd">        &gt;&gt;&gt; semantic_infotup = ibs.get_annot_semantic_uuid_info(aid_list)</span>
<span class="sd">        &gt;&gt;&gt; result = str(list(zip(*semantic_infotup))[1])</span>
<span class="sd">        &gt;&gt;&gt; print(result)</span>
<span class="sd">        (UUID(&#39;d8903434-942f-e0f5-d6c2-0dcbe3137bf7&#39;), ((0, 0), (1035, 0), (1035, 576), (0, 576)), 0.0, None, u&#39;easy&#39;, u&#39;zebra_plains&#39;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Semantic info depends on visual info</span>
    <span class="k">if</span> <span class="n">_visual_infotup</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">visual_infotup</span> <span class="o">=</span> <span class="n">get_annot_visual_uuid_info</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">visual_infotup</span> <span class="o">=</span> <span class="n">_visual_infotup</span>
    <span class="n">image_uuid_list</span><span class="p">,</span> <span class="n">verts_list</span><span class="p">,</span> <span class="n">theta_list</span> <span class="o">=</span> <span class="n">visual_infotup</span>
    <span class="c"># It is visual info augmented with name and species</span>
    <span class="n">view_list</span>       <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_viewpoints</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">name_list</span>       <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_names</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">species_list</span>    <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_species_texts</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">semantic_infotup</span> <span class="o">=</span> <span class="p">(</span><span class="n">image_uuid_list</span><span class="p">,</span> <span class="n">verts_list</span><span class="p">,</span> <span class="n">theta_list</span><span class="p">,</span> <span class="n">view_list</span><span class="p">,</span>
                        <span class="n">name_list</span><span class="p">,</span> <span class="n">species_list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">semantic_infotup</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.dev_cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">ANNOT_SEMANTIC_UUID</span><span class="p">,</span> <span class="n">native_rowids</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<div class="viewcode-block" id="update_annot_semantic_uuids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.update_annot_semantic_uuids">[docs]</a><span class="k">def</span> <span class="nf">update_annot_semantic_uuids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">,</span> <span class="n">_visual_infotup</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Updater for semantic uuids &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ibeis.model.preproc</span> <span class="kn">import</span> <span class="n">preproc_annot</span>
    <span class="n">semantic_infotup</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_semantic_uuid_info</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">_visual_infotup</span><span class="p">)</span>
    <span class="n">annot_semantic_uuid_list</span> <span class="o">=</span> <span class="n">preproc_annot</span><span class="o">.</span><span class="n">make_annot_semantic_uuid</span><span class="p">(</span><span class="n">semantic_infotup</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_SEMANTIC_UUID</span><span class="p">,),</span> <span class="n">annot_semantic_uuid_list</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>

</div>
<span class="nd">@register_ibs_method</span>
<span class="nd">@accessor_decors.dev_cache_invalidator</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="n">ANNOT_VISUAL_UUID</span><span class="p">,</span> <span class="n">native_rowids</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<div class="viewcode-block" id="update_annot_visual_uuids"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.update_annot_visual_uuids">[docs]</a><span class="k">def</span> <span class="nf">update_annot_visual_uuids</span><span class="p">(</span><span class="n">ibs</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Updater for visual uuids &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ibeis.model.preproc</span> <span class="kn">import</span> <span class="n">preproc_annot</span>
    <span class="n">visual_infotup</span> <span class="o">=</span> <span class="n">ibs</span><span class="o">.</span><span class="n">get_annot_visual_uuid_info</span><span class="p">(</span><span class="n">aid_list</span><span class="p">)</span>
    <span class="n">annot_visual_uuid_list</span> <span class="o">=</span> <span class="n">preproc_annot</span><span class="o">.</span><span class="n">make_annot_visual_uuid</span><span class="p">(</span><span class="n">visual_infotup</span><span class="p">)</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">const</span><span class="o">.</span><span class="n">ANNOTATION_TABLE</span><span class="p">,</span> <span class="p">(</span><span class="n">ANNOT_VISUAL_UUID</span><span class="p">,),</span> <span class="n">annot_visual_uuid_list</span><span class="p">,</span> <span class="n">aid_list</span><span class="p">)</span>
    <span class="c"># If visual uuids are changes semantic ones are also changed</span>
    <span class="n">ibs</span><span class="o">.</span><span class="n">update_annot_semantic_uuids</span><span class="p">(</span><span class="n">aid_list</span><span class="p">,</span> <span class="n">_visual_infotup</span><span class="o">=</span><span class="n">visual_infotup</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="testdata_annot"><a class="viewcode-back" href="../../../ibeis.control.html#ibeis.control.manual_annot_funcs.testdata_annot">[docs]</a><span class="k">def</span> <span class="nf">testdata_annot</span><span class="p">():</span>
    <span class="kn">import</span> <span class="nn">ibeis</span>
    <span class="n">ibs</span> <span class="o">=</span> <span class="n">ibeis</span><span class="o">.</span><span class="n">opendb</span><span class="p">(</span><span class="s">&#39;testdb1&#39;</span><span class="p">)</span>
    <span class="n">qreq_</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">return</span> <span class="n">ibs</span><span class="p">,</span> <span class="n">qreq_</span>

</div>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    CommandLine:</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --allexamples</span>
<span class="sd">        python -m ibeis.control.manual_annot_funcs --allexamples --noface --nosrc</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">multiprocessing</span>
    <span class="n">multiprocessing</span><span class="o">.</span><span class="n">freeze_support</span><span class="p">()</span>  <span class="c"># for win32</span>
    <span class="kn">import</span> <span class="nn">utool</span> <span class="kn">as</span> <span class="nn">ut</span>  <span class="c"># NOQA</span>
    <span class="n">ut</span><span class="o">.</span><span class="n">doctest_funcs</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">ibeis 0.1.0.dev1 documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Module code</a> &raquo;</li>
          <li><a href="../../ibeis.html" >ibeis</a> &raquo;</li>
          <li><a href="../control.html" >ibeis.control</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Jon Crall.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>